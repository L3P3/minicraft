function m(a){function b(d){return a.next(d)}function c(d){return a.throw(d)}return new Promise(function(d,e){function k(l){l.done?d(l.value):Promise.resolve(l.value).then(b,c).then(k,e)}k(a.next())})}
const y=lui,z=y.defer,ca=y.defer_end,da=y.hook_async,A=y.hook_dom,B=y.hook_effect,ea=y.hook_memo,ja=y.hook_model,ka=y.hook_rerender,la=y.hook_state,C=y.hook_static,ma=y.init,F=y.node,G=y.node_dom,na=y.node_map,oa=y.now,sa=window,ta=document,ua=navigator,H=Math,va=H.PI,ya=va*.5,za=180/va,Da=H.random,I=H.floor,Ea=H.ceil,Fa=H.round,K=H.min,L=H.max,Ga=H.cos,Ha=H.sin,Ia=H.sqrt,Ja=H.log2,Ka=String.fromCharCode,La=sa.BroadcastChannel,Ma=Date,Na=JSON,Oa=Promise,Xa=Na.stringify,Ya=Na.parse,N=localStorage,
Za=N.setItem.bind(N),$a=N.removeItem.bind(N),ab=sa.indexedDB,O=fetch,bb=Uint8Array,cb=Uint32Array,db=Set,eb=Map,P=Number,fb=Object,gb=fb.keys,hb=fb.entries,nb=setTimeout,ob=setInterval,pb=clearTimeout,qb=clearInterval,rb=addEventListener,sb=removeEventListener,tb=alert,ub=confirm,vb=prompt,wb=ua.userAgent.includes("WebKit"),xb=a=>a*a,yb=()=>!1,zb=(a,b)=>{if(a<2)return"...";const c=new Ma;a=new Ma(a);var d=c-a;if(d<59E3)return Fa(d/1E3)+"s";if(d<3E6)return Fa(d/6E4)+"m";d=a.getFullYear();const e=a.getMonth(),
k=a.getDate();let l="";d<c.getFullYear()&&(l=d+"/");if(l||e<c.getMonth())l+=e+1+"/";if(l||k<c.getDate())l+=k;if(b)return l||"\u0441\u0435\u0433\u043e\u0434\u043d\u044f";l&&(l+="/");b=l+a.getHours()+":";a=a.getMinutes();a=I(a).toString().padStart(2,"0");return b+a};let Q=null;
if(ab){let a,b;(a=ua.storage)==null||(b=a.persist)==null||b.call(a);const c=ab.open("minicraft",1);c.onupgradeneeded=d=>{d=d.target.result.createObjectStore("chunks",{keyPath:["world","coords"]});for(const e of gb(N))if(e.startsWith("minicraft.world.")){const [k,l]=e.substr(16).split(":");l!=="meta"&&(d.add({world:P(k),coords:l,data:N.getItem(e)}),$a(e))}};c.onsuccess=d=>{Q=d.target.result}}
const Ab=(a,b)=>m(function*(){if(!Q)return N.getItem(`minicraft.world.${a}:${b}`);const c=Q.transaction("chunks","readonly").objectStore("chunks").get([a,b]);return new Oa(d=>{c.onsuccess=()=>{let e;d((e=c.result)==null?void 0:e.data)}})}()),Cb=(a,b)=>{var c=Bb();return m(function*(){if(!Q)return Za(`minicraft.world.${a}:${b}`,c);const d=Q.transaction("chunks","readwrite").objectStore("chunks").put({world:a,coords:b,data:c});return new Oa((e,k)=>{d.onsuccess=()=>{e()};d.onerror=()=>{k(d.error)}})}())},
Db=(a,b)=>m(function*(){if(!Q)return $a(`minicraft.world.${a}:${b}`);const c=Q.transaction("chunks","readwrite").objectStore("chunks").delete([a,b]);return new Oa(d=>{c.onsuccess=()=>{d()}})}()),Eb=a=>m(function*(){const b=`minicraft.world.${a}:`;if(!Q){const e={},k=b.length;for(const l of gb(N))l.startsWith(b)&&(e[l.substr(k)]=N.getItem(l));return e}const c=Q.transaction("chunks","readonly").objectStore("chunks").openCursor(),d={meta:N.getItem(b+"meta")};return new Oa(e=>{c.onsuccess=()=>{const k=
c.result;k?(k.value.world===a&&(d[k.value.coords]=k.value.data),k.continue()):e(d)}})}()),Fb=(a,b)=>m(function*(){if(Q){var c=Q.transaction("chunks","readwrite"),d=c.objectStore("chunks");for(const [e,k]of hb(b))e!=="meta"?d.put({world:a,coords:e,data:k}):Za(`minicraft.world.${a}:meta`,k);return new Oa((e,k)=>{c.oncomplete=()=>{e()};c.onerror=()=>{k(c.error)}})}for(const [e,k]of hb(b))Za(`minicraft.world.${a}:${e}`,k);Za("__margin",Array(257).join("x"));$a("__margin")}()),Gb=a=>{if(Q){$a(`minicraft.world.${a}:meta`);
var b=Q.transaction("chunks","readwrite").objectStore("chunks").openCursor();b.onsuccess=()=>{const c=b.result;c&&(c.value.world===a&&c.delete(),c.continue())}}else{const c=`minicraft.world.${a}:`;for(const d of gb(N))d.startsWith(c)&&$a(d)}},Nb=(a,b)=>m(function*(){if(Q){Za(`minicraft.world.${b}:meta`,N.getItem(`minicraft.world.${a}:meta`));$a(`minicraft.world.${a}:meta`);var c=Q.transaction("chunks","readwrite").objectStore("chunks"),d=c.openCursor();return new Oa(f=>{d.onsuccess=()=>{const n=d.result;
n?(n.value.world===a&&(n.value.world=b,c.put(n.value)),n.continue()):f()}})}const e=`minicraft.world.${a}:`,k=e.length,l=`minicraft.world.${b}:`;for(const f of gb(N))if(f.startsWith(e)){const n=N.getItem(f);$a(f);Za(l+f.substr(k),n)}}());let Ob=null,Pb=null,Qb=0,Rb=!1,Sb=null,Tb=0;
const Wb=()=>{Ub.ta||(pb(Qb),X.Y({nb:!0,ta:!0}),Vb(!1))},Vb=a=>{m(function*(){Qb=nb(X.Y,5E3,{nb:!1});try{const b=yield O(`${"/api/minicraft/"}world?what=${a?"initia":"meta_al"}l`);if(!b.ok)throw Error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f.");const c=yield b.json();a?c.version_latest!=="0.11.6"?location.reload(!0):(Ob=c.worlds,X.Y({account:c.account,ta:!1,ca:Xb(Ub.config)})):(Ob=c,X.Y({ta:!1,ca:Xb(Ub.config)}))}catch(b){X.Y({ba:"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0438 \u0441\u043f\u0438\u0441\u043a\u0430 \u043c\u0438\u0440\u043e\u0432: "+
b.message,ta:!1})}}())},Yb=(a,b)=>L(b.local,b.remote)-L(a.local,a.remote),Xb=a=>{const b=Ob?Ob.map(c=>({account_name:c.account_name,hash:c.hash,id:c.id,label:c.label,local:0,public:c.public,remote:c.modified,writable:c.writable})):[];for(const c of a.worlds)if(a=b.find(d=>d.id===c.id)){const d=a.local=c.mod_l,e=a.remote,k=c.mod_r;d>k&&e>k&&(ub('\u041a\u043e\u043d\u0444\u043b\u0438\u043a\u0442! \u041c\u0438\u0440. "'+c.label+'" \u0431\u044b\u043b\u043e \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u043e \u043a\u0430\u043a \u0437\u0434\u0435\u0441\u044c, \u0442\u0430\u043a \u0438 \u0432 \u0434\u0440\u0443\u0433\u0438\u0445 \u043c\u0435\u0441\u0442\u0430\u0445.\n\u041e\u041a: \u043f\u0440\u0438\u043d\u044f\u0442\u044c \u0442\u043e, \u0447\u0442\u043e \u0441 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 ('+
zb(e,!1)+") | \u041e\u0442\u043c\u0435\u043d\u0438\u0442: \u0412\u043e\u0442 \u044d\u0442\u043e \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c ("+zb(d,!1)+")")?(z(),X.Z(c.id,{mod_l:a.local=k})):a.remote=k)}else c.mod_r>1&&Ob&&(tb('\u041c\u0438\u0440 "'+c.label+'" \u0431\u044b\u043b \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0435 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u044c, \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043e\u043d \u0442\u0435\u043f\u0435\u0440\u044c \u043b\u043e\u043a\u0430\u043b\u043d\u044b\u0439!'),
z(),X.Z(c.id,{mod_r:0})),b.push({account_name:"",hash:0,id:c.id,label:c.label,local:c.mod_l,public:!1,remote:c.mod_r===1?1:0,writable:!0});return Pb=b.sort(Yb)},$b=()=>m(function*(){if(!Rb){Rb=!0;var a;try{for(;a=Pb.find(b=>b.local>0&&b.remote>0&&b.local!==b.remote);)yield Zb(a),X.Y({ua:null})}catch(b){X.Y({ba:b.message,ua:null})}Rb=!1}}()),ac={method:"POST",headers:{"Content-Type":"application/json"}},Zb=a=>m(function*(){const b=a.id;X.Y({ua:b});if(a.local<a.remote)try{var c=yield(yield O(`${"/static/minicraft/"}worlds/${a.hash}.json`)).json();
yield Fb(b,c);z();X.Z(b,{mod_l:a.remote,mod_r:a.remote})}catch(d){if(d.name==="QuotaExceededError")tb("\u041d\u0435\u0445\u0432\u0430\u0442\u0430\u0435\u0442 \u043f\u0430\u043c\u044f\u0442\u0438!"),z(),X.ob(b),Gb(b);else throw Error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u043c\u0438\u0440\u0430: "+d.message);}else if(a.writable)try{c=b;if(a.remote===1){const l=yield O("/api/minicraft/world",Object.assign({},ac,{body:Xa({what:"meta",
label:a.label})}));if(!l.ok)throw Error(l.status===403?"\u041d\u0435\u0442\u0443 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f. \u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d?":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f.");c=(yield l.json()).id}const d=yield Eb(b),e=yield O("/api/minicraft/world",Object.assign({},ac,{body:Xa({what:"data",world:c,data:d})}));if(!e.ok)throw Error(e.status===
403?"\u041d\u0435\u0442\u0443 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f. \u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d?":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f.");const k=yield e.json();z();c===b?X.Z(b,{mod_l:k.modified,mod_r:k.modified}):(yield Nb(b,c),X.ob(b),X.mb({id:c,label:a.label,mod_l:k.modified,mod_r:k.modified}),Sb=b,Tb=c)}catch(d){throw z(),X.Z(b,{mod_r:0}),Error("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0437\u0430\u0433\u0440\u0443\u0441\u043a\u0435 \u043c\u0438\u0440\u0430: "+
d.message);}else z(),X.Z(b,{mod_l:Ub.config.worlds.find(d=>d.id===b).mod_r})}());let Y=Ya(N.getItem("minicraft.config")||null);if(Y&&Y.worlds&&Y.version.startsWith("0.9.")){const a=new db(Y.worlds.map(b=>"minicraft.world."+b.id));for(const b of gb(N))b.startsWith("minicraft.world.")&&!a.has(b.split(":",1)[0])&&$a(b)}
const bc={init:()=>{let a=!1;var b={oa:!1,Da:1,Aa:3,X:4,T:1,Ja:120,ka:64,Ka:0,worlds:[]};if(Y){let c=Y.pixel_grouping;c!=null&&(b.Da=c);(c=Y.mouse_sensitivity)!=null&&(b.Aa=c);b.X=Y.resolution_scaling;(c=Y.textures)!=null?b.T=c:b.T=Y.flag_textures?1:0;b.Ja=Y.view_angle;b.ka=Y.view_distance;(c=Y.world_last)!=null&&(b.Ka=c);(c=Y.worlds)?b.worlds=c:N.getItem("minicraft.world.0:meta")&&(b.worlds[0]={id:0,label:(vb("\u0411\u044b\u043b \u043d\u0430\u0439\u0434\u0435\u043d \u0431\u0435\u0437 \u0438\u043c\u0435\u043d\u0438 \u043b\u043e\u043a\u0430\u043b\u043d\u044b\u0439 \u043c\u0438\u0440. \u041a\u0430\u043a \u0435\u0433\u043e \u043d\u0430\u0437\u0430\u0432\u0451\u0448\u044c? ",
"")||"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b\u0439 \u043c\u0438\u0440").substring(0,16),mod_l:Ma.now(),mod_r:0},a=!0);Y=null}b={account:{label:"",rank:0},config:b,eb:b,ba:null,nb:!0,ta:!0,ua:null,ca:Xb(b)};return a?(b.eb=null,bc.cb(b)):b},cb:a=>{const b=a.config;if(b===a.eb)return a;Za("minicraft.config",Xa({version:"0.11.6",pixel_grouping:b.Da,mouse_sensitivity:b.Aa,resolution_scaling:b.X,textures:b.T,view_angle:b.Ja,view_distance:b.ka,world_last:b.Ka,worlds:b.worlds}));return Object.assign({},
a,{eb:b})},Mb:(a,b)=>bc.ma(a,b(a.config)),ma:(a,b)=>Object.assign({},a,{config:Object.assign({},a.config,b)}),Pa:(a,b)=>a.config.oa===b?a:bc.ma(a,{oa:b}),Y:(a,b)=>Object.assign({},a,b),mb:(a,b)=>{b=Object.assign({},a.config,{worlds:[...a.config.worlds,b]});return Object.assign({},a,{config:b,ca:Xb(b)})},ob:(a,b)=>{const c=Object.assign({},a.config,{worlds:a.config.worlds.filter(d=>d.id!==b)});return Object.assign({},a,{config:c,ca:Xb(c)})},Z:(a,b,c)=>{const d=Object.assign({},a.config,{worlds:a.config.worlds.map(e=>
e.id===b?Object.assign({},e,c):e)});return Object.assign({},a,{config:d,ca:Xb(d)})}};let Ub,X;
const cc="air stone grass dirt cobble planks bedrock log leaves bricks wool sand gravel glass bookshelf obsidian stone_bricks sandstone lapis_block iron_block gold_block diamond_block emerald_block redstone_block quartz_block".split(" "),dc="\u0412\u043e\u0437\u0434\u0443\u0445;\u041a\u0430\u043c\u0435\u043d\u044c;\u0411\u043b\u043e\u043a \u0442\u0440\u0430\u0432\u044b;\u0417\u0435\u043c\u043b\u044f;\u0411\u0443\u043b\u044b\u0436\u043d\u0438\u043a;\u0414\u043e\u0441\u043a\u0430;\u0411\u0435\u0434\u0440\u043e\u043a;\u0411\u0440\u0435\u0432\u043d\u043e;\u041b\u0438\u0441\u0442\u044c\u044f;\u041a\u0438\u0440\u043f\u0438\u0447\u0438;\u0428\u0435\u0440\u0441\u0442;\u041f\u0435\u0441\u043e\u043a;\u0413\u0440\u0430\u0432\u0438\u0439;\u0421\u0442\u0435\u043a\u043b\u043e;\u041a\u043d\u0438\u0436\u043d\u044f \u043f\u043e\u043b\u043a\u0430;\u041e\u0431\u0441\u0438\u0434\u0438\u0430\u043d;\u041a\u0430\u043c\u0435\u043d\u044b\u0435 \u043a\u0438\u0440\u043f\u0438\u0447\u0438;\u041f\u0435\u0449\u044f\u043d\u0438\u043a;\u0411\u043b\u043e\u043a \u043b\u0430\u0437\u0443\u0440\u0438\u0442\u0430;\u0411\u043b\u043e\u043a \u0436\u0435\u043b\u0435\u0437\u0430;\u0411\u043b\u043e\u043a \u0437\u043e\u043b\u043e\u0442\u0430;\u0411\u043b\u043e\u043a \u0430\u043b\u043c\u0430\u0437\u0430;\u0411\u043b\u043e\u043a \u0438\u0437\u0443\u043c\u0440\u0443\u0434\u0430;\u0411\u043b\u043e\u043a \u0440\u0435\u0434\u0441\u0442\u043e\u0443\u043d\u0430;\u0411\u043b\u043e\u043a \u043a\u0432\u0430\u0440\u0446\u0430".split(";"),ec=
[0,8487297,4305266,4349313,8092539,5342114,7039851,3561583,4172910,6384533,15526888,10671324,8092798,16447200,4151672,1970708,8092539,9686227,9126695,15198183,5567485,14541182,7920469,662956,14936813],fc=(a,b=1,c=null)=>({amount:b,data:c,id:a}),hc=(a,b,c=a.c.amount)=>{if(b.c)a.c.id===b.c.id?(c=K(c,b.V-b.c.amount),a.c.amount-=c,b.c.amount+=c,a.c.amount<=0&&(a.c=null)):!(a.c.amount<=c&&a.c.amount<=b.V&&b.c.amount<=a.V)||a.filter&&!a.filter(b.c.id)||b.filter&&!b.filter(a.c.id)||([b.c,a.c]=[a.c,b.c]);
else if(!b.filter||b.filter(a.c.id))a.c.amount<=c&&a.c.amount<=b.V?[b.c,a.c]=[a.c,b.c]:(c=K(c,b.V),a.c.amount-=c,b.c=fc(a.c.id,c),a.c.amount<=0&&(a.c=null))},ic=(a,b)=>{for(const c of a)if(c.c&&c.c.id===b.id){const d=K(b.amount,c.V-c.c.amount);c.c.amount+=d;if((b.amount-=d)<=0)return null}for(const c of a)if(!c.c&&(!c.filter||c.filter(b.id)))if(a=K(b.amount,c.V),a<=b.amount){if(c.c=fc(b.id,a),(b.amount-=a)<=0)return null}else return c.c=b,null;return b},jc=(a,b)=>({$a:0,pb:0,ab:0,O:0,la:0,va:0,da:0,
U:-1,ea:0,wa:null,xa:null,l:1,yb:20,B:Array(36).fill(null).map(()=>({c:null,filter:null,V:64})),Ua:0,name:b.label||"\u0418\u0433\u0440\u043e\u043a",G:a.Ga,H:a.Ha,J:a.Ia,Cb:0,Db:0,L:0,qa:0,ha:0,ia:0,ja:0}),kc=(a,b,c)=>{a.O=(a.O+b+va*100)%(va*2);a.la=L(-ya,K(ya,a.la+c))},lc=a=>{a+=32;a>33&&a<39?a++:a>38&&a<44?a+=2:a>43&&a<127?a+=3:a>126&&a<55258?a+=37:a>55295&&(a+=8485);return Ka(a)},mc=a=>a-(a>63743?8517:a>159?69:a>46&&a<130?35:a>40&&a<46?34:a>34&&a<40?33:32),Bb=()=>{var a=nc;const b=a.length,c=new eb,
d=u=>{p=p<<1|u&1;++h===15&&(g+=lc(p),p=h=0)},e=()=>{for(let u=0;u<t;++u)d(0)},k=u=>{d(u);d(u>>1);d(u>>2);d(u>>3);d(u>>4);d(u>>5);d(u>>6);d(u>>7)},l=()=>{--q===0&&(q=1<<t++)},f=()=>{if(r)r=!1;else{let u=v.id;for(let V=0;V<t;V++)d(u>>V)}};let n=a[0],g="",p=0,h=2,t=2,q=2,x=2,v={id:x++,Na:new eb},r=!0;k(n);c.set(n,v);for(let u=1;u<b;++u){const V=v.Na.get(n=a[u]);V?v=V:(f(),c.has(n)||(l(),e(),k(n),c.set(n,{id:x++,Na:new eb}),r=!0),v.Na.set(n,{id:x++,Na:new eb}),v=c.get(n),l())}f();c.has(n)||(l(),e(),k(n));
l();d(1);--t;e();return g+=lc(p<<15-h)},oc=a=>{var b=nc;if(!a)return null;const c=a.length,d=()=>{h+=(x>>--v&1)<<t++;v===0&&(v=15,x=mc(a.charCodeAt(q++)))};let e=[0,1],k=1,l=3,f=2,n=null;var g=null;let p=0,h=0;g=2;let t=0,q=0,x=mc(a.charCodeAt(q++)),v=15;for(;t<g;)d();if(h===1)return null;for(h=t=0;t<8;)d();n=[h];e[2]=n;for(b[p++]=h;q<=c;){g=f;for(h=t=0;t<g;)d();if(h===0){for(h=t=0;t<8;)d();e[l]=[h];h=l++;--k===0&&(k=1<<f++)}else if(h===1)return b;g=h<e.length?e[h]:n.concat(n[0]);for(let r=0;r<g.length;r++)b[p++]=
g[r];e[l++]=n.concat(g[0]);n=g;--k===0&&(k=1<<f++)}return null},pc=new cb(1024),nc=new bb(pc.buffer),qc=new eb,rc=a=>({$:null,Ma:null,busy:!1,aa:null,Oa:null,ya:0,fa:!Ub.ca.find(b=>b.id===a).writable,Ra:0,Sa:0,Ta:0,id:a,Ba:0,Ca:0,K:0,Ga:.5,Ha:8.5,Ia:.5,time:0,kb:0}),sc=(a,b,c,d)=>c<0||c>63?0:a.$[(b<<a.K+4|d)<<6|c],tc=(a,b,c,d)=>{const e=a.K;a.$[(b<<e+4|d)<<6|c]=0;a.aa[(b>>4<<e|d>>4)<<2|c>>4].na=!0},uc=(a,b,c,d,e)=>{const k=a.K,l=(b<<k+4|d)<<6|c;if(a.$[l]>0)return!1;a.$[l]=e;return a.aa[(b>>4<<k|d>>
4)<<2|c>>4].na=!0},Ic=(a,b,c)=>{const d=L(K(b.H,63),0)>>4,e=I(b.G)>>4;b=I(b.J)>>4;if(c||a.Sa!==d||a.Ba+a.Ra!==e||a.Ca+a.Ta!==b)c=1<<a.K,a.Sa=d,a.Ba=e-(a.Ra=(65536+e)%c),a.Ca=b-(a.Ta=(65536+b)%c),vc(a);a.busy||wc(a,!1)},vc=a=>{const b=a.Ra,c=a.Sa,d=a.Ta,e=a.K,k=`${e} ${b} ${d} ${c}`;let l=qc.get(k);if(l==null){const f=1<<e,n=xb(f*.5);qc.set(k,l=a.aa.map(({x:g,y:p,z:h},t)=>{let q=xb(g-b),x=xb(h-d),v=xb(g-b-f),r=0,u=0;v<q&&(q=v,r=-f);(v=xb(g-b+f))<q&&(q=v,r=f);(v=xb(h-d-f))<x&&(x=v,u=-f);(v=xb(h-d+f))<
x&&(x=v,u=f);return{fb:q+x+xb(p-c),sb:t,Ba:r,Ca:u}}).filter(({fb:g})=>g<=n).sort((g,p)=>g.fb-p.fb))}a.Oa=l;a.ya=0},Kc=(a,b)=>{if(!a.fa){for(var c=b.B.map(({c:d})=>d&&[d.id,d.amount,d.data]);c.length>0&&c[c.length-1]===null;)c.pop();Za(`minicraft.world.${a.id}:meta`,Xa({p:{h:b.yb,i:c,m:b.l,p:[b.G,b.H,b.J,b.O,b.la]},s:[a.Ga,a.Ha,a.Ia],t:a.time,v:1}));Oa.all(a.aa.filter(d=>d.na).map(d=>Jc(a,d)))}},Mc=(a,b)=>{const c=N.getItem(`minicraft.world.${a.id}:meta`);if(c){const {p:d,s:e,t:k,v:l}=Ya(c);l!=null&&
(d.i.forEach((f,n)=>{f&&(b.B[n].c=fc(f[0],f[1],f[2]))}),b.yb=d.h,b.l=d.m,b.G=d.p[0],b.H=d.p[1],b.J=d.p[2],b.O=d.p[3],b.la=d.p[4],a.Ga=e[0],a.Ha=e[1],a.Ia=e[2],k!=null&&Lc(a,k))}},Lc=(a,b)=>{a.time=b%24E3;a.kb=(b+6E3)/24E3%1},Nc=a=>m(function*(){const b=a.aa[a.Oa[a.ya=0].sb];var c=b.y;yield Db(a.id,`${b.La}/${b.Za}`+(c>0?"/"+c:""));b.na=!1;++b.La;return wc(a,!1)}()),Jc=(a,b)=>{const c=a.Ma;var d=a.K;const e=b.y,k=(256<<d)-256;for(let l=0,f=-1,n=((b.x<<d+4|b.z)<<6|e)<<2;l<16;++l){for(d=0;d<16;++d)pc[++f]=
c[n],pc[++f]=c[++n],pc[++f]=c[++n],pc[++f]=c[++n],n+=13;n+=k}b.na=!1;return Cb(a.id,`${b.La}/${b.Za}`+(e>0?"/"+e:""))},wc=(a,b)=>m(function*(){const c=a.aa,d=a.Oa,e=a.Ba,k=a.Ca,l=d.length;for(;a.ya<l;){var f=d[a.ya++],n=c[f.sb],g=n.l,p=n.x;const x=n.y;var h=n.z,t=e+f.Ba+p;const v=k+f.Ca+h;if(!g||t!==n.La||v!==n.Za){n.l=a.busy=!0;f=n.na&&Jc(a,n);var q=a.id;t=n.La=t;n=n.Za=v;n=oc(yield Ab(q,`${t}/${n}`+(x>0?"/"+x:"")));yield f;a.busy=!1;if(g||x===0||n){f=a.Ma;t=a.K;q=(256<<t)-256;p=((p<<t+4|h)<<6|x)<<
2;if(n)for(let r=0,u=-1;r<16;++r){for(g=0;g<16;++g)f[p]=pc[++u],f[++p]=pc[++u],f[++p]=pc[++u],f[++p]=pc[++u],p+=13;p+=q}else for(h=0;h<16;++h){for(n=0;n<16;++n)f[p]=x>0?0:50397446,f[++p]=x>0?0:131843,g?(f[++p]=0,f[++p]=0,p+=13):p+=15;p+=q}if(!b)break}}}}());let Oc=null,Pc=null;
const Qc=new db,Rc=a=>{if(a){const b=Pc=new Image;b.onload=()=>{if(Pc===b){var c=ta.createElement("canvas");c.width=16;c.height=416;c=c.getContext("2d");c.scale(1,-1);for(let d=0;d<26;++d)c.drawImage(b,0,d<<4,16,16,0,-(d<<4)-16,16,16);Oc=new cb(c.getImageData(0,0,16,416).data.buffer);for(const d of Qc)d.P=!0;Pc=null}};b.src=`${"/static/minicraft/"}textures/${a}.png`}else Oc=null},Tc=(a,b)=>{const c={Eb:b,bb:b.getContext("2d",{alpha:!1,desynchronized:!0}),qb:null,rb:null,wb:"",P:!1,xb:0,gb:0,Fb:ob(()=>
(c.xb=c.gb,c.gb=0),1E3),o:a};Qc.add(c);Sc(c);return c},Sc=a=>{const b=a.Eb,c=a.o;a.rb=new cb((a.qb=a.bb.createImageData(b.width=c.Ea,b.height=c.Fa)).data.buffer);const d=c.Ea*c.config.X/c.pa,e=c.Fa*c.config.X/c.pa;b.style.width=d+"px";b.style.height=e+"px";b.style.left=Fa((c.Va-d)/2)+"px";b.style.top=Fa((c.Wa-e)/2)+"px";a.bb.fillStyle="rgba(255,255,255,.5)"};let Uc=0;
const Xc=(a,{config:b,account:c})=>{const d=rc(b.Ka),e=jc(d,c);Mc(d,e);const k={config:b,tb:0,ub:0,Qa:!1,za:!0,A:!0,Gb:a,ga:0,W:new db,hb:"",j:0,N:[],g:e,ib:null,u:null,pa:1,Va:1,Wa:1,Ea:0,Fa:0,Xa:0,Bb:0,Ya:0,Ib:ob(()=>{var l;(l=k.A)||(Lc(d,d.time+1),Ic(d,e,!1),l=void 0);return l},50),world:d};Vc(k,null);Wc(k);return k},Yc=a=>{a.world.fa||(Kc(a.world,a.g),X.Z(a.world.id,{mod_l:Ma.now()}))},Wc=a=>{m(function*(){if(!a.config.oa)try{yield a.Gb.requestPointerLock()}catch(b){}}())},Zc=(a,b)=>a===b?0:.1-
a*.2,$c=a=>{a.g.$a=Zc((a=a.W).has(-12)||a.has(65),a.has(-13)||a.has(68))},ad=a=>{a.g.pb=Zc((a=a.W).has(-15)||a.has(16),a.has(-14)||a.has(32))},bd=a=>{a.g.ab=Zc((a=a.W).has(-11)||a.has(83),a.has(-10)||a.has(87))},cd=a=>{a.g.Cb=Zc(a.W.has(-18),a.W.has(-19))},dd=a=>{a.g.Db=Zc(a.W.has(-17),a.W.has(-16))},fd=(a,b,c)=>{if(!a.world)return!1;const d=a.W;var e=a.g;if(c){if(d.has(b))return!1;d.add(b);var k=e.da,l=e.U;c=e.ea;switch(b){case -18:case -19:cd(a);break;case -17:case -16:dd(a);break;case -1:!a.world.fa&&
e.l!==2&&l>=0&&(e.Ua===0?e.l===0&&(b=sc(a.world,k,l,c),b===2?b=3:b===1&&(b=4),b===6||b!==8&&b!==13&&ic(e.B,fc(b,1))!==null)||(tc(a.world,k,l,c),e.U=-1):ed(a,[k,l,c],!1));break;case -2:case 71:if(l>=0){const f=sc(a.world,k,l,c);c=e.B.slice(0,9);l=c.findIndex(n=>n.c!==null&&n.c.id===f);l>=0?e.L=l:e.l===1&&(c[e.L].c&&(c=c.findIndex(n=>n.c===null),c>=0&&(e.L=c)),e.B[e.L].c=fc(f));e.qa=a.ga}break;case -3:if(!a.world.fa&&e.l!==2&&l>=0)if(e.Ua===0){if(b=e.B[e.L],b.c){switch(e.va){case 0:--k;break;case 1:++k;
break;case 2:--l;break;case 3:++l;break;case 4:--c;break;case 5:++c}l>=0&&l<64&&uc(a.world,k&(1<<4+a.world.K)-1,l,c&(1<<4+a.world.K)-1,b.c.id)&&e.l!==1&&--b.c.amount<=0&&(b.c=null)}}else ed(a,[k,l,c],!0);break;case -4:e.L=(e.L+9-1)%9;e.qa=a.ga;break;case -5:e.L=(e.L+1)%9;e.qa=a.ga;break;case 27:a.j===0&&(a.A=!0,a.j=1);break;case -15:case -14:case 16:case 32:ad(a);break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:e.L=b-49;e.qa=a.ga;break;case -12:case -13:case 65:case 68:$c(a);
break;case 69:if(a.j===0){a.j=3;for(const f of d)fd(a,f,!1)}break;case 80:a.world&&(a.A=!0);break;case 81:e=e.B[e.L];if(d.has(17)||e.c&&--e.c.amount<=0)e.c=null;break;case -11:case -10:case 83:case 87:bd(a);break;case 84:if(a.j===0){a.j=2;for(const f of d)fd(a,f,!1)}break;case 112:a.za=!a.za;break;case 114:a.Qa=!a.Qa;case 116:case 122:case 123:break;default:return!1}}else{if(!d.delete(b))return!1;switch(b){case -15:case -14:case 16:case 32:ad(a);break;case -12:case -13:case 65:case 68:$c(a);break;
case -11:case -10:case 83:case 87:bd(a);break;case -18:case -19:cd(a);break;case -17:case -16:dd(a)}}a.hb=[...d].join();return!0},gd=(a,b)=>(b=b.startsWith("~")?a+P(b.substr(1)):P(b),isNaN(b)?a:b),id=(a,b)=>{var c=a.g,d=a.world;if(b)if(b.charAt(0)==="/"){b=b.substr(1).split(" ");const e=b.shift();switch(e){case "clear":a.N=[];break;case "clearinv":for(const k of c.B)k.c=null;Z(a,"\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440 \u043f\u0443\u0441\u0442",!0);break;case "gamemode":case "gm":b=P(b[0]);
!isNaN(b)&&b>=0&&b<3&&b%1===0?(c.l=b,Z(a,"\u0418\u0433\u0440\u043e\u0432\u043e\u0439 \u0440\u0435\u0436\u0438\u043c \u0441\u043c\u0435\u043d\u0451\u043d \u043d\u0430: "+b,!0)):Z(a,"\u0418\u0433\u0440\u043e\u0432\u043e\u0439 \u0440\u0435\u0436\u0438\u043c \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442 0..2!");break;case "give":if(b.length===0){Z(a,"/give <id> [\u0427\u0438\u0441\u043b\u043e]\n"+cc.join(" "));break}d=cc.indexOf((b[0]||"").toLowerCase());d=d>=0?d:P(b[0]);b=P(b[1]||1);!isNaN(d)&&
d>0&&d<25&&d%1===0?!isNaN(b)&&b>0&&b%1===0?Z(a,ic(c.B,fc(d,b))?"\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440 \u043f\u043e\u043b\u043d\u044b\u0439!":`${"\u0412\u0435\u0449\u0438 \u0434\u0430\u043d\u044b"} ${b} ${dc[d]}`,!0):Z(a,"\u0427\u0438\u0441\u043b\u043e \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442 \u043c\u0438\u043d\u0438\u043c\u0443\u043c 1!"):Z(a,"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u0442\u0438\u043f \u0431\u043b\u043e\u043a\u0430!");break;case "help":Z(a,"\u041a\u043e\u043c\u0430\u043d\u0434\u0430: clear, clearinv, gamemode, give, help, load, me, save, spawn, teleport, time, version");
break;case "load":wc(d,!0).then(()=>{a.u.P=!0;Z(a,"\u0427\u0430\u043d\u043a\u0438 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u044e\u0442\u0441\u044f.",!0)});break;case "me":Z(a,c.name+" "+b.join(" "),!0);break;case "save":if(a.world.fa){Z(a,"\u041d\u0435\u0442 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438!");break}Yc(a);Z(a,"\u0418\u0433\u0440\u0430 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0430.",!0);break;case "spawn":if(a.world.fa){Z(a,"\u041d\u0435\u0442 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438!");
break}d.Ga=c.G;d.Ha=c.H;d.Ia=c.J;Z(a,"\u041d\u0430\u0447\u0430\u043b\u043d\u0430\u044f \u0442\u043e\u0447\u043a\u0430 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0430",!0);break;case "teleport":case "tp":b.length===0?(c.G=d.Ga,c.H=d.Ha,c.J=d.Ia,a.u.P=!0,Z(a,"\u041f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u0441\u044f \u043a \u0441\u0442\u0430\u0440\u0442\u043e\u0432\u043e\u0439 \u0442\u043e\u0447\u043a\u0438.",!0)):b.length===3?(Z(a,"\u041f\u0435\u0440\u0435\u043c\u0435\u0441\u0442\u0438\u0442\u0441\u044f \u043a"+
` ${c.G=gd(c.G,b[0])} ${c.H=gd(c.H,b[1])} ${c.J=gd(c.J,b[2])}`,!0),a.u.P=!0):Z(a,"\u041d\u0435\u043f\u043e\u0432\u0435\u0437\u043b\u043e!");c.ha=0;c.ia=0;c.ja=0;break;case "time":c=b[1];if(!c){Z(a,"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 \u043e\u0442\u0441\u0443\u0442\u0441\u0442\u0432\u0443\u0435\u0442!");break}if(c==="day")c=1E3;else if(c==="night")c=13E3;else if(isNaN(c=I(P(c))))break;switch(b[0]){case "add":c+=d.time;case "set":Lc(d,c);Z(a,"\u041d\u043e\u0432\u043e\u0435 \u0432\u0440\u0435\u043c\u044f: "+
d.time,!0);break;default:Z(a,"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u043d\u0430\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430: time "+b[0])}break;case "version":Z(a,"minicraft 0.11.6");break;case "/exit":c.Ua=0;Z(a,"\u041a\u043b\u0430\u0441\u0441\u0438\u0447\u0435\u0441\u043a\u0438\u0439 \u0440\u0435\u0436\u0438\u043c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043d\u043e\u0439 \u043c\u044b\u0448\u043a\u0438.",!0);break;case "/expand":a.g.wa&&a.g.xa?d=!0:(Z(a,"\u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0441\u043d\u0430\u0447\u044f\u043b\u043e!"),
d=!1);d&&(b[0]==="vert"?(c.wa[1]=0,c.xa[1]=63,Z(a,"\u0412\u044b\u0431\u043e\u0440\u044c \u0443\u0432\u0435\u043b\u0438\u0447\u0435\u043d.",!0)):Z(a,'\u0422\u043e\u043b\u043a\u043e "vert" \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f!'));break;case "/pos1":case "/pos2":ed(a,[I(c.G),I(c.H),I(c.J)],e==="/pos2");break;case "/regen":if(a.world.fa){Z(a,"\u041d\u0435\u0442 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438!");break}Nc(d).then(()=>{a.u.P=
!0;Z(a,"\u0427\u0430\u043d\u043a\u0438 \u043f\u0435\u0440\u0435\u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f ",!0)});break;case "/show":Z(a,`${"\u041f\u0435\u0440\u0432\u044b\u0439"}: ${c.wa?c.wa.join(" "):"\u043d\u0438\u0447\u0435\u0433\u043e"}, ${"\u0412\u0442\u043e\u0440\u043e\u0439"}: ${c.xa?c.xa.join(" "):"\u043d\u0438\u0447\u0435\u0433\u043e"}`);break;case "/wand":c.Ua=1;Z(a,"\u0412\u044b\u0431\u043e\u0440\u044c \u0441 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043d\u043e\u0439 \u043c\u044b\u0448\u043a\u0438.",
!0);break;default:Z(a,"\u041d\u0435\u043f\u0440\u0430\u0432\u0438\u043b\u043d\u0430\u044f \u043a\u043e\u043c\u0430\u043d\u0434\u0430: "+e)}}else{const e=Z(a,`<${c.name}> `+b);Vc(a,b).then(k=>{k&&hd(a,e)})}},Z=(a,b,c=!1)=>{const d=++Uc;(a.N=a.N.slice(-49)).push({id:d,Ab:c,time:oa(),value:b});return d},hd=(a,b)=>{const c=a.N.findIndex(d=>d.id===b);c>=0&&a.N.splice(c,1)},ed=(a,b,c)=>{c?a.g.xa=b:a.g.wa=b;Z(a,`${c?"\u0412\u0442\u043e\u0440\u0430\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u0430\u044f \u0442\u043e\u0447\u043a\u0430":
"\u041f\u0435\u0440\u0432\u0430\u044f \u0432\u044b\u0431\u0440\u0430\u043d\u0430\u044f \u0442\u043e\u0447\u043a\u0430"}: ${b.join(" ")}`,!0)},Vc=(a,b)=>(pb(a.ib),(b?O("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:Xa({msg:b})}):O("/api/chat")).then(c=>{if(c.ok)return c.text()}).then(c=>{if(c){c=c.split("\n").filter(Boolean);for(const d of c)d.startsWith("<")&&Z(a,d);return c.length>0}return!1}).catch(()=>!1).then(c=>{a.ib=nb(Vc,5E3,a,null);return c})),jd=({id:a,M:b})=>
(A("div[className=bitmap]",{S:{backgroundImage:`url(${"/static/minicraft/"}textures/${b}.png)`,backgroundPositionY:100-a*100+"%"}}),null);function kd({amount:a,l:b,id:c,M:d}){A("div[className=stack]",{title:dc[c]+(b===1?` (${cc[c]}, ${c})`:"")});return[F(jd,{id:c,M:d}),a!==1&&G("div[className=amount]",{innerText:a})]}
function ld({g:a,M:b,ra:c}){A("div[className=bar]",{ontouchstart:C(e=>{a.L=Number(e.target.closest("[data-slot]").dataset.slot);a.qa=e.timeStamp}),S:{opacity:L(.5,K(1,1-(c-a.qa-5E3)*5E-4))}});const d=a.l;return a.B.slice(0,9).map(({c:e},k)=>G("div",{D:{slot:k},F:{active:k===a.L}},[e&&F(kd,{amount:e.amount,data:e.data,l:d,id:e.id,M:b})]))}
function md({Hb:a,M:b}){A("div[className=grid]",{onclick:({target:c})=>{(c=c.closest("[data-id]"))&&hc({c:fc(P(c.dataset.id)),filter:null,V:64},a)}});return cc.map((c,d)=>d>0&&G("div",{D:{id:d}},[F(kd,{amount:1,data:null,l:1,id:d,M:b})]))}
function nd({o:a,M:b}){const c=ea(()=>({c:null,filter:null,V:64})),d=a.g.l;A("div[className=menu overlay inventory]",ea(()=>({onclick:({target:e})=>{if(e.className==="menu overlay inventory")c.c?c.c=null:(a.j=0,a.A=!1,Wc(a));else if(e=e.closest("[data-slot]"))e=a.g.B[P(e.dataset.slot)],c.c?hc(c,e):e.c&&hc(e,c)},oncontextmenu:({target:e})=>{if(e.className==="menu overlay inventory")c.c?--c.c.amount<=0&&(c.c=null):(a.j=0,a.A=!1,Wc(a));else if(e=e.closest("[data-slot]"))e=a.g.B[P(e.dataset.slot)],c.c?
hc(c,e,1):e.c&&hc(e,c,Ea(e.c.amount/2))}})));return[G("div[className=window]",null,[G("h2[innerText=\u0418\u043d\u0432\u0435\u043d\u0442\u0430\u0440]"),d===1&&F(md,{Hb:c,M:b}),G("div[className=grid]",null,a.g.B.map(({c:e},k)=>G("div",{D:{slot:k},F:{first:k<9}},[e&&F(kd,{amount:e.amount,data:e.data,l:d,id:e.id,M:b})])))]),c.c&&G("div[className=hand]",{S:{transform:`translate(${a.tb}px, ${a.ub}px)`}},[F(kd,{amount:c.c.amount,data:c.c.data,l:0,id:c.c.id,M:b})])]}
const od=({I:{Ab:a,time:b,value:c},ra:d})=>(A(a?"div[className=minor]":"div",{innerText:c,S:{opacity:K(1,1-(d-b-4500)*.001)}}),null);function pd({N:a,ra:b}){A("div[className=messages]");const c=b-5E3;return[na(od,a.slice(-10).filter(d=>d.time>c),{ra:b})]}function qd({I:a,ma:b,current:c}){A("button",{disabled:a.id===c,innerText:`${a.label} (${a.owner})`,onclick:()=>{b({T:a.id})}});return null}
function rd({config:a,o:b,sa:c}){b&&B(()=>Yc(b));const d=X.ma,[e,k]=la(!1),l=da(()=>e?O("/static/minicraft/textures.json").then(f=>f.ok?f.json():null).catch(()=>null):Oa.resolve(null),[e],null);A("div[className=menu overlay]");return[G("h1",{innerText:e?"\u041f\u043e\u0432\u0435\u0440\u0445\u043d\u043e\u0441\u0442\u044c":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438"}),G("center",null,[G("button",{innerText:b&&!e?"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u0432 \u0438\u0433\u0440\u0443":
"\u0412\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f",onclick:()=>{e?k(!1):b?(b.j=0,b.A=!1,Wc(b)):c(2)}})]),!e&&G("div[className=settings]",null,[G("button[innerText=\u041f\u043e\u0432\u0435\u0440\u0445\u043d\u043e\u0441\u0442\u044c...]",{onclick:()=>{k(!0)}}),G("label[innerText=\u041a\u0430\u0447\u0435\u0441\u0442\u0432\u043e:]",null,[G("input[type=range][min=1][max=100][step=1]",{value:101-a.X,onchange:f=>d({X:101-Number(f.target.value)})})]),G("label[innerText=\u0420\u0430\u0434\u0438\u0443\u0441 \u0437\u0440\u0435\u043d\u0438\u044f:]",
null,[G("input[type=range][min=1][max=180][step=1]",{value:a.Ja,onchange:f=>d({Ja:Number(f.target.value)})})]),G("label[innerText=\u0414\u0430\u043b\u043d\u043e\u0441\u0442\u044c \u0437\u0440\u0435\u043d\u0438\u044f:]",null,[G("input[type=range][min=1][max=128][step=1]",{value:a.ka,onchange:f=>d({ka:Number(f.target.value)})})]),G("label[innerText=\u0413\u0440\u0443\u043f\u043f\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u0438\u043a\u0441\u0435\u043b\u0435\u0439:]",null,[G("input[type=range][min=1][max=8][step=1]",
{value:a.Da,onchange:f=>d({Da:Number(f.target.value)})})]),G("label[innerText=\u0427\u0443\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043d\u043e\u0439 \u043c\u044b\u0448\u043a\u0438.:]",null,[G("input[type=range][min=1][max=15][step=1]",{value:a.Aa,onchange:f=>d({Aa:Number(f.target.value)})})]),G("button[innerText=\u0421\u0430\u0439\u0442 \u043f\u0440\u043e\u0435\u043a\u0442\u0430]",{onclick:()=>{open("//github.com/L3P3/minicraft")}})]),
b&&!e&&G("center",null,[G("button[innerText=\u041f\u043e\u043a\u0438\u043d\u0443\u0442 \u043c\u0438\u0440]",{onclick:()=>{c(2)}})]),e&&G("div[className=settings]",null,[G("button[innerText=\u041e\u0434\u043d\u043e\u0446\u0432\u0435\u0442\u043d\u044b\u0439]",{disabled:a.T===0,onclick:()=>{d({T:0})}}),l&&na(qd,l,{ma:d,current:a.T})])]}const sd=({I:{Ab:a,value:b}})=>(A(a?"div[className=minor]":"div",{innerText:b}),null);
function td({o:a,N:b}){const c=C({history:null,input:null});A("div[className=menu overlay terminal]",{onclick:d=>{d.target!==c.input&&c.input.focus()}});B(d=>{d&&nb(()=>c.history.scrollTop=1E9,0)},[b.length&&b[b.length-1].id]);return[C(G("div[className=toolbar]",null,[G("button[innerText=\u274c]",{onclick:()=>{a.j=0;a.A=!1;Wc(a)}})])),G("div[className=history]",{R:C(d=>{c.history=d})},[na(sd,b)]),C(G("input[enterkeyhint=send][mozactionhint=send][name=message][required]",{onkeydown:d=>{const e=d.keyCode;
d=d.target;e===13?(id(a,d.value),d.value=""):e===27&&(a.j=0,a.A=!1,Wc(a))},R:d=>{c.input=d;nb(()=>d.focus(),0)}}))]}const ud=[["pick",-2],["up",-14],["down",-15],["E",69],["T",84],["F1",112],["F3",114],["...",27]],vd=[["up",-10],["down",-11],["left",-12],["right",-13],["center",-1]],wd=[["up",-16],["down",-17],["left",-18],["right",-19],["center",-3]];
function xd({o:a}){const b=a.W,c=([d,e])=>G("div",{D:{code:e},F:{button:!0,[d]:!0,active:b.has(e)}});A("div[className=touch]",C({ontouchstart:d=>{let {code:e}=d.target.dataset;if(e!=null&&fd(a,e=P(e),!0)){const k=d.changedTouches[0].identifier,l=f=>{f.changedTouches[0].identifier===k&&(sb("touchend",l),fd(a,e,!1))};rb("touchend",l)}return!1}}));return[G("div[className=top]",null,ud.map(([d,e])=>G(`div[innerText=${d}]`,{D:{code:e},F:{button:!0,active:b.has(e)}}))),G("div[className=move]",null,vd.map(c)),
G("div[className=move sec]",null,wd.map(c))]}
function yd({frame:a,jb:b,state:c,sa:d}){const e=c.config,k=oa(),l=ta.pointerLockElement===a,f=ea(()=>b.o=Xc(a,c));B(()=>{const g=q=>{if(f.j!==0)return!0;ta.pointerLockElement===a?fd(f,-1-q.button,q.type==="mousedown"):Wc(f);return!1},p=q=>{if(ta.pointerLockElement===a){const x=f.config.Aa*va/(L(f.Va,f.Wa)*f.pa);wb&&(f.Bb=q.timeStamp);kc(f.g,f.Xa=q.movementX*x,f.Ya=-q.movementY*x)}else f.tb=q.clientX,f.ub=q.clientY},h=q=>{X.Pa(!1);if(f.j===0&&!f.A&&H.abs(q.deltaY)>5)return q=q.deltaY>0?-5:-4,fd(f,
q,!0),fd(f,q,!1),!1},t={passive:!0};a.addEventListener("mousedown",g);a.addEventListener("mouseup",g);a.addEventListener("mousemove",p,t);a.addEventListener("wheel",h,t);return()=>{a.removeEventListener("mousedown",g);a.removeEventListener("mouseup",g);a.removeEventListener("mousemove",p,t);a.removeEventListener("wheel",h,t);pb(f.ib);qb(f.Ib);Kc(f.world,f.g);var q=f.u;Qc.delete(q);qb(q.Fb);return b.o=null}});B(()=>{f.config=e;f.u&&(f.u.P=!0);const g=f.world;var p=Ea(Ja(f.config.ka/16*2+2));if(g.K!==
p){var h=f.g;g.aa&&Kc(g,h);const t=1<<(g.K=p),q=g.aa=[];for(let x=0;x<t;++x)for(let v=0;v<t;++v)for(let r=0;r<4;++r)q.push({na:!1,l:!1,x,y:r,z:v,La:0,Za:0});p=t<<p+12+2;g.$===null||g.$.length<p?g.Ma=new cb((g.$=new bb(p)).buffer):g.Ma.fill(0);Ic(g,h,!0)}},[e]);B((g,p,h)=>{f.pa=h||1;f.Va=L(1,g);f.Wa=L(1,p);p=f.config.X;g=Ea(f.Va*f.pa/p);p=Ea(f.Wa*f.pa/p);if(g!==f.Ea||p!==f.Fa)f.Ea=g,f.Fa=p,f.u&&(f.u.P=!0,Sc(f.u))},[a.offsetWidth,a.offsetHeight,sa.devicePixelRatio,e.X]);B(g=>{g||f.A||f.j!==0||(f.j=
1,wb&&f.Xa|f.Ya&&f.Bb>k-100&&(kc(f.g,-f.Xa,-f.Ya),f.Xa=f.Ya=0,f.u.P=!0));f.A=!g},[e.oa&&f.j===0||l]);B(g=>l&&g&&ta.exitPointerLock(),[f.A||f.j!==0]);B(()=>{if(f.world){if(f.ga&&!f.A){var g=f.g,p=K(5,(k-f.ga)*.01);g.ha-=g.ha*.1*p;g.ia-=g.ia*.1*p;g.ja-=g.ja*.1*p;g.ha+=(Ga(g.O)*g.$a+Ha(g.O)*g.ab)*p;g.ia+=g.pb*p;g.ja+=(-Ha(g.O)*g.$a+Ga(g.O)*g.ab)*p;kc(g,g.Cb*p*1.5,g.Db*p*1.5);g.G+=g.ha*p;g.H+=g.ia*p;g.J+=g.ja*p}if(f.u){g=f.u;++g.gb;p=g.bb;var h=g.qb;const W=g.rb,fa=g.o,Pa=fa.config,Hb=fa.za,w=fa.g,J=
fa.Ea,pa=fa.Fa,M=fa.world;var t=0;if(!fa.A||g.P){g.P=!1;var q=Pa.Da;const Cd=Pa.ka;var x=w.O,v=w.la;const Dd=w.da,Ed=w.ea,Qa=w.l;var r=w.G;t=w.H;var u=w.J;const Fd=Hb?w.U:-1,Gd=M.$;var V=M.K;const Hd=Oc!==null;var ib=1/J,wa=1/pa;const ha=J>>1,qa=pa>>1,xc=K(J,pa),yc=xc>32,zc=Ga(x);x=Ha(x);const Ac=Ga(-v);v=Ha(-v);var Aa=Pa.Ja/45;const Id=ib*(J<pa?Aa*J*wa:Aa);ib=wa*(pa<J?Aa*pa*ib:Aa);r+=65536;wa=t+65536;u+=65536;Aa=r%1;const Jd=wa%1,Kd=u%1;V=4+V;const Ba=(1<<V)-1;q=q<J?q:1;const Ld=J-q;let Bc=w.l===
1?6:4,Ra=w.da=w.ea=w.va=0,Cc=0;w.U=-1;t=t<0||t>=64?0:sc(M,r&Ba,wa&63,u&Ba);if(Qa!==2&&t>0)w.da=r&Ba,w.U=wa&63,w.ea=u&Ba,w.va=6,W.fill(ec[t]|4278190080);else{for(let Sa=0;Sa<pa;++Sa){var jb=(qa-Sa)*ib;const Dc=jb*Ac-v;var Ib=jb*v+Ac;jb=Ib*x;Ib*=zc;let ia=0,Ca=!1;var Ta=!1;a:for(let R=0;R<J;R+=q)for(let aa=Ta?1:0;aa<q;++aa){if(q<2)var D=R;else if(R===0)D=aa===0?0:aa===1?q:aa-1,Ca=aa===1;else if(R<Ld)D=(Ca=aa===1)?R+q:R+aa-1;else{if((D=aa===0?R-1:R+aa)>=J)break a;Ca=!1}var S=(D-ha)*Id;Ta=jb+zc*S;const Ec=
Ib-x*S,Md=Cc;S=16757124;let kb=1,Fc=Cd,lb=0;Qa===2&&t>0&&(lb=Da()*10);for(let Jb=0;Jb<3;++Jb){const T=(Md+Jb)%3;let ba=Ec;var E=Kd;T===0&&(ba=Ta,E=Aa);T===1&&(ba=Dc,E=Jd);var ra=-1/ba;ba>0&&(E=1-E,ra*=-1);const mb=Ta*ra,xa=Dc*ra;ra*=Ec;const Gc=Ia(mb*mb+xa*xa+ra*ra);let Ua=r+mb*E-(T===0&ba<0|0),Va=wa+xa*E-(T===1&ba<0|0),Wa=u+ra*E-(T===2&ba<0|0);E*=Gc;for(let Kb,Lb,Mb,U;E<Fc;Ua+=mb,Va+=xa,Wa+=ra,E+=Gc)if(!(Qa===2&&E<lb))if(Va<65536){if(xa<0)break}else if(Va>=65600){if(xa>0)break}else if((U=Gd[((Kb=
Ua&Ba)<<V|(Mb=Wa&Ba))<<6|(Lb=Va&63)])!==0){Qa!==2&&Sa===qa&&D===ha&&E<=Bc&&(w.da=Kb,w.U=Lb,w.ea=Mb,w.va=ba<0|T<<1,Bc=E);if(Hd){--U;T===1?U===6?U=25:U===13?U=4:U===1&&xa>0&&(U=2):U===1&&(U=24);const Hc=Oc[U<<8|((T===1?Wa:Va)*16&15)<<4|(T===1?Ua:(ba>0?Ua-Wa:Wa-Ua)+65536)*16&15];if(Hc>>>24===0)continue;S=Hc&16777215}else S=ec[U];Fc=E;kb=(T===0?.8:T===2?.6:ba>0?.4:1)+(Lb!==Fd||Kb!==Dd||Mb!==Ed?0:.2);Cc=T;break}else Qa===2&&E<lb&&(lb=E)}S=4278190080|K((S>>16)*kb,255)<<16|K((S>>8&255)*kb,255)<<8|K((S&255)*
kb,255);if(Ta=(Ca=Ca&&(Sa!==qa||D<ha||D>ha+q))&&ia===S){if(q>6){W.fill(ia,Ra+R+1,Ra+R+q+1);break}D=Ra+R+1;W[D]=ia;W[++D]=ia;if(q<3)break;W[++D]=ia;if(q<4)break;W[++D]=ia;if(q<5)break;W[++D]=ia;if(q<6)break;W[++D]=ia;break}if(Ca||D===0)ia=S;W[Ra+D]=S}Ra+=J}Hb&&!yc&&(W[J*qa+ha]^=16777215)}p.putImageData(h,0,0);Hb&&yc&&(h=K(Ea(xc*.05),8),p.fillRect(ha-h,qa-1,h<<1,2),p.fillRect(ha-1,qa-h,2,h-1),p.fillRect(ha-1,qa+1,2,h-1))}g.wb=fa.Qa?`minicraft ${"0.11.6"} ${I(g.xb).toString().padStart(2,"\u00a0")} fps, T: ${I(M.kb*
24).toString().padStart(2,"0")}:${I(M.kb*24%1*60).toString().padStart(2,"0")}; ${fa.A&&k%1E3<500?"":M.time}
R: ${J}x${pa} (x${Pa.X}), D: ${Pa.ka}, C: ${M.ya}/${M.Oa.length}, M: ${xb(1<<4+M.K)*64>>10}k
E: 0/0, M: ${w.l}, I: ${t}

Position: ${w.G.toFixed(2)} ${w.H.toFixed(2)} ${w.J.toFixed(2)}
Angle: ${(w.O*za).toFixed(2)} ${(w.la*za).toFixed(2)}
Focus: ${w.U<0?"":w.da+" "+w.U+" "+w.ea+" "+"WEBTSNI"[w.va]+": "+cc[sc(M,w.da,w.U,w.ea)]}
Chunk abs: ${I(w.G)>>4} ${I(w.J)>>4} ${I(w.H)>>4} rel: ${M.Ra} ${M.Ta} ${M.Sa}`:""}}f.ga=k},[k]);ka();const n=C({lb:1});e.T&&(n.lb=e.T);return[G("canvas",{R:C(g=>f.u=Tc(f,g))}),f.za&&f.j!==2&&F(pd,{N:f.N,ra:k}),f.u&&f.Qa&&G("div[className=diagnostics]",{innerText:f.u.wb}),e.oa&&F(xd,{o:f,hb:f.hb}),f.za&&f.j!==3&&f.g.l!==2&&F(ld,{g:f.g,M:n.lb,ra:k}),f.j===3&&F(nd,{o:f,M:n.lb,ra:k}),f.j===1&&F(rd,{config:e,o:f,sa:d}),f.j===2&&F(td,{o:f,N:f.N})]}
function zd({I:a,Jb:b,Kb:c,ua:d}){A("div",{F:{selected:a===b},onclick:()=>{c(a.id)}});b=`${a.local?"L":"_"}${a.local&&a.remote?a.local>a.remote?">":a.local<a.remote?"<":"=":"_"}${a.remote?a.public?"R":"r":"_"}`;d===a.id&&(b=`[${b}]`);return[G("span",{innerText:`${b} ${a.label}`,title:a.account_name?"\u0412\u043b\u0430\u0434\u0435\u043b\u0435\u0446: "+a.account_name:"\u0422\u043e\u043b\u043a\u043e \u043b\u043e\u043a\u0430\u043b\u043d\u044b\u0439 \u043c\u0438\u0440"}),G("span",{innerText:zb(L(a.local,
a.remote),!0)})]}
function Ad({state:{account:a,config:b,ba:c,nb:d,ta:e,ua:k,ca:l},sa:f}){A("div[className=menu]");const [n,g]=la(b.Ka),p=n!==Sb?n:(g(Tb),Tb),h=ea(()=>l.find(r=>r.id===p)||null,[p,l]),[t,q]=la(!1);h||q(!1);const [x,v]=la(!1);return[G("h1[innerText=\u041c\u0438\u0440\u044b]"),G("button[innerText=\u041e\u0431\u043d\u043e\u0432\u0438\u0442][style=position:absolute;left:0;top:0;height:2rem][title=\u041e\u0431\u043d\u043e\u0432\u0438\u0442 \u0441\u043f\u0438\u0441\u043e\u043a]",{disabled:d||e||c!==null,
onclick:Wb}),G("button[style=position:absolute;right:0;top:0;height:2rem]",{disabled:a.rank>0,innerText:a.rank?a.label:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f ",onclick:()=>{location.href="/account?redir=minicraft"}}),G("div[className=worlds]",null,[na(zd,l,{Lb:Ma.now(),Jb:h,Kb:g,ua:k})]),G("center",null,[G("button[innerText=\u041e\u0442\u043a\u0440\u044b\u0442]",{disabled:!h||h.local<2||h.remote>h.local,onclick:()=>{z();X.ma({Ka:h.id});
f(0);ca()},title:h?h.local<2?"\u041c\u0438\u0440 \u0435\u0449\u0435 \u043d\u0435 \u0441\u043a\u0430\u0447\u0435\u043d!":h.local<h.remote?"\u041c\u0438\u0440 \u0435\u0449\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u0430!":"\u0417\u0430\u0439\u0442\u0438 \u043d\u0430 \u0432\u044b\u0431\u0440\u0430\u043d\u044b\u0439 \u0441\u0435\u0440\u0432\u0435\u0440":"\u041c\u0438\u0440 \u0431\u044b\u043b \u043d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u044c!"}),G("button[innerText=\u041c\u0438\u0440...]",
{disabled:!h||t,onclick:()=>{q(!0)},title:h?"\u0410\u043a\u0446\u0438\u0438/\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043c\u0438\u0440\u0430":"\u041c\u0438\u0440 \u0431\u044b\u043b \u043d\u0435 \u0432\u044b\u0431\u0440\u0430\u043d\u044c!"})]),G("hr"),G("center",null,[G("button[innerText=\u041d\u043e\u0432\u044b\u0439 \u043c\u0438\u0440]",{onclick:()=>{const r=vb("\u0418\u043c\u044f \u043d\u043e\u0432\u043e\u0433\u043e \u041c\u0438\u0440\u0430:\n(\u043c\u0430\u043a\u0441. 16 \u0441\u0438\u043c\u0431\u043e\u043b\u043e\u0432)",
"\u041d\u043e\u0432\u044b\u0439 \u043c\u0438\u0440");r&&(r.length>16?tb("\u0418\u043c\u044f \u0441\u043b\u0438\u0448\u043a\u043e\u043c \u0434\u043e\u043b\u0433\u043e\u0435!"):X.mb({id:K(0,...b.worlds.map(u=>u.id))-1,label:r,mod_l:Ma.now(),mod_r:0}))}}),G("button[innerText=\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438]",{onclick:()=>{f(1)}})]),G("center",null,[G("small[innerText=\u0412\u0435\u0440\u0441\u0438\u044f 0.11.6 \u043e\u0442 L3P3]")]),t&&h&&G("div",{F:{"menu overlay advanced":!0,
busy:x},onclick:r=>{r.target.className==="menu overlay advanced"&&q(!1)}},[G("div[className=window]",null,[G("h2",{innerText:`"${h.label}"`,title:h.id}),G("table",null,[!!h.account_name&&G("tr",null,[G("td[innerText=\u0412\u043b\u0430\u0434\u0435\u043b\u0435\u0446:]"),G("td",{innerText:h.account_name})]),G("tr",null,[G("td[innerText=\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f:]"),G("td",{innerText:zb(L(h.local,h.remote),!1)})])]),G("center",null,[G("button[innerText=\u041f\u0435\u0440\u0435\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u0442\u044c]",
{disabled:x||!h.writable,onclick:()=>{const r=vb("\u041d\u043e\u0432\u043e\u0435 \u0438\u043c\u044f \u043c\u0438\u0440\u0430:\n(\u043c\u0430\u043a\u0441. 16 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)",h.label);!r||r===h.label||r.length>16||(h.local&&X.Z(h.id,{label:r}),h.remote&&(v(!0),O("/api/minicraft/world",{method:"POST",headers:{"Content-Type":"application/json"},body:Xa({what:"meta",world:h.id,label:r})}).then(u=>{if(!u.ok)throw Error(u.status===403?"\u041d\u0435\u0442\u0443 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f. \u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d?":
"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f.");return u.json()}).catch(u=>{tb("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u043c\u0438\u0440\u0430: "+u.message)}).then(()=>{v(!1)})))},title:h.writable?"\u0418\u0437\u043c\u0435\u043d\u0438\u0442 \u0438\u043c\u044f \u043c\u0438\u0440\u0443":"\u041d\u0435\u0442 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438!"}),
G("button",{disabled:x||!h.local&&!h.writable,innerText:h.local?"\u0423\u0434\u0430\u043b\u0438\u0442\u044c (\u043b\u043e\u043a\u0430\u043b)":"\u0423\u0434\u0430\u043b\u0438\u0442\u044c",onclick:()=>{ub('\u041c\u0438\u0440 "'+h.label+'" \u0442\u043e\u0447\u043d\u043e \u0443\u0434\u0430\u043b\u0438\u0442\u044c?')&&(h.local?(X.ob(h.id),Gb(h.id)):(v(!0),O("/api/minicraft/world",{method:"DELETE",headers:{"Content-Type":"application/json"},body:Xa({what:"world",world:h.id})}).then(r=>{if(!r.ok)throw Error(r.status===
403?"\u041d\u0435\u0442\u0443 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f. \u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d?":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f.");z();g(null);q(!1);Wb();v(!1);ca();return r.json()}).catch(r=>{tb("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043c\u0438\u0440\u0430: "+r.message);v(!1)})))},
title:h.local||h.writable?"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u043c\u0438\u0440":"\u041d\u0435\u0442 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438!"})]),G("center",null,[G("button",{disabled:x||!h.remote||!h.writable,innerText:`${"\u041f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439"}: ${h.public?"\u0414\u0430":"\u041d\u0435\u0442"}`,onclick:()=>{v(!0);O("/api/minicraft/world",{method:"POST",headers:{"Content-Type":"application/json"},body:Xa({what:"meta",world:h.id,
public:!h.public})}).then(r=>{if(!r.ok)throw Error(r.status===403?"\u041d\u0435\u0442\u0443 \u0440\u0430\u0437\u0440\u0435\u0448\u0435\u043d\u0438\u044f. \u0417\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d?":"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f.");z();Wb();v(!1);ca();return r.json()}).catch(r=>{tb("\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u043c\u0438\u0440\u0430: "+
r.message);v(!1)})},title:h.remote?h.writable?h.public?"\u041f\u0440\u0438\u0432\u0430\u0442\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u0438\u0440":"\u041e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u0442 \u043c\u0438\u0440":"\u041d\u0435\u0442 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0438\u0438!":"\u041c\u0438\u0440 \u043d\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0435\u043d!"}),G("button",{disabled:x||!Ob||h.local>0&&h.remote>0||!h.remote&&!a.rank,
innerText:h.local?Ob&&h&&!h.remote?"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442":"\u041f\u0435\u0440\u0435\u043d\u0435\u0441\u0442\u0438":"\u0421\u043a\u0430\u0447\u0430\u0442\u044c",onclick:()=>{h.local?h.remote||X.Z(h.id,{mod_r:1}):X.mb({id:h.id,label:h.label,mod_l:1,mod_r:h.remote})},title:Ob?h.local?h.remote?"\u041c\u0438\u0440 \u0443\u0436\u0435 \u0435\u0441\u0442\u044c \u043d\u0430 \u0434\u0432\u0443\u0445 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430\u0445!":a.rank?"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442 \u043c\u0438\u0440 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440":
"\u041d\u0435 \u0437\u0430\u0440\u0435\u0433\u0435\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d!":"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442 \u043c\u0438\u0440 \u0438\u0437 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 ":"\u0421\u043f\u0438\u0441\u043e\u043a \u0435\u0449\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044f!"})])])])]}let Bd=0;
function Nd({state:a,jb:b}){const [c,d]=la(2);B(()=>{pb(Bd);a.ba||(Bd=nb($b))},[a.ba,a.ca]);const e=A("div[className=game]");return[(c===2||c===1)&&F(Ad,{state:a,sa:d}),c===1&&F(rd,{config:a.config,o:null,sa:d}),c===0&&F(yd,{frame:e,jb:b,state:a,sa:d}),c===2&&a.ba&&G("div[style=position:absolute;bottom:0;left:0;color:yellow]",{title:a.ba},[G("span[innerText=\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f. ]"),G("button[innerText=\u041f\u043e\u0432\u0442\u043e\u0440\u0438\u0442\u044c]",
{onclick:()=>{X.Y({ba:null})}})])]}
function Od(){const a=([Ub,X]=ja(bc),Ub),b=C({o:null,zb:0});B(()=>{Vb(!0);let l=!1;onbeforeunload=onunload=onpagehide=onblur=()=>{l||(l=!0,b.o&&Yc(b.o),X.cb())};onpageshow=onfocus=()=>{l=!1};ob(()=>(X.cb(),!La&&Za("minicraft.lock",Ma.now())),500);rb("touchend",f=>{b.zb=f.timeStamp},!0)});const c=C(l=>{if(l.target.tagName==="INPUT"||!b.o)return!0;X.Pa(!1);fd(b.o,l.keyCode,l.type==="keydown");return!1}),d=C(()=>{X.Pa(!0)}),e=C(l=>{l.timeStamp-b.zb>999&&X.Pa(!1)}),k=a.config.oa;B(()=>{k?(rb("mousedown",
e,!0),rb("mouseup",e,!0),sb("touchstart",d,!0)):(sb("mousedown",e,!0),sb("mouseup",e,!0),rb("touchstart",d,!0))},[k]);B(Rc,[a.config.T]);A("",{onkeydown:c,onkeyup:c,oncontextmenu:yb,ondragstart:yb});return[F(Nd,{jb:b,state:a})]}function Pd(){close();return[G("h1[innerText=\u043c\u0438\u043d\u0438\u043a\u0440\u0430\u0444\u0442 \u0443\u0436\u0435 \u0437\u0430\u043f\u0443\u0449\u0435\u043d!]")]}
if(window.SSR)ma(Od);else if(La){const a=new La("minicraft.lock"),b=nb(ma,100,Od);a.addEventListener("message",c=>{c.data==="yes"?(pb(b),a.close(),ma(Pd)):(a.postMessage("yes"),focus())});a.postMessage("anyone there?")}else{const a=P(N.getItem("minicraft.lock")),b=Ma.now()-1E3;a<b?ma(Od):nb(()=>{ma(P(N.getItem("minicraft.lock"))===a?Od:Pd)},a-b)};
