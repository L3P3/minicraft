const k=lui,m=k.hook_dom,q=k.hook_effect,aa=k.hook_memo,ba=k.hook_rerender,r=k.hook_static,E=k.node,F=k.node_dom,xa=k.now,G=Math,M=G.PI,N=180/M,O=G.floor,V=G.round,ya=G.min,W=G.max,X=G.cos,Y=G.sin,za=[0,7960953,8370002,7885881,8553090,9927501,4539717,6311215,3113506,12094592,14145495],Aa="WEBTSN".split(""),Ca=()=>{const a={o:Ba(),pa:8,qa:32,ra:8};for(let d=0;16>d;d+=2)a.o[1024+(d<<4)]=3,a.o[1024+d]=3;["X   XXX XXX XXX","X     X X X   X","X   XXX XXX XXX","X     X X     X","XXX XXX X   XXX"].forEach((d,
b,g)=>{b=g.length-b;d.split("").forEach((c,e)=>{"X"===c&&(a.o[1024+(e+1<<4)+b]=6)})});return a},Ba=()=>{const a=new Uint8Array(16384),d=[6,3,3,3,2];for(let b=-1,g=0;g<d.length;++g){const c=d[g];for(let e=0;16>e;++e)for(let n=0;16>n;++n)a[++b]=c}return a},Da=(a,d)=>{const b={canvas:d,ea:null,fa:null,ga:"",J:!1,ha:0,Z:0,ja:setInterval(()=>{b.ha=b.Z;b.Z=0},1E3),j:a};Z(b);return b},Z=a=>{var d=a.canvas.width=a.j.K,b=a.canvas.height=a.j.L;a=(a.fa=(a.ea=a.canvas.getContext("2d")).createImageData(d,b)).data;
d=a.length;for(b=3;b<d;b+=4)a[b]=255},Ea=()=>({O:!1,P:!1,i:!1,$:0,g:{G:0,N:0,H:0,T:0,U:10,V:0,A:0,B:0,D:0,m:0,X:0,s:0,l:-1,u:0,Y:0},h:null,v:10,aa:1,ba:1,K:0,L:0,ia:null,time:0,ca:0,W:80,M:64,da:Ca()}),Ga=(a,d)=>{onmousemove=b=>{a.i||(a.g.m=2*(b.clientX/a.aa-.5)*M,a.g.X=(.5-b.clientY/a.ba)*M)};onmousedown=onmouseup=b=>a.i||(Fa(a,-1-b.button,"mousedown"===b.type),b.preventDefault(),!1);a.h=Da(a,d);a.ia=setInterval(()=>{a.i||(a.time=(a.time+1)%24E3,a.ca=1/24E3*(a.time+6E3)%1)},50)},Ha=a=>{const d=W(1,
V(a.aa/a.v)),b=W(1,V(a.ba/a.v));if(d!==a.K||b!==a.L)a.K=d,a.L=b,a.h&&(a.h.J=!0,Z(a.h))},Fa=(a,d,b)=>{if(b)switch(d){case -1:0<=a.g.l&&(a.da.o[(a.g.l<<8)+(a.g.s<<4)+a.g.u]=0);break;case -3:if(a.g.l){d=a.g.s;b=a.g.l;let g=a.g.u;switch(a.g.Y){case 0:--d;break;case 1:++d;break;case 2:--b;break;case 3:++b;break;case 4:--g;break;default:++g}0<=b&&64>b&&(a.da.o[(b<<8)+((d&15)<<4)+(g&15)]=9)}break;case 27:a.i=a.P=!a.P;break;case 16:a.g.N=-.1;break;case 32:a.g.N=.1;break;case 65:a.g.G=-.1;break;case 68:a.g.G=
.1;break;case 80:a.i=!a.i;break;case 83:a.g.H=-.1;break;case 87:a.g.H=.1;break;case 114:a.O=!a.O;break;default:return!0}else switch(d){case 16:case 32:a.g.N=0;break;case 65:case 68:a.g.G=0;break;case 83:case 87:a.g.H=0;break;default:return!0}return!1};
function Ia({j:a}){m("div[className=menu]");return[F("h1[innerText=Men\u00fc]"),F("div[className=settings]",null,[F("label[innerText=Aufl\u00f6sung:]",null,[F("input[type=range][min=1][max=100][step=1]",{value:101-a.v,onchange:r(d=>{a.v=101-Number(d.target.value);Ha(a)})})]),F("label[innerText=Blickwinkel:]",null,[F("input[type=range][min=1][max=180][step=1]",{value:a.W,onchange:r(d=>{a.W=Number(d.target.value);a.h.J=!0})})]),F("label[innerText=Sichtweite:]",null,[F("input[type=range][min=1][max=128][step=1]",
{value:a.M,onchange:r(d=>{a.M=Number(d.target.value);a.h.J=!0})})])]),F("div",null,[F("button[innerText=Zur\u00fcck]",{onclick:r(()=>{a.i=a.P=!1})})])]}
function Ja({ka:a}){const d=m("div[className=game]"),b=aa(Ea);q(()=>(a.j=b,()=>{onmousemove=onmousedown=onmouseup=null;clearInterval(b.ia);clearInterval(b.h.ja);return a.j=null}));q((g,c)=>(b.aa=W(1,g),b.ba=W(1,c),Ha(b)),[d.offsetWidth,d.offsetHeight]);q(g=>{if(b.$&&!b.i){var c=b.g,e=ya(5,.01*(g-b.$));c.A-=.1*c.A*e;c.B-=.1*c.B*e;c.D-=.1*c.D*e;c.A+=(X(c.m)*c.G+Y(c.m)*c.H)*e;c.B+=c.N*e;c.D+=(-Y(c.m)*c.G+X(c.m)*c.H)*e;c.T+=c.A*e;c.U+=c.B*e;c.V+=c.D*e}if(b.h){c=b.h;++c.Z;var n=c.fa;e=c.j;const f=e.g;
var x=e.da;if(!e.i||c.J){c.J=!1;const P=n.data,t=e.K,u=e.L,La=e.M,ca=.5*t,da=.5*u,ea=1/t,fa=1/u,Ma=ca|0,Na=da|0;var y=f.m,z=f.X;const ha=f.U,ia=X(y);y=Y(y);const ja=X(-z);z=Y(-z);var v=e.W/45;const Oa=t<u?v*t*fa:v;v=u<t?v*u*ea:v;const ka=f.T+1073741824,la=f.V+1073741824,Pa=f.s,Qa=f.l,Ra=f.u;let H=0,ma=0,na=-1,oa=0,pa=0;for(let I=0;I<u;++I){const Sa=I===Na;var A=(da-I)*fa*v;const qa=A*ja-z;A=A*z+ja;for(let J=0;J<t;++J){var K=J===Ma;K=Sa&&K;var B=(J-ca)*ea*Oa;const ra=A*y+B*ia;B=A*ia-B*y;let L=8696319,
w=1,sa=La;for(let l=0;3>l;++l){const p=0===l?ra:1===l?qa:B,C=1/(0>p?-p:p),ta=ra*C,ua=qa*C,va=B*C;var h=0===l?ka%1:1===l?ha%1:la%1;h=0>h?-h:h;h=0<p?1-h:h;let Q=ka+ta*h,R=ha+ua*h,S=la+va*h;h*=C;for(0===l?Q+=0>p?-.5:.5:1===l?R+=0>p?-.5:.5:S+=0>p?-.5:.5;h<sa;){const T=Q&15,U=S&15,D=R|0,wa=0>D||64<=D?0:x.o[(D<<8)+(T<<4)+U];if(0===wa)Q+=ta,R+=ua,S+=va,h+=C;else{sa=h;L=za[wa];w=1-(l+2)%3*.2;D===Qa&&T===Pa&&U===Ra&&(w+=.1);K&&5>=h&&(ma=T,na=D,oa=U,pa=l<<1|0>p);break}}}K&&(w*=2);P[H]=(L>>16&255)*w;P[++H]=
(L>>8&255)*w;P[++H]=(L&255)*w;H+=2}}c.ea.putImageData(n,0,0);f.s=ma;f.l=na;f.u=oa;f.Y=pa}e.O?(0>f.l?x=0:(n=f.l,x=f.s+" "+f.l+" "+f.u+" "+Aa[f.Y]+": "+(0>n||64<=n?0:x.o[(n<<8)+(f.s<<4)+f.u])),e="Minicraft 0.1.9 "+O(c.ha).toString().padStart(2,"\u00a0")+" fps, T: "+O(24*e.ca).toString().padStart(2,"0")+":"+O(24*e.ca%1*60).toString().padStart(2,"0")+"; "+(e.i&&500>g%1E3?"":e.time)+"\nR: "+e.K+"x"+e.L+" (x"+e.v+"), C: 1, D: "+e.M+"\nE: 0/0\n\nPosition: "+f.T.toFixed(2)+" "+f.U.toFixed(2)+" "+f.V.toFixed(2)+
"\nAngle: "+(f.m*N).toFixed(2)+" "+(f.X*N).toFixed(2)+"\nBlock: "+x+"\nChunk: 0 0"):e="";c.ga=e}b.$=g},[xa()]);ba();return[F("canvas",{R:r(g=>{Ga(b,g)})}),b.h&&b.O&&F("div[className=diagnostics]",{innerText:b.h.ga}),b.P&&E(Ia,{j:b,la:b.v,ma:b.W,na:b.M})]}const Ka=()=>!1;k.init(()=>{const a=r({j:null}),d=r(b=>!a.j||Fa(a.j,b.keyCode,"keydown"===b.type)||(b.preventDefault(),!1));return[{onkeydown:d,onkeyup:d,oncontextmenu:Ka,oa:Ka},[E(Ja,{ka:a})]]});
