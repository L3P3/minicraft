const q=lui,aa=q.dom_define,v=q.hook_dom,A=q.hook_effect,ea=q.hook_memo,fa=q.hook_model,ha=q.hook_rerender,B=q.hook_static,E=q.node,F=q.node_dom,ia=q.node_map,ja=q.now,ka="air stone grass dirt cobble planks bedrock log leaves bricks wool sand gravel glass bookshelf obsidian stone_bricks sandstone lapis_block iron_block gold_block diamond_block emerald_block redstone_block quartz_block".split(" "),ra=[0,8487297,4305266,4349313,8092539,5342114,7039851,3561583,4172910,6384533,15526888,10671324,8092798,
16447200,4151672,1970708,8092539,9686227,9126695,15198183,5567485,14541182,7920469,662956,14936813],sa="WEBTSN".split(""),ta=window,ua=document,J=Math,va=J.PI,wa=.5*va,xa=180/va,K=J.floor,Da=J.ceil,Ea=J.round,L=J.min,M=J.max,Fa=J.cos,Ga=J.sin,Ha=J.sqrt,Ia=J.log2,Ja=String.fromCharCode,Ka=JSON,La=Ka.stringify,Ra=Ka.parse,N=localStorage,Sa=N.setItem.bind(N),Ta=Uint8Array,Ua=Uint32Array,Va=Map,O=Number,Wa=setTimeout,Xa=setInterval,Ya=clearTimeout,Za=clearInterval,R=a=>a*a,$a=()=>!1,ab=({id:a})=>(v("#tile",
{S:{backgroundPositionY:`-${2*(a-1)}rem`}}),null);function bb({amount:a,id:b}){v("div[className=stack]",{title:ka[b]});return[E(ab,{id:b}),1!==a&&F("div[className=amount]",{innerText:a})]}
const cb=a=>{a+=32;33<a&&39>a?a++:38<a&&44>a?a+=2:43<a&&127>a?a+=3:126<a&&55258>a?a+=37:55295<a&&(a+=8485);return Ja(a)},db=a=>a-(63743<a?8517:159<a?69:46<a&&130>a?35:40<a&&46>a?34:34<a&&40>a?33:32),fb=()=>{var a=eb;const b=a.length,d=new Va,c=t=>{m=m<<1|t&1;15===++n&&(l+=cb(m),m=n=0)},e=()=>{for(let t=0;t<r;++t)c(0)},h=t=>{c(t);c(t>>1);c(t>>2);c(t>>3);c(t>>4);c(t>>5);c(t>>6);c(t>>7)},k=()=>{0===--w&&(w=1<<r++)},f=()=>{if(y)y=!1;else{let t=u.id;for(let C=0;C<r;C++)c(t>>C)}};let g=a[0],l="",m=0,n=
2,r=2,w=2,x=2,u={id:x++,Aa:new Va},y=!0;h(g);d.set(g,u);for(let t=1;t<b;++t){const C=u.Aa.get(g=a[t]);C?u=C:(f(),d.has(g)||(k(),e(),h(g),d.set(g,{id:x++,Aa:new Va}),y=!0),u.Aa.set(g,{id:x++,Aa:new Va}),u=d.get(g),k())}f();d.has(g)||(k(),e(),h(g));k();c(1);--r;e();return l+=cb(m<<15-n)},gb=a=>{var b=eb;if(!a)return null;const d=a.length,c=()=>{n+=(x>>--u&1)<<r++;0===u&&(u=15,x=db(a.charCodeAt(w++)))};let e=[0,1],h=1,k=3,f=2,g=null;var l=null;let m=0,n=0;l=2;let r=0,w=0,x=db(a.charCodeAt(w++)),u=15;
for(;r<l;)c();if(1===n)return null;for(n=r=0;8>r;)c();g=[n];e[2]=g;for(b[m++]=n;w<=d;){l=f;for(n=r=0;r<l;)c();if(0===n){for(n=r=0;8>r;)c();e[k]=[n];n=k++;0===--h&&(h=1<<f++)}else if(1===n)return b;l=n<e.length?e[n]:g.concat(g[0]);for(let y=0;y<l.length;y++)b[m++]=l[y];e[k++]=g.concat(l[0]);g=l;0===--h&&(h=1<<f++)}return null},S=(a,b=1,d=null)=>({amount:b,data:d,id:a}),T=new Ua(1024),eb=new Ta(T.buffer),hb=new Va,ib=(a,b,d,c)=>0>d||63<d?0:a.X[(b<<a.M+4|c)<<6|d],jb=(a,b,d,c)=>{const e=a.M;a.X[(b<<e+
4|c)<<6|d]=0;a.Y[(b>>4<<e|c>>4)<<2|d>>4].ha=!0},kb=(a,b,d,c,e)=>{const h=a.M,k=(b<<h+4|c)<<6|d;if(0<a.X[k])return!1;a.X[k]=e;return a.Y[(b>>4<<h|c>>4)<<2|d>>4].ha=!0},nb=(a,b,d)=>{const c=M(L(b.K,63),0)>>4,e=K(b.J)>>4;b=K(b.L)>>4;if(d||a.Ea!==c||a.ra+a.Da!==e||a.sa+a.Fa!==b)d=1<<a.M,a.Ea=c,a.ra=e-(a.Da=(65536+e)%d),a.sa=b-(a.Fa=(65536+b)%d),lb(a);mb(a,!1)},lb=a=>{const b=a.Da,d=a.Ea,c=a.Fa,e=a.M,h=`${e} ${b} ${c} ${d}`;let k=hb.get(h);if(null==k){const f=1<<e,g=R(.5*f);hb.set(h,k=a.Y.map(({x:l,y:m,
z:n},r)=>{let w=R(l-b),x=R(n-c),u=R(l-b-f),y=0,t=0;u<w&&(w=u,y=-f);(u=R(l-b+f))<w&&(w=u,y=f);(u=R(n-c-f))<x&&(x=u,t=-f);(u=R(n-c+f))<x&&(x=u,t=f);return{Oa:w+x+R(m-d),Xa:r,ra:y,sa:t}}).filter(({Oa:l})=>l<=g).sort((l,m)=>l.Oa-m.Oa))}a.Ba=k;a.oa=0},pb=(a,b)=>{for(var d of a.Y)d.ha&&ob(a,d);for(d=b.H.map(({content:c})=>c&&[c.id,c.amount,c.data]);0<d.length&&null===d[d.length-1];)d.pop();Sa(`minicraft.world.${a.id}:meta`,La({p:{h:b.fb,i:d,m:b.G,p:[b.J,b.K,b.L,b.O,b.ea]},s:[a.ta,a.ua,a.va],v:1}))},Bb=
(a,b)=>{const d=N.getItem(`minicraft.world.${a.id}:meta`);if(d){const {p:c,s:e,v:h}=Ra(d);null!=h&&(c.i.forEach((k,f)=>{k&&(b.H[f].content=S(k[0],k[1],k[2]))}),b.fb=c.h,b.G=c.m,b.J=c.p[0],b.K=c.p[1],b.L=c.p[2],b.O=c.p[3],b.ea=c.p[4],a.ta=e[0],a.ua=e[1],a.va=e[2])}},Cb=(a,b,d,c)=>`minicraft.world.${a.id}:${b}/${d}`+(0<c?"/"+c:""),ob=(a,b)=>{const d=a.za;var c=a.M;const e=b.y,h=(256<<c)-256;for(let k=0,f=-1,g=((b.x<<c+4|b.z)<<6|e)<<2;16>k;++k){for(c=0;16>c;++c)T[++f]=d[g],T[++f]=d[++g],T[++f]=d[++g],
T[++f]=d[++g],g+=13;g+=h}Sa(Cb(a,b.xa,b.Ja,e),fb());b.ha=!1},mb=(a,b)=>{const d=a.Y,c=a.Ba,e=a.ra,h=a.sa,k=c.length;for(;a.oa<k;){var f=c[a.oa++],g=d[f.Xa],l=g.loaded,m=g.x;const w=g.y;var n=g.z,r=e+f.ra+m;f=h+f.sa+n;if(!l||r!==g.xa||f!==g.Ja)if(g.ha&&ob(a,g),g.loaded=!0,f=gb(N.getItem(Cb(a,g.xa=r,g.Ja=f,w))),l||0===w||f){g=a.za;const x=a.M;r=(256<<x)-256;m=((m<<x+4|n)<<6|w)<<2;if(f)for(let u=0,y=-1;16>u;++u){for(l=0;16>l;++l)g[m]=T[++y],g[++m]=T[++y],g[++m]=T[++y],g[++m]=T[++y],m+=13;m+=r}else for(n=
0;16>n;++n){for(f=0;16>f;++f)g[m]=0<w?0:50397446,g[++m]=0<w?0:131843,l?(g[++m]=0,g[++m]=0,m+=13):m+=15;m+=r}if(!b)break}}};let Db=null,Eb=null,Fb=new Image;Fb.crossOrigin="anonymous";Fb.onload=()=>{const a=ua.createElement("canvas");a.width=16;a.height=416;const b=a.getContext("2d");b.drawImage(Fb,0,0);aa("tile","div[className=bitmap]",{S:{backgroundImage:`url(${a.toDataURL()})`}});Db=new Ua(b.getImageData(0,0,16,416).data.buffer);Eb&&Eb();Fb=Eb=null};Fb.src=ASSETS+"blocks.webp";
const Hb=(a,b)=>{const d={Va:b,Ma:b.getContext("2d",{alpha:!1,desynchronized:!0}),Wa:null,bb:"",T:!1,cb:0,Pa:0,lb:Xa(()=>(d.cb=d.Pa,d.Pa=0),1E3),u:a};null===Db&&(Eb=()=>d.T=!0);Gb(d);return d},Gb=a=>{(a.Wa=a.Ma.createImageData(a.Va.width=a.u.Ha,a.Va.height=a.u.Ia)).data.fill(255);a.Ma.fillStyle="rgba(255,255,255,.5)"};
function Ib({g:a,la:b}){v("div[className=bar]",{ontouchstart:B(d=>{a.N=Number(d.target.closest("[data-slot]").dataset.slot);a.ka=d.timeStamp}),S:{opacity:M(.5,L(1,1-5E-4*(b-a.ka-5E3)))}});return Db&&a.H.slice(0,9).map(({content:d},c)=>F("div",{D:{slot:c},F:{active:c===a.N}},[d&&E(bb,{amount:d.amount,data:d.data,id:d.id})]))}
const Jb=(a,b,d=a.content.amount)=>{if(b.content)a.content.id===b.content.id?(d=L(d,b.P-b.content.amount),a.content.amount-=d,b.content.amount+=d,0>=a.content.amount&&(a.content=null)):!(a.content.amount<=d&&a.content.amount<=b.P&&b.content.amount<=a.P)||a.filter&&!a.filter(b.content.id)||b.filter&&!b.filter(a.content.id)||([b.content,a.content]=[a.content,b.content]);else if(!b.filter||b.filter(a.content.id))a.content.amount<=d&&a.content.amount<=b.P?[b.content,a.content]=[a.content,b.content]:(d=
L(d,b.P),a.content.amount-=d,b.content=S(a.content.id,d),0>=a.content.amount&&(a.content=null))},Kb=(a,b)=>{for(const d of a)if(d.content&&d.content.id===b.id){const c=L(b.amount,d.P-d.content.amount);d.content.amount+=c;if(0>=(b.amount-=c))return null}for(const d of a)if(!d.content&&(!d.filter||d.filter(b.id)))if(a=L(b.amount,d.P),a<=b.amount){if(d.content=S(b.id,a),0>=(b.amount-=a))return null}else return d.content=b,null;return b},Lb=a=>({Ka:0,Ua:0,La:0,O:0,ea:0,ya:0,fa:0,W:-1,ga:0,ma:null,na:null,
G:1,fb:20,H:Array(36).fill(null).map(()=>({content:null,filter:null,P:64})),Ga:0,name:"Gast",J:a.ta,K:a.ua,L:a.va,hb:0,ib:0,N:0,ka:0,aa:0,ba:0,ca:0}),Mb=(a,b,d)=>{a.O=(a.O+b+100*va)%(2*va);a.ea=M(-wa,L(wa,a.ea+d))};let Nb=0;
const Ob=()=>{const a={X:null,za:null,Y:null,Ba:null,oa:0,Da:0,Ea:0,Fa:0,id:0,ra:0,sa:0,M:0,ta:.5,ua:8.5,va:.5},b=Lb(a);Bb(a,b);return{actions:null,A:null,$a:0,ab:0,Ca:!1,ia:!0,o:!0,pa:!1,eb:null,Z:0,U:new Set,Qa:"",j:0,V:[],g:b,B:null,Ra:1,Sa:1,Ha:0,Ia:0,jb:null,time:0,Ta:0,l:a}},Pb=(a,b)=>{a.B=Hb(a,b);a.jb=Xa(()=>{a.o||(a.time=(a.time+1)%24E3,a.Ta=1/24E3*(a.time+6E3)%1,nb(a.l,a.g,!1))},50)},Qb=(a,b)=>a===b?0:.1-.2*a,Rb=a=>{a.g.Ka=Qb((a=a.U).has(-12)||a.has(65),a.has(-13)||a.has(68))},Sb=a=>{a.g.Ua=
Qb((a=a.U).has(-15)||a.has(16),a.has(-14)||a.has(32))},Tb=a=>{a.g.La=Qb((a=a.U).has(-11)||a.has(83),a.has(-10)||a.has(87))},Ub=a=>{a.g.hb=Qb(a.U.has(-18),a.U.has(-19))},Vb=a=>{a.g.ib=Qb(a.U.has(-17),a.U.has(-16))},V=(a,b,d)=>{const c=a.U;var e=a.g;if(d){if(c.has(b))return!1;c.add(b);var h=e.fa,k=e.W;d=e.ga;switch(b){case -18:case -19:Ub(a);break;case -17:case -16:Vb(a);break;case -1:2!==e.G&&0<=k&&(0===e.Ga?0===e.G&&(b=ib(a.l,h,k,d),2===b?b=3:1===b&&(b=4),6===b||8!==b&&13!==b&&null!==Kb(e.H,S(b,1)))||
(jb(a.l,h,k,d),e.W=-1):Wb(a,[h,k,d],!1));break;case -2:case 71:if(0<=k){const f=ib(a.l,h,k,d);d=e.H.slice(0,9);k=d.findIndex(g=>null!==g.content&&g.content.id===f);0<=k?e.N=k:1===e.G&&(d[e.N].content&&(d=d.findIndex(g=>null===g.content),0<=d&&(e.N=d)),e.H[e.N].content=S(f));e.ka=a.Z}break;case -3:if(2!==e.G&&0<=k)if(0===e.Ga){if(b=e.H[e.N],b.content){switch(e.ya){case 0:--h;break;case 1:++h;break;case 2:--k;break;case 3:++k;break;case 4:--d;break;default:++d}0<=k&&64>k&&kb(a.l,h&(1<<4+a.l.M)-1,k,
d&(1<<4+a.l.M)-1,b.content.id)&&1!==e.G&&0>=--b.content.amount&&(b.content=null)}}else Wb(a,[h,k,d],!0);break;case -4:e.N=(e.N+9-1)%9;e.ka=a.Z;break;case -5:e.N=(e.N+1)%9;e.ka=a.Z;break;case 27:a.j?(a.o=!1,a.j=0):(a.o=!0,a.j=1);break;case -15:case -14:case 16:case 32:Sb(a);break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:e.N=b-49;e.ka=a.Z;break;case -12:case -13:case 65:case 68:Rb(a);break;case 69:if(2!==e.G&&!a.j){a.j=3;for(const f of c)V(a,f,!1)}break;case 80:a.o=!a.o;
break;case 81:e=e.H[e.N];if(c.has(17)||e.content&&0>=--e.content.amount)e.content=null;break;case -11:case -10:case 83:case 87:Tb(a);break;case 84:if(!a.j){a.j=2;for(const f of c)V(a,f,!1)}break;case 112:a.ia=!a.ia;break;case 114:a.Ca=!a.Ca;break;default:return!1}}else{if(!c.delete(b))return!1;switch(b){case -15:case -14:case 16:case 32:Sb(a);break;case -12:case -13:case 65:case 68:Rb(a);break;case -11:case -10:case 83:case 87:Tb(a);break;case -18:case -19:Ub(a);break;case -17:case -16:Vb(a)}}a.Qa=
[...c].join();return!0},Xb=(a,b)=>(b=b.startsWith("~")?a+O(b.substr(1)):O(b),isNaN(b)?a:b),Z=(a,b,d=!1)=>{(a.V=a.V.slice(-49)).push({id:++Nb,gb:d,time:ja(),value:b})},Wb=(a,b,d)=>{d?a.g.na=b:a.g.ma=b;Z(a,`${d?"second":"first"} position: ${b.join(" ")}`,!0)};function Yb({nb:a}){v("div[className=grid]",{onclick:({target:b})=>{(b=b.closest("[data-id]"))&&Jb({content:S(O(b.dataset.id)),filter:null,P:64},a)}});return ka.map((b,d)=>0<d&&F("div",{D:{id:d}},[E(bb,{id:d,amount:1,data:null})]))}
function Zb({u:a}){const b=ea(()=>({content:null,filter:null,P:64}));v("div[className=menu inventory]",ea(()=>({onclick:({target:d})=>{if("menu inventory"===d.className)b.content?b.content=null:(a.j=0,a.o=!1,a.eb.requestPointerLock());else if(d=d.closest("[data-slot]"))d=a.g.H[O(d.dataset.slot)],b.content?Jb(b,d):d.content&&Jb(d,b)},oncontextmenu:({target:d})=>{if("menu inventory"===d.className)b.content?0>=--b.content.amount&&(b.content=null):(a.j=0,a.eb.requestPointerLock());else if(d=d.closest("[data-slot]"))d=
a.g.H[O(d.dataset.slot)],b.content?Jb(b,d,1):d.content&&Jb(d,b,Da(d.content.amount/2))}})));return Db&&[F("div[className=window]",null,[F("div[innerText=Inventory]"),1===a.g.G&&E(Yb,{nb:b}),F("div[className=grid]",null,a.g.H.map(({content:d},c)=>F("div",{D:{slot:c},F:{first:9>c}},[d&&E(bb,{id:d.id,amount:d.amount,data:d.data})])))]),b.content&&F("div[className=hand]",{S:{left:`${a.$a}px`,top:`${a.ab}px`}},[E(bb,{id:b.content.id,amount:b.content.amount,data:b.content.data})])]}
const $b=({I:{gb:a,time:b,value:d},la:c})=>(v(a?"div[className=minor]":"div",{innerText:d,S:{opacity:L(1,1-.001*(c-b-4500))}}),null);function ac({V:a,la:b}){v("div[className=messages]");const d=b-5E3;return[ia($b,a.slice(-10).filter(c=>c.time>d),{la:b})]}
function bc({actions:{kb:a,Na:b,Za:d},A:c,u:e}){A(()=>{pb(e.l,e.g);return b});A(()=>{const h=Wa(b,1E3);return()=>Ya(h)},[c]);v("div[className=menu]");return[F("h1[innerText=Men\u00fc]"),F("div[className=settings]",null,[F("button",{innerText:"Oberfl\u00e4chen: "+(c.ja?"Texturiert":"Einfarbig"),onclick:B(()=>a(h=>({ja:!h.ja})))}),F("label[innerText=Aufl\u00f6sung:]",null,[F("input[type=range][min=1][max=100][step=1]",{value:101-c.$,onchange:B(h=>d({$:101-Number(h.target.value)}))})]),F("label[innerText=Blickwinkel:]",
null,[F("input[type=range][min=1][max=180][step=1]",{value:c.wa,onchange:B(h=>d({wa:Number(h.target.value)}))})]),F("label[innerText=Sichtweite:]",null,[F("input[type=range][min=1][max=128][step=1]",{value:c.da,onchange:B(h=>d({da:Number(h.target.value)}))})]),F("label[innerText=Mausempfindlichkeit:]",null,[F("input[type=range][min=1][max=15][step=1]",{value:c.qa,onchange:B(h=>d({qa:Number(h.target.value)}))})])]),F("center",null,[F("button[innerText=Zur\u00fcck]",{onclick:B(()=>(e.j=0,e.o=!1,e.eb.requestPointerLock()))})])]}
const cc=({I:{gb:a,value:b}})=>(v(a?"div[className=minor]":"div",{innerText:b}),null);
function dc({u:a,V:b}){v("div[className=menu terminal]");const d=B({history:null});A(c=>{c&&Wa(()=>d.history.scrollTop=1E9,0)},[b.length&&b[b.length-1].id]);return[F("div[className=history]",{R:B(c=>{d.history=c})},[ia(cc,b)]),F("input[enterkeyhint=send][mozactionhint=send][name=message][required]",B({onkeydown:c=>{var e=c.keyCode;c=c.target;if(13===e){var h=c.value;e=a.g;if(h)if("/"===h.charAt(0)){h=h.substr(1).split(" ");const f=h.shift();switch(f){case "clear":a.V=[];break;case "clearinv":for(var k of e.H)k.content=
null;Z(a,"inventory cleared",!0);break;case "exit":a.o=!1;a.j=0;break;case "gamemode":case "gm":h=O(h[0]);!isNaN(h)&&0<=h&&3>h&&0===h%1?(e.G=h,Z(a,`gamemode set to ${h}`,!0)):Z(a,"gamemode must be in 0..2");break;case "give":if(0===h.length){Z(a,"/give <id> [amount]\n"+ka.join(" "));break}k=ka.indexOf((h[0]||"").toLowerCase());k=0<=k?k:O(h[0]);h=O(h[1]||1);!isNaN(k)&&0<k&&25>k&&0===k%1?!isNaN(h)&&0<h&&0===h%1?Z(a,Kb(e.H,S(k,h))?"inventory full":`gave ${h} ${ka[k]}`,!0):Z(a,"amount must be at least 1"):
Z(a,"invalid block type");break;case "help":Z(a,"commands: clear, clearinv, exit, gamemode, give, help, load, me, save, spawn, teleport, version");break;case "load":mb(a.l,!0);a.B.T=!0;Z(a,"chunks loaded",!0);break;case "me":Z(a,e.name+" "+h.join(" "),!0);break;case "save":pb(a.l,a.g);a.actions.Na();Z(a,"world+config saved",!0);break;case "smart":e.name="LFF5644";Z(a,"lff.smart: true",!0);break;case "spawn":a.l.ta=e.J;a.l.ua=e.K;a.l.va=e.L;Z(a,"spawn updated",!0);break;case "teleport":case "tp":0===
h.length?(e.J=a.l.ta,e.K=a.l.ua,e.L=a.l.va,a.B.T=!0,Z(a,"teleported to spawn",!0)):3===h.length?(Z(a,`teleported to ${e.J=Xb(e.J,h[0])} ${e.K=Xb(e.K,h[1])} ${e.L=Xb(e.L,h[2])}`,!0),a.B.T=!0):Z(a,"PITCH");e.aa=0;e.ba=0;e.ca=0;break;case "version":Z(a,"Minicraft 0.6.10");break;case "/exit":e.Ga=0;Z(a,"normal mouse mode",!0);break;case "/expand":a.g.ma&&a.g.na?k=!0:(Z(a,"selection required"),k=!1);k&&("vert"===h[0]?(e.ma[1]=0,e.na[1]=63,Z(a,"selection expanded",!0)):Z(a,"only vert supported"));break;
case "/pos1":case "/pos2":Wb(a,[K(e.J),K(e.K),K(e.L)],"/pos2"===f);break;case "/regen":e=a.l;h=e.Y[e.Ba[e.oa=0].Xa];N.removeItem(Cb(e,h.xa,h.Ja,h.y));h.ha=!1;++h.xa;mb(e,!1);Z(a,"regenerate chunk",!0);a.B.T=!0;break;case "/show":Z(a,`first: ${e.ma?e.ma.join(" "):"none"}, second: ${e.na?e.na.join(" "):"none"}`);break;case "/wand":e.Ga=1;Z(a,"primary+secondary button for selection",!0);break;default:Z(a,"unknown command: "+f)}}else Z(a,`<${e.name}> `+h);c.value=""}else 27===e&&(a.o=!1,a.j=0)},R:c=>
Wa(()=>c.focus(),0)}))]}const ec=[["pick",-2],["up",-14],["down",-15],["E",69],["T",84],["F3",114],["...",27]],fc=[["up",-10],["down",-11],["left",-12],["right",-13],["center",-1]],gc=[["up",-16],["down",-17],["left",-18],["right",-19],["center",-3]];
function hc({u:a}){const b=a.U,d=([c,e])=>F("div",{D:{code:e},F:{button:!0,[c]:!0,active:b.has(e)}});v("div[className=touch]",B({ontouchstart:c=>{c.preventDefault();const e=Number(c.target.dataset.code);if(null!=e&&V(a,e,!0)){const h=c.changedTouches[0].identifier,k=f=>{f.changedTouches[0].identifier===h&&(removeEventListener("touchend",k),V(a,e,!1))};addEventListener("touchend",k)}}}));return[F("div[className=top]",null,ec.map(([c,e])=>F(`div[innerText=${c}]`,{D:{code:e},F:{button:!0,active:b.has(e)}}))),
F("div[className=move]",null,fc.map(d)),F("div[className=move sec]",null,gc.map(d))]}
function ic({actions:a,A:b,mb:d}){const c=ea(Ob),e=ja(),h=v("div[className=game]",ea(()=>{const f=g=>0!==c.j||(c.pa=!1,ua.pointerLockElement===h?c.o||V(c,-1-g.button,"mousedown"===g.type):c.eb.requestPointerLock(),g.preventDefault(),!1);return{onmousedown:f,onmousemove:g=>{if(c.o||c.j)c.$a=g.clientX,c.ab=g.clientY;else{const l=c.A.qa*va/M(c.Ra,c.Sa);Mb(c.g,g.movementX*l,-g.movementY*l)}},onmouseup:f,ontouchstart:g=>{c.pa=!0;c.j||(c.o=!1,g.preventDefault())},onwheel:g=>{c.pa=!1;if(!c.j&&!c.o&&5<Math.abs(g.deltaY)){const l=
0<g.deltaY?-5:-4;V(c,l,!0);V(c,l,!1);g.preventDefault()}}}})),k=ua.pointerLockElement===h;A(()=>(c.actions=a,c.eb=h,d.u=c,()=>{Za(c.jb);Za(c.B.lb);return d.u=null}));A(()=>{c.A=b;c.B&&(c.B.T=!0);const f=c.g,g=c.l;var l=Da(Ia(c.A.da/16*2+2));if(g.M!==l){g.Y&&pb(g,f);const m=1<<(g.M=l),n=g.Y=[];for(let r=0;r<m;++r)for(let w=0;w<m;++w)for(let x=0;4>x;++x)n.push({ha:!1,loaded:!1,x:r,y:x,z:w,xa:0,Ja:0});l=m<<l+12+2;null===g.X||g.X.length<l?g.za=new Ua((g.X=new Ta(l)).buffer):g.za.fill(0);nb(g,f,!0)}},
[b]);A((f,g,l)=>{c.Ra=M(1,f*l);c.Sa=M(1,g*l);g=c.A.$;f=M(1,Ea(c.Ra/g));g=M(1,Ea(c.Sa/g));if(f!==c.Ha||g!==c.Ia)c.Ha=f,c.Ia=g,c.B&&(c.B.T=!0,Gb(c.B))},[h.offsetWidth,h.offsetHeight,ta.devicePixelRatio||1,b.$]);A(()=>{k||c.o||c.j||(c.j=1);c.o=!k},[k]);A(f=>k&&f&&ua.exitPointerLock(),[c.o||c.j]);A(()=>{if(c.Z&&!c.o){var f=c.g,g=L(5,.01*(e-c.Z));f.aa-=.1*f.aa*g;f.ba-=.1*f.ba*g;f.ca-=.1*f.ca*g;f.aa+=(Fa(f.O)*f.Ka+Ga(f.O)*f.La)*g;f.ba+=f.Ua*g;f.ca+=(-Ga(f.O)*f.Ka+Fa(f.O)*f.La)*g;Mb(f,f.hb*g,f.ib*g);f.J+=
f.aa*g;f.K+=f.ba*g;f.L+=f.ca*g}if(c.B){f=c.B;++f.Pa;g=f.Ma;var l=f.Wa;const G=f.u,la=G.A,Ma=G.ia,p=G.g,P=G.Ha,U=G.Ia,Q=G.l;if(!G.o||f.T){f.T=!1;const ba=l.data,kc=la.da;var m=p.O,n=p.ea;const lc=p.fa,mc=p.ga;var r=p.J,w=p.K,x=p.L;const nc=Ma?p.W:-1,oc=Q.X;var u=Q.M;const pc=la.ja&&null!==Db;var y=1/P,t=1/U;const ca=P>>1,da=U>>1,qb=L(P,U),rb=32<qb,sb=Fa(m);m=Ga(m);const tb=Fa(-n);n=Ga(-n);var C=la.wa/45;const qc=y*(P<U?C*P*t:C);y=t*(U<P?C*U*y:C);r+=65536;w+=65536;x+=65536;t=r%1;C=w%1;const rc=x%1;
u=4+u;const ub=(1<<u)-1;let vb=1===p.G?6:4,W=p.fa=p.ga=p.ya=0;p.W=-1;for(let ya=0;ya<U;++ya){var za=(da-ya)*y;const wb=za*tb-n;var Na=za*n+tb;za=Na*m;Na*=sb;for(let Aa=0;Aa<P;++Aa){var ma=(Aa-ca)*qc;const xb=za+sb*ma;ma=Na-m*ma;let na=16757124,Ba=1,yb=kc;for(let z=0;3>z;++z){let H=ma;0===z&&(H=xb);1===z&&(H=wb);var X=1/(0>H?-H:H);const Ca=xb*X,Y=wb*X;X*=ma;const zb=Ha(Ca*Ca+Y*Y+X*X);var D=rc;0===z&&(D=t);1===z&&(D=C);0<H&&(D=1-D);let oa=r+Ca*D-(0===z&0>H|0),pa=w+Y*D-(1===z&0>H|0),qa=x+X*D-(2===z&
0>H|0);D*=zb;for(let Oa,Pa,Qa,I;D<yb;oa+=Ca,pa+=Y,qa+=X,D+=zb)if(65536>pa){if(0>Y)break}else if(65600<=pa){if(0<Y)break}else if(0!==(I=oc[((Oa=oa&ub)<<u|(Qa=qa&ub))<<6|(Pa=pa&63)])){ya===da&&Aa===ca&&D<=vb&&(p.fa=Oa,p.W=Pa,p.ga=Qa,p.ya=0>H|z<<1,vb=D);if(pc){--I;1===z?6===I?I=25:13===I?I=4:1===I&&0<Y&&(I=2):1===I&&(I=24);const Ab=Db[I<<8|(16*(1===z?qa:pa)&15)<<4|16*(1===z?oa:(0<H?oa-qa:qa-oa)+65536)&15];if(0===Ab>>>24)continue;na=Ab&16777215}else na=ra[I];yb=D;Ba=(0===z?.8:2===z?.6:0<H?.4:1)+(Pa!==
nc||Oa!==lc||Qa!==mc?0:.2);break}}ba[W]=(na&255)*Ba;ba[++W]=(na>>8&255)*Ba;ba[++W]=(na>>16)*Ba;W+=2}}Ma&&!rb&&(ba[W=P*da+ca<<2]+=128,ba[++W]+=128,ba[++W]+=128);g.putImageData(l,0,0);Ma&&rb&&(l=Da(.05*qb),g.fillRect(ca-l,da-1,l<<1,2),g.fillRect(ca-1,da-l,2,l-1),g.fillRect(ca-1,da+1,2,l-1))}f.bb=G.Ca?"Minicraft 0.6.10 "+K(f.cb).toString().padStart(2,"\u00a0")+" fps, T: "+K(24*G.Ta).toString().padStart(2,"0")+":"+K(24*G.Ta%1*60).toString().padStart(2,"0")+"; "+(G.o&&500>e%1E3?"":G.time)+"\nR: "+P+"x"+
U+" (x"+la.$+"), D: "+la.da+", C: "+Q.oa+"/"+Q.Ba.length+", M: "+(64*R(1<<4+Q.M)>>10)+"k\nE: 0/0 M: "+p.G+"\n\nPosition: "+p.J.toFixed(2)+" "+p.K.toFixed(2)+" "+p.L.toFixed(2)+"\nAngle: "+(p.O*xa).toFixed(2)+" "+(p.ea*xa).toFixed(2)+"\nBlock: "+(0>p.W?0:p.fa+" "+p.W+" "+p.ga+" "+sa[p.ya]+": "+ib(Q,p.fa,p.W,p.ga))+"\nChunk abs: "+(K(p.J)>>4)+" "+(K(p.L)>>4)+" "+(K(p.K)>>4)+" rel: "+Q.Da+" "+Q.Fa+" "+Q.Ea:""}c.Z=e},[e]);ha();return[F("canvas",{R:B(f=>Pb(c,f))}),c.ia&&2!==c.j&&E(ac,{V:c.V,la:e}),c.B&&
c.Ca&&F("div[className=diagnostics]",{innerText:c.B.bb}),c.ia&&c.pa&&E(hc,{u:c,Qa:c.Qa}),c.ia&&3!==c.j&&2!==c.g.G&&E(Ib,{g:c.g,la:e}),3===c.j&&E(Zb,{u:c,la:e}),1===c.j&&E(bc,{actions:a,A:b,u:c}),2===c.j&&E(dc,{u:c,V:c.V})]}
const jc={init:()=>{const a={ja:!0,qa:3,$:4,wa:120,da:64};var b=N.getItem("minicraft.config");if(b){b=Ra(b);let d=b.flag_textures;null!=d&&(a.ja=d);null!=(d=b.mouse_sensitivity)&&(a.qa=d);a.$=b.resolution_scaling;a.wa=b.view_angle;a.da=b.view_distance}return{A:a,Ya:a}},Na:a=>{const b=a.A;if(b===a.Ya)return a;Sa("minicraft.config",La({version:"0.6.10",flag_textures:b.ja,mouse_sensitivity:b.qa,resolution_scaling:b.$,view_angle:b.wa,view_distance:b.da}));return Object.assign({},a,{Ya:b})},kb:(a,b)=>
jc.Za(a,b(a.A)),Za:(a,b)=>Object.assign({},a,{A:Object.assign({},a.A,b)})};q.init(()=>{const [a,b]=fa(jc),d=B({u:null});A(()=>{let e=!1;onbeforeunload=onunload=onpagehide=onblur=()=>{if(!e&&(e=!0,b.Na(),d.u)){var h=d.u;pb(h.l,h.g)}};onpageshow=onfocus=()=>{e=!1}});const c=B(e=>"INPUT"===e.target.tagName||!d.u||(e.preventDefault(),V(d.u,e.keyCode,"keydown"===e.type),d.u.pa=!1));return[{onkeydown:c,onkeyup:c,oncontextmenu:$a,ondragstart:$a},[E(ic,{actions:b,A:a.A,mb:d})]]});
