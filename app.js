const q=lui,aa=q.hook_assert,v=q.hook_dom,A=q.hook_effect,ea=q.hook_memo,fa=q.hook_model,ha=q.hook_rerender,D=q.hook_static,E=q.node,H=q.node_dom,ia=q.node_map,pa=q.now,qa="air stone grass dirt cobble planks bedrock log leaves bricks wool sand gravel glass bookshelf obsidian stone_bricks sandstone lapis_block iron_block gold_block diamond_block emerald_block redstone_block quartz_block".split(" "),ra=[0,8487297,4305266,4349313,8092539,5342114,7039851,3561583,4172910,6384533,15526888,10671324,8092798,
16447200,4151672,1970708,8092539,9686227,9126695,15198183,5567485,14541182,7920469,662956,14936813],sa=ra.length,ta="WEBTSN".split(""),ua=window,va=document,I=Math,wa=I.PI,Ca=.5*wa,Da=180/wa,K=I.floor,Ea=I.ceil,Fa=I.round,L=I.min,M=I.max,Ga=I.cos,Ha=I.sin,Ia=I.sqrt,Ja=String.fromCharCode,Oa=JSON,Pa=Oa.stringify,Qa=Oa.parse,N=localStorage,Ra=N.setItem.bind(N),Sa=Uint8Array,Ta=Uint32Array,Ua=Map,O=Number,Va=setTimeout,Wa=setInterval,Xa=clearTimeout,Ya=clearInterval,R=a=>a*a,Za=()=>!1,$a=a=>{a+=32;33<
a&&39>a?a++:38<a&&44>a?a+=2:43<a&&127>a?a+=3:126<a&&55258>a?a+=37:55295<a&&(a+=8485);return Ja(a)},ab=a=>a-(63743<a?8517:159<a?69:46<a&&130>a?35:40<a&&46>a?34:34<a&&40>a?33:32),cb=()=>{var a=bb;const b=a.length,d=new Ua,c=t=>{u=u<<1|t&1;15===++n&&(l+=$a(u),u=n=0)},e=()=>{for(let t=0;t<m;++t)c(0)},h=t=>{c(t);c(t>>1);c(t>>2);c(t>>3);c(t>>4);c(t>>5);c(t>>6);c(t>>7)},k=()=>{0===--w&&(w=1<<m++)},f=()=>{if(y)y=!1;else{let t=r.id;for(let B=0;B<m;B++)c(t>>B)}};let g=a[0],l="",u=0,n=2,m=2,w=2,x=2,r={id:x++,
za:new Ua},y=!0;h(g);d.set(g,r);for(let t=1;t<b;++t){const B=r.za.get(g=a[t]);B?r=B:(f(),d.has(g)||(k(),e(),h(g),d.set(g,{id:x++,za:new Ua}),y=!0),r.za.set(g,{id:x++,za:new Ua}),r=d.get(g),k())}f();d.has(g)||(k(),e(),h(g));k();c(1);--m;e();return l+=$a(u<<15-n)},db=a=>{var b=bb;if(!a)return null;const d=a.length,c=()=>{n+=(x>>--r&1)<<m++;0===r&&(r=15,x=ab(a.charCodeAt(w++)))};let e=[0,1],h=1,k=3,f=2,g=null;var l=null;let u=0,n=0;l=2;let m=0,w=0,x=ab(a.charCodeAt(w++)),r=15;for(;m<l;)c();if(1===n)return null;
for(n=m=0;8>m;)c();g=[n];e[2]=g;for(b[u++]=n;w<=d;){l=f;for(n=m=0;m<l;)c();if(0===n){for(n=m=0;8>m;)c();e[k]=[n];n=k++;0===--h&&(h=1<<f++)}else if(1===n)return b;l=n<e.length?e[n]:g.concat(g[0]);for(let y=0;y<l.length;y++)b[u++]=l[y];e[k++]=g.concat(l[0]);g=l;0===--h&&(h=1<<f++)}return null},eb=(a,b=1,d=null)=>({amount:b,data:d,id:a}),S=new Ta(1024),bb=new Sa(S.buffer),fb=new Ua,gb=(a,b,d,c)=>0>d||63<d?0:a.V[(b<<a.L+4|c)<<6|d],hb=(a,b,d,c,e)=>{const h=a.L;a.V[(b<<h+4|c)<<6|d]=e;a.X[(b>>4<<h|c>>4)<<
2|d>>4].Z=!0},ib=(a,b,d,c,e)=>{const h=a.L,k=(b<<h+4|c)<<6|d;if(0<a.V[k])return!1;a.V[k]=e;return a.X[(b>>4<<h|c>>4)<<2|d>>4].Z=!0},lb=(a,b,d)=>{const c=M(L(b.J,63),0)>>4,e=K(b.H)>>4;b=K(b.K)>>4;if(d||a.Da!==c||a.qa+a.Ca!==e||a.ra+a.Ea!==b)d=1<<a.L,a.Da=c,a.qa=e-(a.Ca=(65536+e)%d),a.ra=b-(a.Ea=(65536+b)%d),jb(a);kb(a)},jb=a=>{const b=a.Ca,d=a.Da,c=a.Ea,e=a.L,h=`${e} ${b} ${c} ${d}`;let k=fb.get(h);if(null==k){const f=1<<e,g=R(.5*f);fb.set(h,k=a.X.map(({x:l,y:u,z:n},m)=>{let w=R(l-b),x=R(n-c),r=R(l-
b-f),y=0,t=0;r<w&&(w=r,y=-f);(r=R(l-b+f))<w&&(w=r,y=f);(r=R(n-c-f))<x&&(x=r,t=-f);(r=R(n-c+f))<x&&(x=r,t=f);return{Na:w+x+R(u-d),Wa:m,qa:y,ra:t}}).filter(({Na:l})=>l<=g).sort((l,u)=>l.Na-u.Na))}a.Aa=k;a.na=0},nb=(a,b)=>{for(var d of a.X)d.Z&&mb(a,d);for(d=b.G.map(({content:c})=>c&&[c.id,c.amount,c.data]);0<d.length&&null===d[d.length-1];)d.pop();Ra(`minicraft.world.${a.id}:meta`,Pa({p:{h:b.eb,i:d,m:b.N,p:[b.H,b.J,b.K,b.O,b.fa]},s:[a.sa,a.ta,a.ua],v:1}))},ob=(a,b)=>{const d=N.getItem(`minicraft.world.${a.id}:meta`);
if(d){const {p:c,s:e,v:h}=Qa(d);null!=h&&(c.i.forEach((k,f)=>{k&&(b.G[f].content=eb(k[0],k[1],k[2]))}),b.eb=c.h,b.N=c.m,b.H=c.p[0],b.J=c.p[1],b.K=c.p[2],b.O=c.p[3],b.fa=c.p[4],a.sa=e[0],a.ta=e[1],a.ua=e[2])}},pb=(a,b,d,c)=>`minicraft.world.${a.id}:${b}/${d}`+(0<c?"/"+c:""),mb=(a,b)=>{const d=a.ya;var c=a.L;const e=b.y,h=(256<<c)-256;for(let k=0,f=-1,g=((b.x<<c+4|b.z)<<6|e)<<2;16>k;++k){for(c=0;16>c;++c)S[++f]=d[g],S[++f]=d[++g],S[++f]=d[++g],S[++f]=d[++g],g+=13;g+=h}Ra(pb(a,b.wa,b.Ia,e),cb());b.Z=
!1},kb=a=>{var b=a.X,d=a.Aa,c=a.qa;const e=a.ra,h=d.length;for(;a.na<h;){var k=d[a.na++];const m=b[k.Wa];var f=m.loaded,g=m.x,l=m.y,u=m.z;const w=c+k.qa+g;k=e+k.ra+u;if(!f||w!==m.wa||k!==m.Ia){m.Z&&mb(a,m);m.loaded=!0;var n=db(N.getItem(pb(a,m.wa=w,m.Ia=k,l)));if(f||0===l||n){b=a.ya;c=a.L;d=(256<<c)-256;g=((g<<c+4|u)<<6|l)<<2;if(n)for(let x=0,r=-1;16>x;++x){for(f=0;16>f;++f)b[g]=S[++r],b[++g]=S[++r],b[++g]=S[++r],b[++g]=S[++r],g+=13;g+=d}else for(u=0;16>u;++u){for(n=0;16>n;++n)b[g]=0<l?0:50397446,
b[++g]=0<l?0:131843,f?(b[++g]=0,b[++g]=0,g+=13):g+=15;g+=d}if(0===(w|k|l)){for(l=1;l<sa;++l)hb(a,l%9,7,K(l/9),l);m.Z=!1}break}}}};let U=null,qb=null,rb=new Image;rb.crossOrigin="anonymous";rb.onload=()=>{var a=va.createElement("canvas");a.width=256;a.height=26;a=a.getContext("2d");a.drawImage(rb,0,0);U=new Ta(a.getImageData(0,0,256,26).data.buffer);qb&&qb();rb=qb=null};rb.src=ASSETS+"blocks.png";
const Eb=(a,b)=>{const d={Ua:b,La:b.getContext("2d",{alpha:!1,desynchronized:!0}),Va:null,ab:"",Y:!1,bb:0,Oa:0,kb:Wa(()=>(d.bb=d.Oa,d.Oa=0),1E3),o:a};null===U&&(qb=()=>d.Y=!0);Db(d);return d},Db=a=>{(a.Va=a.La.createImageData(a.Ua.width=a.o.Ga,a.Ua.height=a.o.Ha)).data.fill(255);a.La.fillStyle="rgba(255,255,255,.5)"},Fb=Array(16).fill(0),Gb=({id:a})=>(v("div[className=bitmap]"),a=a-1<<8,Fb.map((b,d)=>(d=a|15-d<<4,H("div",null,Fb.map((c,e)=>(e=U[d|e],H("div",{style:0<e>>>24?`background-color:rgb(${e&
255},${e>>>8&255},${e>>>16&255})`:""})))))));function Hb({amount:a,id:b}){v("div[className=stack]");return[E(Gb,{id:b}),1!==a&&H("div[className=amount]",{innerText:a})]}function Ib({g:a,ka:b}){v("div[className=bar]",{ontouchstart:D(d=>{a.M=Number(d.target.closest("[data-slot]").dataset.slot);a.ja=d.timeStamp}),S:{opacity:M(.5,L(1,1-5E-4*(b-a.ja-5E3)))}});return U&&a.G.slice(0,9).map(({content:d},c)=>H("div",{D:{slot:c},F:{active:c===a.M}},[d&&E(Hb,{amount:d.amount,data:d.data,id:d.id})]))}
const Jb=(a,b,d=a.content.amount)=>{if(b.content)a.content.id===b.content.id?(d=L(d,b.W-b.content.amount),a.content.amount-=d,b.content.amount+=d,0>=a.content.amount&&(a.content=null)):!(a.content.amount<=d&&a.content.amount<=b.W&&b.content.amount<=a.W)||a.filter&&!a.filter(b.content.id)||b.filter&&!b.filter(a.content.id)||([b.content,a.content]=[a.content,b.content]);else if(!b.filter||b.filter(a.content.id))a.content.amount<=d&&a.content.amount<=b.W?[b.content,a.content]=[a.content,b.content]:(d=
L(d,b.W),a.content.amount-=d,b.content=eb(a.content.id,d),0>=a.content.amount&&(a.content=null))},Kb=(a,b)=>{for(const d of a)if(d.content&&d.content.id===b.id){const c=L(b.amount,d.W-d.content.amount);d.content.amount+=c;if(0>=(b.amount-=c))return null}for(const d of a)if(!d.content&&(!d.filter||d.filter(b.id)))if(a=L(b.amount,d.W),a<=b.amount){if(d.content=eb(b.id,a),0>=(b.amount-=a))return null}else return d.content=b,null;return b},Lb=a=>({Ja:0,Ta:0,Ka:0,O:0,fa:0,xa:0,ga:0,U:-1,ha:0,la:null,ma:null,
N:1,eb:20,G:Array(36).fill(null).map(()=>({content:null,filter:null,W:64})),Fa:0,name:"Gast",H:a.sa,J:a.ta,K:a.ua,gb:0,hb:0,M:0,ja:0,ba:0,ca:0,da:0}),Mb=(a,b,d)=>{a.O=(a.O+b+100*wa)%(2*wa);a.fa=M(-Ca,L(Ca,a.fa+d))};let Nb=0;
const Ob=()=>{const a={V:null,ya:null,X:null,Aa:null,na:0,Ca:0,Da:0,Ea:0,id:0,qa:0,ra:0,L:0,sa:.5,ta:8.5,ua:.5},b=Lb(a);ob(a,b);return{actions:null,A:null,Za:0,$a:0,Ba:!1,l:!0,oa:!1,cb:null,$:0,P:new Set,Pa:"",j:0,T:[],g:b,B:null,Qa:1,Ra:1,Ga:0,Ha:0,ib:null,time:0,Sa:0,u:a}},Pb=(a,b)=>{a.B=Eb(a,b);a.ib=Wa(()=>{a.l||(a.time=(a.time+1)%24E3,a.Sa=1/24E3*(a.time+6E3)%1,lb(a.u,a.g,!1))},50)},Qb=(a,b)=>a===b?0:.1-.2*a,Rb=a=>{a.g.Ja=Qb((a=a.P).has(-12)||a.has(65),a.has(-13)||a.has(68))},Sb=a=>{a.g.Ta=Qb((a=
a.P).has(-15)||a.has(16),a.has(-14)||a.has(32))},Tb=a=>{a.g.Ka=Qb((a=a.P).has(-11)||a.has(83),a.has(-10)||a.has(87))},Ub=a=>{a.g.gb=Qb(a.P.has(-18),a.P.has(-19))},Vb=a=>{a.g.hb=Qb(a.P.has(-17),a.P.has(-16))},V=(a,b,d)=>{const c=a.P;var e=a.g;if(d){if(c.has(b))return!1;c.add(b);var h=e.ga,k=e.U;d=e.ha;switch(b){case -18:case -19:Ub(a);break;case -17:case -16:Vb(a);break;case -1:2!==e.N&&0<=k&&(0===e.Fa?0===e.N&&(b=gb(a.u,h,k,d),2===b?b=3:1===b&&(b=4),6===b||8!==b&&13!==b&&null!==Kb(e.G,eb(b,1)))||
(hb(a.u,h,k,d,0),e.U=-1):Wb(a,[h,k,d],!1));break;case -2:case 71:if(0<=k){const f=gb(a.u,h,k,d);d=e.G.slice(0,9);k=d.findIndex(g=>null!==g.content&&g.content.id===f);0<=k?e.M=k:1===e.N&&(d[e.M].content&&(d=d.findIndex(g=>null===g.content),0<=d&&(e.M=d)),e.G[e.M].content=eb(f));e.ja=a.$}break;case -3:if(2!==e.N&&0<=k)if(0===e.Fa){if(b=e.G[e.M],b.content){switch(e.xa){case 0:--h;break;case 1:++h;break;case 2:--k;break;case 3:++k;break;case 4:--d;break;default:++d}0<=k&&64>k&&ib(a.u,h&(1<<4+a.u.L)-1,
k,d&(1<<4+a.u.L)-1,b.content.id)&&1!==e.N&&0>=--b.content.amount&&(b.content=null)}}else Wb(a,[h,k,d],!0);break;case -4:e.M=(e.M+9-1)%9;e.ja=a.$;break;case -5:e.M=(e.M+1)%9;e.ja=a.$;break;case 27:a.j?(a.l=!1,a.j=0):(a.l=!0,a.j=1);break;case -15:case -14:case 16:case 32:Sb(a);break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:e.M=b-49;e.ja=a.$;break;case -12:case -13:case 65:case 68:Rb(a);break;case 69:if(2!==e.N&&!a.j){a.j=3;for(const f of c)V(a,f,!1)}break;case 80:a.l=
!a.l;break;case 81:e=e.G[e.M];if(c.has(17)||e.content&&0>=--e.content.amount)e.content=null;break;case -11:case -10:case 83:case 87:Tb(a);break;case 84:if(!a.j){a.j=2;for(const f of c)V(a,f,!1)}break;case 114:a.Ba=!a.Ba;break;default:return!1}}else{if(!c.delete(b))return!1;switch(b){case -15:case -14:case 16:case 32:Sb(a);break;case -12:case -13:case 65:case 68:Rb(a);break;case -11:case -10:case 83:case 87:Tb(a);break;case -18:case -19:Ub(a);break;case -17:case -16:Vb(a)}}a.Pa=[...c].join();return!0},
Xb=(a,b)=>(b=b.startsWith("~")?a+O(b.substr(1)):O(b),isNaN(b)?a:b),Z=(a,b,d=!1)=>{(a.T=a.T.slice(-49)).push({id:++Nb,fb:d,time:pa(),value:b})},Wb=(a,b,d)=>{d?a.g.ma=b:a.g.la=b;Z(a,`${d?"second":"first"} position: ${b.join(" ")}`,!0)};
function Yb({o:a}){const b=ea(()=>({content:null,filter:null,W:64}));v("div[className=menu inventory]",ea(()=>({onclick:({target:d})=>{if("menu inventory"===d.className)b.content?b.content=null:(a.j=0,a.l=!1,a.cb.requestPointerLock());else if(d=d.closest("[data-slot]"))d=a.g.G[O(d.dataset.slot)],b.content?Jb(b,d):d.content&&Jb(d,b)},oncontextmenu:({target:d})=>{if("menu inventory"===d.className)b.content?0>=--b.content.amount&&(b.content=null):(a.j=0,a.cb.requestPointerLock());else if(d=d.closest("[data-slot]"))d=
a.g.G[O(d.dataset.slot)],b.content?Jb(b,d,1):d.content&&Jb(d,b,Ea(d.content.amount/2))}})));aa(U);return[H("div[className=window]",null,a.g.G.map(({content:d},c)=>H("div",{D:{slot:c},F:{first:9>c},title:d?qa[d.id]:""},[d&&E(Hb,{id:d.id,amount:d.amount,data:d.data})]))),b.content&&H("div[className=hand]",{S:{left:`${a.Za}px`,top:`${a.$a}px`}},[E(Hb,{id:b.content.id,amount:b.content.amount,data:b.content.data})])]}
const Zb=({I:{fb:a,time:b,value:d},ka:c})=>(v(a?"div[className=minor]":"div",{innerText:d,S:{opacity:L(1,1-.001*(c-b-4500))}}),null);function $b({T:a,ka:b}){v("div[className=messages]");const d=b-5E3;return[ia(Zb,a.slice(-10).filter(c=>c.time>d),{ka:b})]}
function ac({actions:{jb:a,Ma:b,Ya:d},A:c,o:e}){A(()=>{nb(e.u,e.g);return b});A(()=>{const h=Va(b,1E3);return()=>Xa(h)},[c]);v("div[className=menu]");return[H("h1[innerText=Men\u00fc]"),H("div[className=settings]",null,[H("button",{innerText:"Oberfl\u00e4chen: "+(c.ia?"Texturiert":"Einfarbig"),onclick:D(()=>a(h=>({ia:!h.ia})))}),H("label[innerText=Aufl\u00f6sung:]",null,[H("input[type=range][min=1][max=100][step=1]",{value:101-c.aa,onchange:D(h=>d({aa:101-Number(h.target.value)}))})]),H("label[innerText=Blickwinkel:]",
null,[H("input[type=range][min=1][max=180][step=1]",{value:c.va,onchange:D(h=>d({va:Number(h.target.value)}))})]),H("label[innerText=Sichtweite:]",null,[H("input[type=range][min=1][max=128][step=1]",{value:c.ea,onchange:D(h=>d({ea:Number(h.target.value)}))})]),H("label[innerText=Mausempfindlichkeit:]",null,[H("input[type=range][min=1][max=15][step=1]",{value:c.pa,onchange:D(h=>d({pa:Number(h.target.value)}))})])]),H("center",null,[H("button[innerText=Zur\u00fcck]",{onclick:D(()=>(e.j=0,e.l=!1,e.cb.requestPointerLock()))})])]}
const bc=({I:{fb:a,value:b}})=>(v(a?"div[className=minor]":"div",{innerText:b}),null);
function cc({o:a,T:b}){v("div[className=menu terminal]");const d=D({history:null});A(c=>{c&&Va(()=>d.history.scrollTop=1E9,0)},[b.length&&b[b.length-1].id]);return[H("div[className=history]",{R:D(c=>{d.history=c})},[ia(bc,b)]),H("input[enterkeyhint=send][mozactionhint=send][name=message][required]",D({onkeydown:c=>{var e=c.keyCode;c=c.target;if(13===e){var h=c.value;e=a.g;if(h)if("/"===h.charAt(0)){h=h.substr(1).split(" ");const f=h.shift();switch(f){case "clear":a.T=[];break;case "clearinv":for(var k of e.G)k.content=
null;Z(a,"inventory cleared",!0);break;case "exit":a.l=!1;a.j=0;break;case "gamemode":case "gm":h=O(h[0]);!isNaN(h)&&0<=h&&3>h&&0===h%1?(e.N=h,Z(a,`gamemode set to ${h}`,!0)):Z(a,"gamemode must be in 0..2");break;case "give":if(0===h.length){Z(a,"/give <id> [amount]\n"+qa.join(" "));break}k=qa.indexOf((h[0]||"").toLowerCase());k=0<=k?k:O(h[0]);h=O(h[1]||1);!isNaN(k)&&0<k&&25>k&&0===k%1?!isNaN(h)&&0<h&&0===h%1?Z(a,Kb(e.G,eb(k,h))?"inventory full":`gave ${h} ${qa[k]}`,!0):Z(a,"amount must be at least 1"):
Z(a,"invalid block type");break;case "help":Z(a,"commands: clear, clearinv, exit, gamemode, give, help, me, save, spawn, teleport, version");break;case "me":Z(a,e.name+" "+h.join(" "),!0);break;case "save":nb(a.u,a.g);a.actions.Ma();Z(a,"world+config saved",!0);break;case "smart":e.name="LFF5644";Z(a,"lff.smart: true",!0);break;case "spawn":a.u.sa=e.H;a.u.ta=e.J;a.u.ua=e.K;Z(a,"spawn updated",!0);break;case "teleport":case "tp":0===h.length?(e.H=a.u.sa,e.J=a.u.ta,e.K=a.u.ua,a.B.Y=!0,Z(a,"teleported to spawn",
!0)):3===h.length?(Z(a,`teleported to ${e.H=Xb(e.H,h[0])} ${e.J=Xb(e.J,h[1])} ${e.K=Xb(e.K,h[2])}`,!0),a.B.Y=!0):Z(a,"PITCH");e.ba=0;e.ca=0;e.da=0;break;case "version":Z(a,"Minicraft 0.6.1");break;case "/exit":e.Fa=0;Z(a,"normal mouse mode",!0);break;case "/expand":a.g.la&&a.g.ma?k=!0:(Z(a,"selection required"),k=!1);k&&("vert"===h[0]?(e.la[1]=0,e.ma[1]=63,Z(a,"selection expanded",!0)):Z(a,"only vert supported"));break;case "/pos1":case "/pos2":Wb(a,[K(e.H),K(e.J),K(e.K)],"/pos2"===f);break;case "/regen":e=
a.u;h=e.X[e.Aa[e.na=0].Wa];N.removeItem(pb(e,h.wa,h.Ia,h.y));h.Z=!1;++h.wa;kb(e);Z(a,"regenerate chunk",!0);a.B.Y=!0;break;case "/show":Z(a,`first: ${e.la?e.la.join(" "):"none"}, second: ${e.ma?e.ma.join(" "):"none"}`);break;case "/wand":e.Fa=1;Z(a,"primary+secondary button for selection",!0);break;default:Z(a,"unknown command: "+f)}}else Z(a,`<${e.name}> `+h);c.value=""}else 27===e&&(a.l=!1,a.j=0)},R:c=>Va(()=>c.focus(),0)}))]}
const dc=[["pick",-2],["up",-14],["down",-15],["E",69],["T",84],["F3",114],["...",27]],ec=[["up",-10],["down",-11],["left",-12],["right",-13],["center",-1]],fc=[["up",-16],["down",-17],["left",-18],["right",-19],["center",-3]];
function gc({o:a}){const b=a.P,d=([c,e])=>H("div",{D:{code:e},F:{button:!0,[c]:!0,active:b.has(e)}});v("div[className=touch]",D({ontouchstart:c=>{c.preventDefault();const e=Number(c.target.dataset.code);if(null!=e&&V(a,e,!0)){const h=c.changedTouches[0].identifier,k=f=>{f.changedTouches[0].identifier===h&&(removeEventListener("touchend",k),V(a,e,!1))};addEventListener("touchend",k)}}}));return[H("div[className=top]",null,dc.map(([c,e])=>H(`div[innerText=${c}]`,{D:{code:e},F:{button:!0,active:b.has(e)}}))),
H("div[className=move]",null,ec.map(d)),H("div[className=move sec]",null,fc.map(d))]}
function hc({actions:a,A:b,lb:d}){const c=ea(Ob),e=pa(),h=v("div[className=game]",ea(()=>{const f=g=>0!==c.j||(c.oa=!1,va.pointerLockElement===h?c.l||V(c,-1-g.button,"mousedown"===g.type):c.cb.requestPointerLock(),g.preventDefault(),!1);return{onmousedown:f,onmousemove:g=>{if(c.l||c.j)c.Za=g.clientX,c.$a=g.clientY;else{const l=c.A.pa*wa/M(c.Qa,c.Ra);Mb(c.g,g.movementX*l,-g.movementY*l)}},onmouseup:f,ontouchstart:g=>{c.oa=!0;c.j||(c.l=!1,g.preventDefault())},onwheel:g=>{c.oa=!1;if(!c.j&&!c.l&&5<Math.abs(g.deltaY)){const l=
0<g.deltaY?-5:-4;V(c,l,!0);V(c,l,!1);g.preventDefault()}}}})),k=va.pointerLockElement===h;A(()=>(c.actions=a,c.cb=h,d.o=c,()=>{Ya(c.ib);Ya(c.B.kb);return d.o=null}));A(()=>{c.A=b;c.B&&(c.B.Y=!0);const f=c.g,g=c.u;var l=c.A.ea;l=17>l?2:49>l?3:113>l?4:241>l?5:497>l?6:1009>l?7:2033>l?8:4081>l?9:8177>l?10:16369>l?11:32753>l?12:13;if(g.L!==l){g.X&&nb(g,f);const u=1<<(g.L=l),n=g.X=[];for(let m=0;m<u;++m)for(let w=0;w<u;++w)for(let x=0;4>x;++x)n.push({Z:!1,loaded:!1,x:m,y:x,z:w,wa:0,Ia:0});l=u<<l+12+2;null===
g.V||g.V.length<l?g.ya=new Ta((g.V=new Sa(l)).buffer):g.ya.fill(0);lb(g,f,!0)}},[b]);A((f,g,l)=>{c.Qa=M(1,f*l);c.Ra=M(1,g*l);g=c.A.aa;f=M(1,Fa(c.Qa/g));g=M(1,Fa(c.Ra/g));if(f!==c.Ga||g!==c.Ha)c.Ga=f,c.Ha=g,c.B&&(c.B.Y=!0,Db(c.B))},[h.offsetWidth,h.offsetHeight,ua.devicePixelRatio||1,b.aa]);A(()=>{k||c.l||c.j||(c.j=1);c.l=!k},[k]);A(f=>k&&f&&va.exitPointerLock(),[c.l||c.j]);A(()=>{if(c.$&&!c.l){var f=c.g,g=L(5,.01*(e-c.$));f.ba-=.1*f.ba*g;f.ca-=.1*f.ca*g;f.da-=.1*f.da*g;f.ba+=(Ga(f.O)*f.Ja+Ha(f.O)*
f.Ka)*g;f.ca+=f.Ta*g;f.da+=(-Ha(f.O)*f.Ja+Ga(f.O)*f.Ka)*g;Mb(f,f.gb*g,f.hb*g);f.H+=f.ba*g;f.J+=f.ca*g;f.K+=f.da*g}if(c.B){f=c.B;++f.Oa;g=f.La;var l=f.Va;const J=f.o,ja=J.A,p=J.g,P=J.Ga,T=J.Ha,Q=J.u;if(!J.l||f.Y){f.Y=!1;const ba=l.data,jc=ja.ea;var u=p.O,n=p.fa;const kc=p.ga,lc=p.U,mc=p.ha;var m=p.H,w=p.J,x=p.K;const nc=Q.V;var r=Q.L;const oc=ja.ia&&null!==U;var y=1/P,t=1/T;const ca=P>>1,da=T>>1,sb=L(P,T),tb=32<sb,ub=Ga(u);u=Ha(u);const vb=Ga(-n);n=Ha(-n);var B=ja.va/45;const pc=y*(P<T?B*P*t:B);y=
t*(T<P?B*T*y:B);m+=65536;w+=65536;x+=65536;t=m%1;B=w%1;const qc=x%1;r=4+r;const wb=(1<<r)-1;let xb=1===p.N?6:4,W=p.ga=p.ha=p.xa=0;p.U=-1;for(let xa=0;xa<T;++xa){var ya=(da-xa)*y;const yb=ya*vb-n;var Ka=ya*n+vb;ya=Ka*u;Ka*=ub;for(let za=0;za<P;++za){var ka=(za-ca)*pc;const zb=ya+ub*ka;ka=Ka-u*ka;let la=16757124,Aa=1,Ab=jc;for(let z=0;3>z;++z){let F=ka;0===z&&(F=zb);1===z&&(F=yb);var X=1/(0>F?-F:F);const Ba=zb*X,Y=yb*X;X*=ka;const Bb=Ia(Ba*Ba+Y*Y+X*X);var C=qc;0===z&&(C=t);1===z&&(C=B);0<F&&(C=1-C);
let ma=m+Ba*C-(0===z&0>F|0),na=w+Y*C-(1===z&0>F|0),oa=x+X*C-(2===z&0>F|0);C*=Bb;for(let La,Ma,Na,G;C<Ab;ma+=Ba,na+=Y,oa+=X,C+=Bb)if(65536>na){if(0>Y)break}else if(65600<=na){if(0<Y)break}else if(0!==(G=nc[((La=ma&wb)<<r|(Na=oa&wb))<<6|(Ma=na&63)])){xa===da&&za===ca&&C<=xb&&(p.ga=La,p.U=Ma,p.ha=Na,p.xa=0>F|z<<1,xb=C);if(oc){--G;1===z?6===G?G=25:13===G?G=4:1===G&&0<Y&&(G=2):1===G&&(G=24);const Cb=U[G<<8|(16*(1===z?oa:na)&15)<<4|16*(1===z?ma:(0<F?ma-oa:oa-ma)+65536)&15];if(0===Cb>>>24)continue;la=Cb&
16777215}else la=ra[G];Ab=C;Aa=(0===z?.8:2===z?.6:0<F?.4:1)+(Ma!==lc||La!==kc||Na!==mc?0:.2);break}}ba[W]=(la&255)*Aa;ba[++W]=(la>>8&255)*Aa;ba[++W]=(la>>16)*Aa;W+=2}}tb||(ba[W=P*da+ca<<2]+=128,ba[++W]+=128,ba[++W]+=128);g.putImageData(l,0,0);tb&&(l=Ea(.05*sb),g.fillRect(ca-l,da-1,l<<1,2),g.fillRect(ca-1,da-l,2,l-1),g.fillRect(ca-1,da+1,2,l-1))}f.ab=J.Ba?"Minicraft 0.6.1 "+K(f.bb).toString().padStart(2,"\u00a0")+" fps, T: "+K(24*J.Sa).toString().padStart(2,"0")+":"+K(24*J.Sa%1*60).toString().padStart(2,
"0")+"; "+(J.l&&500>e%1E3?"":J.time)+"\nR: "+P+"x"+T+" (x"+ja.aa+"), D: "+ja.ea+", C: "+Q.na+"/"+Q.Aa.length+", M: "+(64*R(1<<4+Q.L)>>10)+"k\nE: 0/0 M: "+p.N+"\n\nPosition: "+p.H.toFixed(2)+" "+p.J.toFixed(2)+" "+p.K.toFixed(2)+"\nAngle: "+(p.O*Da).toFixed(2)+" "+(p.fa*Da).toFixed(2)+"\nBlock: "+(0>p.U?0:p.ga+" "+p.U+" "+p.ha+" "+ta[p.xa]+": "+gb(Q,p.ga,p.U,p.ha))+"\nChunk abs: "+(K(p.H)>>4)+" "+(K(p.K)>>4)+" "+(K(p.J)>>4)+" rel: "+Q.Ca+" "+Q.Ea+" "+Q.Da:""}c.$=e},[e]);ha();return[H("canvas",{R:D(f=>
Pb(c,f))}),2!==c.j&&E($b,{T:c.T,ka:e}),c.B&&c.Ba&&H("div[className=diagnostics]",{innerText:c.B.ab}),c.oa&&E(gc,{o:c,Pa:c.Pa}),3!==c.j&&2!==c.g.N&&E(Ib,{g:c.g,ka:e}),3===c.j&&E(Yb,{o:c,ka:e}),1===c.j&&E(ac,{actions:a,A:b,o:c}),2===c.j&&E(cc,{o:c,T:c.T})]}
const ic={init:()=>{const a={ia:!0,pa:3,aa:10,va:80,ea:64};var b=N.getItem("minicraft.config");if(b){b=Qa(b);let d=b.flag_textures;null!=d&&(a.ia=d);null!=(d=b.mouse_sensitivity)&&(a.pa=d);a.aa=b.resolution_scaling;a.va=b.view_angle;a.ea=b.view_distance}return{A:a,Xa:a}},Ma:a=>{const b=a.A;if(b===a.Xa)return a;Ra("minicraft.config",Pa({version:"0.6.1",flag_textures:b.ia,mouse_sensitivity:b.pa,resolution_scaling:b.aa,view_angle:b.va,view_distance:b.ea}));return Object.assign({},a,{Xa:b})},jb:(a,b)=>
ic.Ya(a,b(a.A)),Ya:(a,b)=>Object.assign({},a,{A:Object.assign({},a.A,b)})};q.init(()=>{const [a,b]=fa(ic),d=D({o:null});A(()=>{let e=!1;onbeforeunload=onunload=()=>{if(!e&&(e=!0,b.Ma(),d.o)){var h=d.o;nb(h.u,h.g)}}});const c=D(e=>"INPUT"===e.target.tagName||!d.o||(e.preventDefault(),V(d.o,e.keyCode,"keydown"===e.type),d.o.oa=!1));return[{onkeydown:c,onkeyup:c,oncontextmenu:Za,ondragstart:Za},[E(hc,{actions:b,A:a.A,lb:d})]]});
