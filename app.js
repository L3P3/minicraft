const p=lui,u=p.hook_dom,A=p.hook_effect,da=p.hook_memo,ea=p.hook_model,fa=p.hook_rerender,B=p.hook_static,E=p.node,H=p.node_dom,ha=p.node_map,ia=p.now,ja=ASSETS+"blocks.webp",qa="air stone grass dirt cobble planks bedrock log leaves bricks wool sand gravel glass bookshelf obsidian stone_bricks sandstone lapis_block iron_block gold_block diamond_block emerald_block redstone_block quartz_block".split(" "),ra=[0,8487297,4305266,4349313,8092539,5342114,7039851,3561583,4172910,6384533,15526888,10671324,
8092798,16447200,4151672,1970708,8092539,9686227,9126695,15198183,5567485,14541182,7920469,662956,14936813],sa="WEBTSN".split(""),ta=window,ua=document,I=Math,va=I.PI,wa=.5*va,xa=180/va,K=I.floor,Da=I.ceil,Ea=I.round,L=I.min,M=I.max,Fa=I.cos,Ga=I.sin,Ha=I.sqrt,Ia=String.fromCharCode,Ja=JSON,Oa=Ja.stringify,Pa=Ja.parse,N=localStorage,Qa=N.setItem.bind(N),Ra=Uint8Array,Sa=Uint32Array,Ta=Map,O=Number,Ua=setTimeout,Va=setInterval,Wa=clearTimeout,Xa=clearInterval,R=a=>a*a,Ya=()=>!1,Za=({id:a})=>(u(`div[className=bitmap][style=background-image:url(${ja})]`,
{S:{backgroundPositionY:`-${2*(a-1)}rem`}}),null);function $a({amount:a,id:b}){u("div[className=stack]",{title:qa[b]});return[E(Za,{id:b}),1!==a&&H("div[className=amount]",{innerText:a})]}
function ab({g:a,ka:b}){u("div[className=bar]",{ontouchstart:B(d=>{a.N=Number(d.target.closest("[data-slot]").dataset.slot);a.ja=d.timeStamp}),S:{opacity:M(.5,L(1,1-5E-4*(b-a.ja-5E3)))}});return a.H.slice(0,9).map(({content:d},c)=>H("div",{D:{slot:c},F:{active:c===a.N}},[d&&E($a,{amount:d.amount,data:d.data,id:d.id})]))}
const S=(a,b=1,d=null)=>({amount:b,data:d,id:a}),bb=(a,b,d=a.content.amount)=>{if(b.content)a.content.id===b.content.id?(d=L(d,b.P-b.content.amount),a.content.amount-=d,b.content.amount+=d,0>=a.content.amount&&(a.content=null)):!(a.content.amount<=d&&a.content.amount<=b.P&&b.content.amount<=a.P)||a.filter&&!a.filter(b.content.id)||b.filter&&!b.filter(a.content.id)||([b.content,a.content]=[a.content,b.content]);else if(!b.filter||b.filter(a.content.id))a.content.amount<=d&&a.content.amount<=b.P?[b.content,
a.content]=[a.content,b.content]:(d=L(d,b.P),a.content.amount-=d,b.content=S(a.content.id,d),0>=a.content.amount&&(a.content=null))},cb=(a,b)=>{for(const d of a)if(d.content&&d.content.id===b.id){const c=L(b.amount,d.P-d.content.amount);d.content.amount+=c;if(0>=(b.amount-=c))return null}for(const d of a)if(!d.content&&(!d.filter||d.filter(b.id)))if(a=L(b.amount,d.P),a<=b.amount){if(d.content=S(b.id,a),0>=(b.amount-=a))return null}else return d.content=b,null;return b},db=a=>({Ja:0,Ta:0,Ka:0,O:0,
ea:0,xa:0,fa:0,V:-1,ga:0,la:null,ma:null,G:1,eb:20,H:Array(36).fill(null).map(()=>({content:null,filter:null,P:64})),Fa:0,name:"Gast",J:a.sa,K:a.ta,L:a.ua,gb:0,hb:0,N:0,ja:0,aa:0,ba:0,ca:0}),eb=(a,b,d)=>{a.O=(a.O+b+100*va)%(2*va);a.ea=M(-wa,L(wa,a.ea+d))},fb=a=>{a+=32;33<a&&39>a?a++:38<a&&44>a?a+=2:43<a&&127>a?a+=3:126<a&&55258>a?a+=37:55295<a&&(a+=8485);return Ia(a)},gb=a=>a-(63743<a?8517:159<a?69:46<a&&130>a?35:40<a&&46>a?34:34<a&&40>a?33:32),ib=()=>{var a=hb;const b=a.length,d=new Ta,c=q=>{r=r<<
1|q&1;15===++m&&(k+=fb(r),r=m=0)},e=()=>{for(let q=0;q<t;++q)c(0)},g=q=>{c(q);c(q>>1);c(q>>2);c(q>>3);c(q>>4);c(q>>5);c(q>>6);c(q>>7)},l=()=>{0===--x&&(x=1<<t++)},f=()=>{if(y)y=!1;else{let q=w.id;for(let C=0;C<t;C++)c(q>>C)}};let h=a[0],k="",r=0,m=2,t=2,x=2,v=2,w={id:v++,za:new Ta},y=!0;g(h);d.set(h,w);for(let q=1;q<b;++q){const C=w.za.get(h=a[q]);C?w=C:(f(),d.has(h)||(l(),e(),g(h),d.set(h,{id:v++,za:new Ta}),y=!0),w.za.set(h,{id:v++,za:new Ta}),w=d.get(h),l())}f();d.has(h)||(l(),e(),g(h));l();c(1);
--t;e();return k+=fb(r<<15-m)},jb=a=>{var b=hb;if(!a)return null;const d=a.length,c=()=>{m+=(v>>--w&1)<<t++;0===w&&(w=15,v=gb(a.charCodeAt(x++)))};let e=[0,1],g=1,l=3,f=2,h=null;var k=null;let r=0,m=0;k=2;let t=0,x=0,v=gb(a.charCodeAt(x++)),w=15;for(;t<k;)c();if(1===m)return null;for(m=t=0;8>t;)c();h=[m];e[2]=h;for(b[r++]=m;x<=d;){k=f;for(m=t=0;t<k;)c();if(0===m){for(m=t=0;8>t;)c();e[l]=[m];m=l++;0===--g&&(g=1<<f++)}else if(1===m)return b;k=m<e.length?e[m]:h.concat(h[0]);for(let y=0;y<k.length;y++)b[r++]=
k[y];e[l++]=h.concat(k[0]);h=k;0===--g&&(g=1<<f++)}return null},T=new Sa(1024),hb=new Ra(T.buffer),kb=new Ta,lb=(a,b,d,c)=>0>d||63<d?0:a.W[(b<<a.M+4|c)<<6|d],mb=(a,b,d,c)=>{const e=a.M;a.W[(b<<e+4|c)<<6|d]=0;a.X[(b>>4<<e|c>>4)<<2|d>>4].ha=!0},nb=(a,b,d,c,e)=>{const g=a.M,l=(b<<g+4|c)<<6|d;if(0<a.W[l])return!1;a.W[l]=e;return a.X[(b>>4<<g|c>>4)<<2|d>>4].ha=!0},Bb=(a,b,d)=>{const c=M(L(b.K,63),0)>>4,e=K(b.J)>>4;b=K(b.L)>>4;if(d||a.Da!==c||a.qa+a.Ca!==e||a.ra+a.Ea!==b)d=1<<a.M,a.Da=c,a.qa=e-(a.Ca=(65536+
e)%d),a.ra=b-(a.Ea=(65536+b)%d),ob(a);pb(a)},ob=a=>{const b=a.Ca,d=a.Da,c=a.Ea,e=a.M,g=`${e} ${b} ${c} ${d}`;let l=kb.get(g);if(null==l){const f=1<<e,h=R(.5*f);kb.set(g,l=a.X.map(({x:k,y:r,z:m},t)=>{let x=R(k-b),v=R(m-c),w=R(k-b-f),y=0,q=0;w<x&&(x=w,y=-f);(w=R(k-b+f))<x&&(x=w,y=f);(w=R(m-c-f))<v&&(v=w,q=-f);(w=R(m-c+f))<v&&(v=w,q=f);return{Na:x+v+R(r-d),Wa:t,qa:y,ra:q}}).filter(({Na:k})=>k<=h).sort((k,r)=>k.Na-r.Na))}a.Aa=l;a.na=0},Db=(a,b)=>{for(var d of a.X)d.ha&&Cb(a,d);for(d=b.H.map(({content:c})=>
c&&[c.id,c.amount,c.data]);0<d.length&&null===d[d.length-1];)d.pop();Qa(`minicraft.world.${a.id}:meta`,Oa({p:{h:b.eb,i:d,m:b.G,p:[b.J,b.K,b.L,b.O,b.ea]},s:[a.sa,a.ta,a.ua],v:1}))},Eb=(a,b)=>{const d=N.getItem(`minicraft.world.${a.id}:meta`);if(d){const {p:c,s:e,v:g}=Pa(d);null!=g&&(c.i.forEach((l,f)=>{l&&(b.H[f].content=S(l[0],l[1],l[2]))}),b.eb=c.h,b.G=c.m,b.J=c.p[0],b.K=c.p[1],b.L=c.p[2],b.O=c.p[3],b.ea=c.p[4],a.sa=e[0],a.ta=e[1],a.ua=e[2])}},Fb=(a,b,d,c)=>`minicraft.world.${a.id}:${b}/${d}`+(0<
c?"/"+c:""),Cb=(a,b)=>{const d=a.ya;var c=a.M;const e=b.y,g=(256<<c)-256;for(let l=0,f=-1,h=((b.x<<c+4|b.z)<<6|e)<<2;16>l;++l){for(c=0;16>c;++c)T[++f]=d[h],T[++f]=d[++h],T[++f]=d[++h],T[++f]=d[++h],h+=13;h+=g}Qa(Fb(a,b.wa,b.Ia,e),ib());b.ha=!1},pb=a=>{var b=a.X,d=a.Aa;const c=a.qa,e=a.ra,g=d.length;for(;a.na<g;){var l=d[a.na++],f=b[l.Wa],h=f.loaded,k=f.x;const m=f.y;var r=f.z;const t=c+l.qa+k;l=e+l.ra+r;if(!h||t!==f.wa||l!==f.Ia)if(f.ha&&Cb(a,f),f.loaded=!0,f=jb(N.getItem(Fb(a,f.wa=t,f.Ia=l,m))),
h||0===m||f){b=a.ya;d=a.M;a=(256<<d)-256;k=((k<<d+4|r)<<6|m)<<2;if(f)for(let x=0,v=-1;16>x;++x){for(h=0;16>h;++h)b[k]=T[++v],b[++k]=T[++v],b[++k]=T[++v],b[++k]=T[++v],k+=13;k+=a}else for(r=0;16>r;++r){for(d=0;16>d;++d)b[k]=0<m?0:50397446,b[++k]=0<m?0:131843,h?(b[++k]=0,b[++k]=0,k+=13):k+=15;k+=a}break}}};let Gb=null,Hb=null,Ib=new Image;Ib.crossOrigin="anonymous";
Ib.onload=()=>{var a=ua.createElement("canvas");a.width=16;a.height=416;a=a.getContext("2d");a.drawImage(Ib,0,0);Gb=new Sa(a.getImageData(0,0,16,416).data.buffer);Hb&&Hb();Ib=Hb=null};Ib.src=ja;const Kb=(a,b)=>{const d={Ua:b,La:b.getContext("2d",{alpha:!1,desynchronized:!0}),Va:null,ab:"",Y:!1,bb:0,Oa:0,kb:Va(()=>(d.bb=d.Oa,d.Oa=0),1E3),o:a};null===Gb&&(Hb=()=>d.Y=!0);Jb(d);return d},Jb=a=>{(a.Va=a.La.createImageData(a.Ua.width=a.o.Ga,a.Ua.height=a.o.Ha)).data.fill(255);a.La.fillStyle="rgba(255,255,255,.5)"};
let Lb=0;
const Mb=()=>{const a={W:null,ya:null,X:null,Aa:null,na:0,Ca:0,Da:0,Ea:0,id:0,qa:0,ra:0,M:0,sa:.5,ta:8.5,ua:.5},b=db(a);Eb(a,b);return{actions:null,A:null,Za:0,$a:0,Ba:!1,l:!0,oa:!1,cb:null,Z:0,T:new Set,Pa:"",j:0,U:[],g:b,B:null,Qa:1,Ra:1,Ga:0,Ha:0,ib:null,time:0,Sa:0,u:a}},Nb=(a,b)=>{a.B=Kb(a,b);a.ib=Va(()=>{a.l||(a.time=(a.time+1)%24E3,a.Sa=1/24E3*(a.time+6E3)%1,Bb(a.u,a.g,!1))},50)},Ob=(a,b)=>a===b?0:.1-.2*a,Pb=a=>{a.g.Ja=Ob((a=a.T).has(-12)||a.has(65),a.has(-13)||a.has(68))},Qb=a=>{a.g.Ta=Ob((a=
a.T).has(-15)||a.has(16),a.has(-14)||a.has(32))},Rb=a=>{a.g.Ka=Ob((a=a.T).has(-11)||a.has(83),a.has(-10)||a.has(87))},Sb=a=>{a.g.gb=Ob(a.T.has(-18),a.T.has(-19))},Tb=a=>{a.g.hb=Ob(a.T.has(-17),a.T.has(-16))},V=(a,b,d)=>{const c=a.T;var e=a.g;if(d){if(c.has(b))return!1;c.add(b);var g=e.fa,l=e.V;d=e.ga;switch(b){case -18:case -19:Sb(a);break;case -17:case -16:Tb(a);break;case -1:2!==e.G&&0<=l&&(0===e.Fa?0===e.G&&(b=lb(a.u,g,l,d),2===b?b=3:1===b&&(b=4),6===b||8!==b&&13!==b&&null!==cb(e.H,S(b,1)))||(mb(a.u,
g,l,d),e.V=-1):Ub(a,[g,l,d],!1));break;case -2:case 71:if(0<=l){const f=lb(a.u,g,l,d);d=e.H.slice(0,9);l=d.findIndex(h=>null!==h.content&&h.content.id===f);0<=l?e.N=l:1===e.G&&(d[e.N].content&&(d=d.findIndex(h=>null===h.content),0<=d&&(e.N=d)),e.H[e.N].content=S(f));e.ja=a.Z}break;case -3:if(2!==e.G&&0<=l)if(0===e.Fa){if(b=e.H[e.N],b.content){switch(e.xa){case 0:--g;break;case 1:++g;break;case 2:--l;break;case 3:++l;break;case 4:--d;break;default:++d}0<=l&&64>l&&nb(a.u,g&(1<<4+a.u.M)-1,l,d&(1<<4+
a.u.M)-1,b.content.id)&&1!==e.G&&0>=--b.content.amount&&(b.content=null)}}else Ub(a,[g,l,d],!0);break;case -4:e.N=(e.N+9-1)%9;e.ja=a.Z;break;case -5:e.N=(e.N+1)%9;e.ja=a.Z;break;case 27:a.j?(a.l=!1,a.j=0):(a.l=!0,a.j=1);break;case -15:case -14:case 16:case 32:Qb(a);break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:e.N=b-49;e.ja=a.Z;break;case -12:case -13:case 65:case 68:Pb(a);break;case 69:if(2!==e.G&&!a.j){a.j=3;for(const f of c)V(a,f,!1)}break;case 80:a.l=!a.l;break;
case 81:e=e.H[e.N];if(c.has(17)||e.content&&0>=--e.content.amount)e.content=null;break;case -11:case -10:case 83:case 87:Rb(a);break;case 84:if(!a.j){a.j=2;for(const f of c)V(a,f,!1)}break;case 114:a.Ba=!a.Ba;break;default:return!1}}else{if(!c.delete(b))return!1;switch(b){case -15:case -14:case 16:case 32:Qb(a);break;case -12:case -13:case 65:case 68:Pb(a);break;case -11:case -10:case 83:case 87:Rb(a);break;case -18:case -19:Sb(a);break;case -17:case -16:Tb(a)}}a.Pa=[...c].join();return!0},Vb=(a,
b)=>(b=b.startsWith("~")?a+O(b.substr(1)):O(b),isNaN(b)?a:b),Z=(a,b,d=!1)=>{(a.U=a.U.slice(-49)).push({id:++Lb,fb:d,time:ia(),value:b})},Ub=(a,b,d)=>{d?a.g.ma=b:a.g.la=b;Z(a,`${d?"second":"first"} position: ${b.join(" ")}`,!0)};function Wb({mb:a}){u("div[className=grid]",{onclick:({target:b})=>{(b=b.closest("[data-id]"))&&bb({content:S(O(b.dataset.id)),filter:null,P:64},a)}});return qa.map((b,d)=>0<d&&H("div",{D:{id:d}},[E($a,{id:d,amount:1,data:null})]))}
function Xb({o:a}){const b=da(()=>({content:null,filter:null,P:64}));u("div[className=menu inventory]",da(()=>({onclick:({target:d})=>{if("menu inventory"===d.className)b.content?b.content=null:(a.j=0,a.l=!1,a.cb.requestPointerLock());else if(d=d.closest("[data-slot]"))d=a.g.H[O(d.dataset.slot)],b.content?bb(b,d):d.content&&bb(d,b)},oncontextmenu:({target:d})=>{if("menu inventory"===d.className)b.content?0>=--b.content.amount&&(b.content=null):(a.j=0,a.cb.requestPointerLock());else if(d=d.closest("[data-slot]"))d=
a.g.H[O(d.dataset.slot)],b.content?bb(b,d,1):d.content&&bb(d,b,Da(d.content.amount/2))}})));return[H("div[className=window]",null,[H("div[innerText=Inventory]"),1===a.g.G&&E(Wb,{mb:b}),H("div[className=grid]",null,a.g.H.map(({content:d},c)=>H("div",{D:{slot:c},F:{first:9>c}},[d&&E($a,{id:d.id,amount:d.amount,data:d.data})])))]),b.content&&H("div[className=hand]",{S:{left:`${a.Za}px`,top:`${a.$a}px`}},[E($a,{id:b.content.id,amount:b.content.amount,data:b.content.data})])]}
const Yb=({I:{fb:a,time:b,value:d},ka:c})=>(u(a?"div[className=minor]":"div",{innerText:d,S:{opacity:L(1,1-.001*(c-b-4500))}}),null);function Zb({U:a,ka:b}){u("div[className=messages]");const d=b-5E3;return[ha(Yb,a.slice(-10).filter(c=>c.time>d),{ka:b})]}
function $b({actions:{jb:a,Ma:b,Ya:d},A:c,o:e}){A(()=>{Db(e.u,e.g);return b});A(()=>{const g=Ua(b,1E3);return()=>Wa(g)},[c]);u("div[className=menu]");return[H("h1[innerText=Men\u00fc]"),H("div[className=settings]",null,[H("button",{innerText:"Oberfl\u00e4chen: "+(c.ia?"Texturiert":"Einfarbig"),onclick:B(()=>a(g=>({ia:!g.ia})))}),H("label[innerText=Aufl\u00f6sung:]",null,[H("input[type=range][min=1][max=100][step=1]",{value:101-c.$,onchange:B(g=>d({$:101-Number(g.target.value)}))})]),H("label[innerText=Blickwinkel:]",
null,[H("input[type=range][min=1][max=180][step=1]",{value:c.va,onchange:B(g=>d({va:Number(g.target.value)}))})]),H("label[innerText=Sichtweite:]",null,[H("input[type=range][min=1][max=128][step=1]",{value:c.da,onchange:B(g=>d({da:Number(g.target.value)}))})]),H("label[innerText=Mausempfindlichkeit:]",null,[H("input[type=range][min=1][max=15][step=1]",{value:c.pa,onchange:B(g=>d({pa:Number(g.target.value)}))})])]),H("center",null,[H("button[innerText=Zur\u00fcck]",{onclick:B(()=>(e.j=0,e.l=!1,e.cb.requestPointerLock()))})])]}
const ac=({I:{fb:a,value:b}})=>(u(a?"div[className=minor]":"div",{innerText:b}),null);
function bc({o:a,U:b}){u("div[className=menu terminal]");const d=B({history:null});A(c=>{c&&Ua(()=>d.history.scrollTop=1E9,0)},[b.length&&b[b.length-1].id]);return[H("div[className=history]",{R:B(c=>{d.history=c})},[ha(ac,b)]),H("input[enterkeyhint=send][mozactionhint=send][name=message][required]",B({onkeydown:c=>{var e=c.keyCode;c=c.target;if(13===e){var g=c.value;e=a.g;if(g)if("/"===g.charAt(0)){g=g.substr(1).split(" ");const f=g.shift();switch(f){case "clear":a.U=[];break;case "clearinv":for(var l of e.H)l.content=
null;Z(a,"inventory cleared",!0);break;case "exit":a.l=!1;a.j=0;break;case "gamemode":case "gm":g=O(g[0]);!isNaN(g)&&0<=g&&3>g&&0===g%1?(e.G=g,Z(a,`gamemode set to ${g}`,!0)):Z(a,"gamemode must be in 0..2");break;case "give":if(0===g.length){Z(a,"/give <id> [amount]\n"+qa.join(" "));break}l=qa.indexOf((g[0]||"").toLowerCase());l=0<=l?l:O(g[0]);g=O(g[1]||1);!isNaN(l)&&0<l&&25>l&&0===l%1?!isNaN(g)&&0<g&&0===g%1?Z(a,cb(e.H,S(l,g))?"inventory full":`gave ${g} ${qa[l]}`,!0):Z(a,"amount must be at least 1"):
Z(a,"invalid block type");break;case "help":Z(a,"commands: clear, clearinv, exit, gamemode, give, help, me, save, spawn, teleport, version");break;case "me":Z(a,e.name+" "+g.join(" "),!0);break;case "save":Db(a.u,a.g);a.actions.Ma();Z(a,"world+config saved",!0);break;case "smart":e.name="LFF5644";Z(a,"lff.smart: true",!0);break;case "spawn":a.u.sa=e.J;a.u.ta=e.K;a.u.ua=e.L;Z(a,"spawn updated",!0);break;case "teleport":case "tp":0===g.length?(e.J=a.u.sa,e.K=a.u.ta,e.L=a.u.ua,a.B.Y=!0,Z(a,"teleported to spawn",
!0)):3===g.length?(Z(a,`teleported to ${e.J=Vb(e.J,g[0])} ${e.K=Vb(e.K,g[1])} ${e.L=Vb(e.L,g[2])}`,!0),a.B.Y=!0):Z(a,"PITCH");e.aa=0;e.ba=0;e.ca=0;break;case "version":Z(a,"Minicraft 0.6.3");break;case "/exit":e.Fa=0;Z(a,"normal mouse mode",!0);break;case "/expand":a.g.la&&a.g.ma?l=!0:(Z(a,"selection required"),l=!1);l&&("vert"===g[0]?(e.la[1]=0,e.ma[1]=63,Z(a,"selection expanded",!0)):Z(a,"only vert supported"));break;case "/pos1":case "/pos2":Ub(a,[K(e.J),K(e.K),K(e.L)],"/pos2"===f);break;case "/regen":e=
a.u;g=e.X[e.Aa[e.na=0].Wa];N.removeItem(Fb(e,g.wa,g.Ia,g.y));g.ha=!1;++g.wa;pb(e);Z(a,"regenerate chunk",!0);a.B.Y=!0;break;case "/show":Z(a,`first: ${e.la?e.la.join(" "):"none"}, second: ${e.ma?e.ma.join(" "):"none"}`);break;case "/wand":e.Fa=1;Z(a,"primary+secondary button for selection",!0);break;default:Z(a,"unknown command: "+f)}}else Z(a,`<${e.name}> `+g);c.value=""}else 27===e&&(a.l=!1,a.j=0)},R:c=>Ua(()=>c.focus(),0)}))]}
const cc=[["pick",-2],["up",-14],["down",-15],["E",69],["T",84],["F3",114],["...",27]],dc=[["up",-10],["down",-11],["left",-12],["right",-13],["center",-1]],ec=[["up",-16],["down",-17],["left",-18],["right",-19],["center",-3]];
function fc({o:a}){const b=a.T,d=([c,e])=>H("div",{D:{code:e},F:{button:!0,[c]:!0,active:b.has(e)}});u("div[className=touch]",B({ontouchstart:c=>{c.preventDefault();const e=Number(c.target.dataset.code);if(null!=e&&V(a,e,!0)){const g=c.changedTouches[0].identifier,l=f=>{f.changedTouches[0].identifier===g&&(removeEventListener("touchend",l),V(a,e,!1))};addEventListener("touchend",l)}}}));return[H("div[className=top]",null,cc.map(([c,e])=>H(`div[innerText=${c}]`,{D:{code:e},F:{button:!0,active:b.has(e)}}))),
H("div[className=move]",null,dc.map(d)),H("div[className=move sec]",null,ec.map(d))]}
function gc({actions:a,A:b,lb:d}){const c=da(Mb),e=ia(),g=u("div[className=game]",da(()=>{const f=h=>0!==c.j||(c.oa=!1,ua.pointerLockElement===g?c.l||V(c,-1-h.button,"mousedown"===h.type):c.cb.requestPointerLock(),h.preventDefault(),!1);return{onmousedown:f,onmousemove:h=>{if(c.l||c.j)c.Za=h.clientX,c.$a=h.clientY;else{const k=c.A.pa*va/M(c.Qa,c.Ra);eb(c.g,h.movementX*k,-h.movementY*k)}},onmouseup:f,ontouchstart:h=>{c.oa=!0;c.j||(c.l=!1,h.preventDefault())},onwheel:h=>{c.oa=!1;if(!c.j&&!c.l&&5<Math.abs(h.deltaY)){const k=
0<h.deltaY?-5:-4;V(c,k,!0);V(c,k,!1);h.preventDefault()}}}})),l=ua.pointerLockElement===g;A(()=>(c.actions=a,c.cb=g,d.o=c,()=>{Xa(c.ib);Xa(c.B.kb);return d.o=null}));A(()=>{c.A=b;c.B&&(c.B.Y=!0);const f=c.g,h=c.u;var k=c.A.da;k=17>k?2:49>k?3:113>k?4:241>k?5:497>k?6:1009>k?7:2033>k?8:4081>k?9:8177>k?10:16369>k?11:32753>k?12:13;if(h.M!==k){h.X&&Db(h,f);const r=1<<(h.M=k),m=h.X=[];for(let t=0;t<r;++t)for(let x=0;x<r;++x)for(let v=0;4>v;++v)m.push({ha:!1,loaded:!1,x:t,y:v,z:x,wa:0,Ia:0});k=r<<k+12+2;
null===h.W||h.W.length<k?h.ya=new Sa((h.W=new Ra(k)).buffer):h.ya.fill(0);Bb(h,f,!0)}},[b]);A((f,h,k)=>{c.Qa=M(1,f*k);c.Ra=M(1,h*k);h=c.A.$;f=M(1,Ea(c.Qa/h));h=M(1,Ea(c.Ra/h));if(f!==c.Ga||h!==c.Ha)c.Ga=f,c.Ha=h,c.B&&(c.B.Y=!0,Jb(c.B))},[g.offsetWidth,g.offsetHeight,ta.devicePixelRatio||1,b.$]);A(()=>{l||c.l||c.j||(c.j=1);c.l=!l},[l]);A(f=>l&&f&&ua.exitPointerLock(),[c.l||c.j]);A(()=>{if(c.Z&&!c.l){var f=c.g,h=L(5,.01*(e-c.Z));f.aa-=.1*f.aa*h;f.ba-=.1*f.ba*h;f.ca-=.1*f.ca*h;f.aa+=(Fa(f.O)*f.Ja+Ga(f.O)*
f.Ka)*h;f.ba+=f.Ta*h;f.ca+=(-Ga(f.O)*f.Ja+Fa(f.O)*f.Ka)*h;eb(f,f.gb*h,f.hb*h);f.J+=f.aa*h;f.K+=f.ba*h;f.L+=f.ca*h}if(c.B){f=c.B;++f.Oa;h=f.La;var k=f.Va;const J=f.o,ka=J.A,n=J.g,P=J.Ga,U=J.Ha,Q=J.u;if(!J.l||f.Y){f.Y=!1;const aa=k.data,ic=ka.da;var r=n.O,m=n.ea;const jc=n.fa,kc=n.V,lc=n.ga;var t=n.J,x=n.K,v=n.L;const mc=Q.W;var w=Q.M;const nc=ka.ia&&null!==Gb;var y=1/P,q=1/U;const ba=P>>1,ca=U>>1,qb=L(P,U),rb=32<qb,sb=Fa(r);r=Ga(r);const tb=Fa(-m);m=Ga(-m);var C=ka.va/45;const oc=y*(P<U?C*P*q:C);y=
q*(U<P?C*U*y:C);t+=65536;x+=65536;v+=65536;q=t%1;C=x%1;const pc=v%1;w=4+w;const ub=(1<<w)-1;let vb=1===n.G?6:4,W=n.fa=n.ga=n.xa=0;n.V=-1;for(let ya=0;ya<U;++ya){var za=(ca-ya)*y;const wb=za*tb-m;var Ka=za*m+tb;za=Ka*r;Ka*=sb;for(let Aa=0;Aa<P;++Aa){var la=(Aa-ba)*oc;const xb=za+sb*la;la=Ka-r*la;let ma=16757124,Ba=1,yb=ic;for(let z=0;3>z;++z){let F=la;0===z&&(F=xb);1===z&&(F=wb);var X=1/(0>F?-F:F);const Ca=xb*X,Y=wb*X;X*=la;const zb=Ha(Ca*Ca+Y*Y+X*X);var D=pc;0===z&&(D=q);1===z&&(D=C);0<F&&(D=1-D);
let na=t+Ca*D-(0===z&0>F|0),oa=x+Y*D-(1===z&0>F|0),pa=v+X*D-(2===z&0>F|0);D*=zb;for(let La,Ma,Na,G;D<yb;na+=Ca,oa+=Y,pa+=X,D+=zb)if(65536>oa){if(0>Y)break}else if(65600<=oa){if(0<Y)break}else if(0!==(G=mc[((La=na&ub)<<w|(Na=pa&ub))<<6|(Ma=oa&63)])){ya===ca&&Aa===ba&&D<=vb&&(n.fa=La,n.V=Ma,n.ga=Na,n.xa=0>F|z<<1,vb=D);if(nc){--G;1===z?6===G?G=25:13===G?G=4:1===G&&0<Y&&(G=2):1===G&&(G=24);const Ab=Gb[G<<8|(16*(1===z?pa:oa)&15)<<4|16*(1===z?na:(0<F?na-pa:pa-na)+65536)&15];if(0===Ab>>>24)continue;ma=Ab&
16777215}else ma=ra[G];yb=D;Ba=(0===z?.8:2===z?.6:0<F?.4:1)+(Ma!==kc||La!==jc||Na!==lc?0:.2);break}}aa[W]=(ma&255)*Ba;aa[++W]=(ma>>8&255)*Ba;aa[++W]=(ma>>16)*Ba;W+=2}}rb||(aa[W=P*ca+ba<<2]+=128,aa[++W]+=128,aa[++W]+=128);h.putImageData(k,0,0);rb&&(k=Da(.05*qb),h.fillRect(ba-k,ca-1,k<<1,2),h.fillRect(ba-1,ca-k,2,k-1),h.fillRect(ba-1,ca+1,2,k-1))}f.ab=J.Ba?"Minicraft 0.6.3 "+K(f.bb).toString().padStart(2,"\u00a0")+" fps, T: "+K(24*J.Sa).toString().padStart(2,"0")+":"+K(24*J.Sa%1*60).toString().padStart(2,
"0")+"; "+(J.l&&500>e%1E3?"":J.time)+"\nR: "+P+"x"+U+" (x"+ka.$+"), D: "+ka.da+", C: "+Q.na+"/"+Q.Aa.length+", M: "+(64*R(1<<4+Q.M)>>10)+"k\nE: 0/0 M: "+n.G+"\n\nPosition: "+n.J.toFixed(2)+" "+n.K.toFixed(2)+" "+n.L.toFixed(2)+"\nAngle: "+(n.O*xa).toFixed(2)+" "+(n.ea*xa).toFixed(2)+"\nBlock: "+(0>n.V?0:n.fa+" "+n.V+" "+n.ga+" "+sa[n.xa]+": "+lb(Q,n.fa,n.V,n.ga))+"\nChunk abs: "+(K(n.J)>>4)+" "+(K(n.L)>>4)+" "+(K(n.K)>>4)+" rel: "+Q.Ca+" "+Q.Ea+" "+Q.Da:""}c.Z=e},[e]);fa();return[H("canvas",{R:B(f=>
Nb(c,f))}),2!==c.j&&E(Zb,{U:c.U,ka:e}),c.B&&c.Ba&&H("div[className=diagnostics]",{innerText:c.B.ab}),c.oa&&E(fc,{o:c,Pa:c.Pa}),3!==c.j&&2!==c.g.G&&E(ab,{g:c.g,ka:e}),3===c.j&&E(Xb,{o:c,ka:e}),1===c.j&&E($b,{actions:a,A:b,o:c}),2===c.j&&E(bc,{o:c,U:c.U})]}
const hc={init:()=>{const a={ia:!0,pa:3,$:10,va:80,da:64};var b=N.getItem("minicraft.config");if(b){b=Pa(b);let d=b.flag_textures;null!=d&&(a.ia=d);null!=(d=b.mouse_sensitivity)&&(a.pa=d);a.$=b.resolution_scaling;a.va=b.view_angle;a.da=b.view_distance}return{A:a,Xa:a}},Ma:a=>{const b=a.A;if(b===a.Xa)return a;Qa("minicraft.config",Oa({version:"0.6.3",flag_textures:b.ia,mouse_sensitivity:b.pa,resolution_scaling:b.$,view_angle:b.va,view_distance:b.da}));return Object.assign({},a,{Xa:b})},jb:(a,b)=>hc.Ya(a,
b(a.A)),Ya:(a,b)=>Object.assign({},a,{A:Object.assign({},a.A,b)})};p.init(()=>{const [a,b]=ea(hc),d=B({o:null});A(()=>{let e=!1;onbeforeunload=onunload=()=>{if(!e&&(e=!0,b.Ma(),d.o)){var g=d.o;Db(g.u,g.g)}}});const c=B(e=>"INPUT"===e.target.tagName||!d.o||(e.preventDefault(),V(d.o,e.keyCode,"keydown"===e.type),d.o.oa=!1));return[{onkeydown:c,onkeyup:c,oncontextmenu:Ya,ondragstart:Ya},[E(gc,{actions:b,A:a.A,lb:d})]]});
