const k=lui,m=k.hook_dom,p=k.hook_effect,ia=k.hook_memo,ja=k.hook_rerender,r=k.hook_static,C=k.node,D=k.node_dom,ka=k.now,E=Math,F=E.PI,I=180/F,J=E.floor,K=E.round,P=E.max,Q=E.cos,R=E.sin,la=[0,7960953,8370002,7885881,8553090,9927501,4539717,6311215,3113506,12094592,14145495],na=()=>{const b={K:ma(),ja:8,ka:32,la:8};for(let d=0;16>d;d+=2)b.K[S(d,4,0)]=3,b.K[S(0,4,d)]=3;["X   XXX XXX XXX","X     X X X   X","X   XXX XXX XXX","X     X X     X","XXX XXX X   XXX"].forEach((d,a,c)=>{a=c.length-a;d.split("").forEach((f,
e)=>{"X"===f&&(b.K[S(e+1,4,a)]=6)})});return b},S=(b,d,a)=>((d|0)<<8)+((b-(0>b)&15)<<4)+(a-(0>a)&15),ma=()=>{const b=new Uint8Array(16384),d=[6,3,3,3,2];for(let a=-1,c=0;c<d.length;++c){const f=d[c];for(let e=0;16>e;++e)for(let g=0;16>g;++g)b[++a]=f}return b},oa=(b,d)=>{const a={canvas:d,aa:null,ba:null,ca:"",v:!1,N:0,W:0,ea:setInterval(()=>{a.N=a.W;a.W=0},1E3),j:b};T(a);return a},T=b=>{var d=b.canvas.width=b.j.A,a=b.canvas.height=b.j.B;b=(b.ba=(b.aa=b.canvas.getContext("2d")).createImageData(d,a)).data;
d=b.length;for(a=3;a<d;a+=4)b[a]=255},pa=()=>({u:!1,L:!1,M:!1,l:!1,h:{o:0,J:0,s:0,O:8,P:30,T:8,D:0,G:0,H:0,m:0,V:0},g:null,i:10,X:0,Y:0,A:0,B:0,da:null,time:0,Z:0,$:80,U:64,ga:na()}),qa=(b,d)=>{b.g=oa(b,d);b.da=setInterval(()=>{if(!b.l){b.time=(b.time+1)%24E3;b.Z=1/24E3*(b.time+6E3)%1;var a=b.h;a.D*=.8;a.G*=.8;a.H*=.8;a.D+=Q(a.m)*a.o+R(a.m)*a.s;a.G+=a.J;a.H+=-R(a.m)*a.o+Q(a.m)*a.s;a.O+=a.D;a.P+=a.G;a.T+=a.H;b.u&&b.g&&0===b.time%10&&(100>b.i&&20>b.g.N?(b.i+=1,U(b)):1<b.i&&40<b.g.N&&(--b.i,U(b)))}},
50)},U=b=>{const d=P(1,K(b.X/b.i)),a=P(1,K(b.Y/b.i));if(d!==b.A||a!==b.B)b.A=d,b.B=a,b.g&&(b.g.v=!0,T(b.g))};
function ra({j:b}){m("div[className=menu]");return[D("h1[innerText=Men\u00fc]"),D("div[className=settings]",null,[D("button",{innerText:`Bildskalierung: ${b.u?"Dynamisch":"Statisch"}`,onclick:r(()=>{b.u=!b.u})}),D("label[innerText=Skalierung:]",null,[D("input[type=range][min=1][max=100][step=1]",{value:101-b.i,onchange:r(d=>{b.i=101-Number(d.target.value);U(b)})})]),D("label[innerText=Blickwinkel:]",null,[D("input[type=range][min=1][max=180][step=1]",{value:b.$,onchange:r(d=>{b.$=Number(d.target.value);
b.g.v=!0})})]),D("label[innerText=Sichtweite:]",null,[D("input[type=range][min=1][max=128][step=1]",{value:b.U,onchange:r(d=>{b.U=Number(d.target.value);b.g.v=!0})})])]),D("div",null,[D("button[innerText=Zur\u00fcck]",{onclick:r(()=>{b.l=b.M=!1})})])]}
function sa({fa:b}){const d=m("div[className=game]"),a=ia(pa);p(()=>{b.j=a;onmousemove=c=>{a.l||(a.h.m=2*(c.clientX/a.X-.5)*F,a.h.V=(.5-c.clientY/a.Y)*F)};return()=>{clearInterval(a.da);clearInterval(a.g.ea);onmousemove=null;b.j=null}});p((c,f)=>{a.X=c;a.Y=f;U(a)},[d.offsetWidth,d.offsetHeight]);p(c=>{if(a.g){var f=a.g;++f.W;const V=f.ba;var e=f.j,g=e.h;const ta=e.ga;f.ca=e.L?"Minicraft 0.1.6 "+J(f.N).toString().padStart(2,"\u00a0")+" fps, T: "+J(24*e.Z).toString().padStart(2,"0")+":"+J(24*e.Z%1*
60).toString().padStart(2,"0")+"; "+(e.l&&500>c%1E3?"":e.time)+"\nR: "+e.A+"x"+e.B+" (x"+e.i+"), C: 1, D: "+e.U+"\nE: 0/0\n\nPosition: "+g.O.toFixed(2)+" "+g.P.toFixed(2)+" "+g.T.toFixed(2)+"\nAngle: "+(g.m*I).toFixed(2)+" "+(g.V*I).toFixed(2)+"\nBlock: 0 0 0\nChunk: 0 0 0 in 0 0\nFacing: 0":"";if(!e.l||f.v){f.v=!1;c=V.data;var t=e.A,u=e.B,ua=e.U,va=.5*t,wa=.5*u,W=1/t,X=1/u,w=g.m,x=g.V,Y=g.O,Z=g.P;g=g.T;var aa=Q(w);w=R(w);var ba=Q(-x);x=R(-x);var v=e.$/45;e=t<u?v*t*X:v;v=u<t?v*u*W:v;var G=0;for(let L=
0;L<u;++L)for(let M=0;M<t;++M){var y=(M-va)*W*e,z=(wa-L)*X*v;const ca=z*ba-x;var q=ba+z*x;z=y*aa+q*w;y=q*aa-y*w;q=8696319;let H=1,da=ua;for(let n=0;3>n;++n){var l=0===n?z:1===n?ca:y;const A=1/(0>l?-l:l),ea=z*A,fa=ca*A,ha=y*A;var h=0===n?Y%1:1===n?Z%1:g%1;h=0>h?-h:h;h=0<l?1-h:h;let N=Y+ea*h,B=Z+fa*h,O=g+ha*h;h*=A;for(0===n?N+=0>l?-.5:.5:1===n?B+=0>l?-.5:.5:O+=0>l?-.5:.5;h<da;)if(l=0>B||64<=B?0:ta.K[S(N,B,O)],0===l)N+=ea,B+=fa,O+=ha,h+=A;else{q=la[l];H=1-(n+2)%3*.2;da=h;break}}c[G]=(q>>16&255)*H;c[++G]=
(q>>8&255)*H;c[++G]=(q&255)*H;G+=2}f.aa.putImageData(V,0,0)}}},[ka()]);ja();return[D("canvas",{R:r(c=>{qa(a,c)})}),a.g&&a.L&&D("div[className=diagnostics]",{innerText:a.g.ca}),a.M&&C(ra,{j:a,ha:a.u,ia:a.i})]}
k.init(()=>{const b=r({j:null}),d=r(a=>{var c;if(!(c=!b.j))a:{c=b.j;var f=a.keyCode;if("keydown"===a.type)switch(f){case 27:c.l=c.M=!c.M;break;case 16:c.h.J=-.1;break;case 32:c.h.J=.1;break;case 65:c.h.o=-.1;break;case 68:c.h.o=.1;break;case 80:c.l=!c.l;break;case 83:c.h.s=-.1;break;case 87:c.h.s=.1;break;case 114:c.L=!c.L;break;default:c=!0;break a}else switch(f){case 16:case 32:c.h.J=0;break;case 65:case 68:c.h.o=0;break;case 83:case 87:c.h.s=0;break;default:c=!0;break a}c=!1}return c||(a.preventDefault(),
!1)});return[{onkeydown:d,onkeyup:d},[C(sa,{fa:b})]]});
