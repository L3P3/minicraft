function ba(a){function b(d){return a.next(d)}function c(d){return a.throw(d)}return new Promise(function(d,e){function l(m){m.done?d(m.value):Promise.resolve(m.value).then(b,c).then(l,e)}l(a.next())})}
const n=lui,ca=n.defer,ha=n.defer_end,ia=n.hook_async,A=n.hook_dom,D=n.hook_effect,ja=n.hook_memo,ka=n.hook_model,oa=n.hook_rerender,pa=n.hook_state,F=n.hook_static,qa=n.init,G=n.node,H=n.node_dom,ra=n.node_map,va=n.now,wa=window,xa=document,za=navigator,K=Math,Aa=K.PI,Ba=.5*Aa,Fa=180/Aa,Ga=K.random,L=K.floor,Ha=K.ceil,Ia=K.round,M=K.min,Ja=K.max,Ka=K.cos,La=K.sin,Ma=K.sqrt,Na=K.log2,Oa=String.fromCharCode,Pa=BroadcastChannel,Qa=Date,Ya=JSON,Za=Promise,$a=Ya.stringify,ab=Ya.parse,N=localStorage,bb=
N.setItem.bind(N),cb=N.removeItem.bind(N),db=wa.indexedDB,eb=fetch,fb=Uint8Array,gb=Uint32Array,hb=Set,lb=Map,P=Number,mb=Object,nb=mb.keys,ob=mb.entries,pb=setTimeout,qb=setInterval,rb=clearTimeout,sb=clearInterval,tb=addEventListener,ub=removeEventListener,vb=za.userAgent.includes("WebKit"),wb=a=>a*a,xb=()=>!1,yb=(a,b)=>{const c=new Qa;a=new Qa(a);var d=c-a;if(59E3>d)return Ia(d/1E3)+"s";if(3E6>d)return Ia(d/6E4)+"m";d=a.getFullYear();const e=a.getMonth(),l=a.getDate();let m="";d<c.getFullYear()&&
(m=d+"/");if(m||e<c.getMonth())m+=e+1+"/";if(m||l<c.getDate())m+=l;if(b)return m||"\u0441\u0435\u0433\u043e\u0434\u043d\u044f ";m&&(m+="/");b=m+a.getHours()+":";a=a.getMinutes();a=L(a).toString().padStart(2,"0");return b+a};let Q=N.getItem("minicraft.config");if((Q=Q&&ab(Q))&&Q.worlds&&Q.version.startsWith("0.9.")){const a=new hb(Q.worlds.map(b=>"minicraft.world."+b.id));for(const b of nb(N))b.startsWith("minicraft.world.")&&!a.has(b.split(":")[0])&&cb(b)}
const Eb={init:()=>{let a=!1;var b={ka:!1,xa:1,ua:3,Y:4,T:1,Da:120,ga:64,Ea:0,worlds:[]};if(Q){let c=Q.pixel_grouping;null!=c&&(b.xa=c);null!=(c=Q.mouse_sensitivity)&&(b.ua=c);b.Y=Q.resolution_scaling;null!=(c=Q.textures)?b.T=c:b.T=Q.flag_textures?1:0;b.Da=Q.view_angle;b.ga=Q.view_distance;null!=(c=Q.world_last)&&(b.Ea=c);null!=(c=Q.worlds)?b.worlds=c:N.getItem("minicraft.world.0:meta")&&(b.worlds[0]={id:0,label:(prompt("\u0411\u0443\u0432 \u0437\u043d\u0430\u0439\u0434\u0435\u043d \u0431\u0435\u0437 \u043d\u0430\u0437\u0432\u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u0438\u0439 \u0441\u0432\u0456\u0442. \u042f\u043a \u0439\u043e\u0433\u043e \u043d\u0430\u0437\u0432\u0430\u0442\u0438?",
"")||"\u041d\u0435\u0434\u0456\u0439\u0441\u043d\u0438 \u0441\u0432\u0456\u0442").substring(0,16),mod_l:Qa.now(),mod_r:0},a=!0);Q=null}b={account:{label:"",rank:0},config:b,Ya:b};return a?(b.Ya=null,Eb.Xa(b)):b},Xa:a=>{const b=a.config;if(b===a.Ya)return a;bb("minicraft.config",$a({version:"0.11.3",pixel_grouping:b.xa,mouse_sensitivity:b.ua,resolution_scaling:b.Y,textures:b.T,view_angle:b.Da,view_distance:b.ga,world_last:b.Ea,worlds:b.worlds}));return Object.assign({},a,{Ya:b})},xb:(a,b)=>Object.assign({},
a,{account:b}),Gb:(a,b)=>Eb.ia(a,b(a.config)),ia:(a,b)=>Object.assign({},a,{config:Object.assign({},a.config,b)}),Ja:(a,b)=>a.config.ka===b?a:Eb.ia(a,{ka:b}),gb:(a,b)=>Object.assign({},a,{config:Object.assign({},a.config,{worlds:[...a.config.worlds,b]})}),hb:(a,b)=>Object.assign({},a,{config:Object.assign({},a.config,{worlds:a.config.worlds.filter(c=>c.id!==b)})}),U:(a,b,c)=>Object.assign({},a,{config:Object.assign({},a.config,{worlds:a.config.worlds.map(d=>d.id===b?Object.assign({},d,c):d)})})},
Fb="air stone grass dirt cobble planks bedrock log leaves bricks wool sand gravel glass bookshelf obsidian stone_bricks sandstone lapis_block iron_block gold_block diamond_block emerald_block redstone_block quartz_block".split(" "),Gb="\u041f\u043e\u0432\u0456\u0442\u0440\u044f;\u041a\u0430\u043c\u0456\u043d\u044c;\u0411\u043b\u043e\u043a \u0442\u0440\u0430\u0432\u0438;\u0417\u0435\u043c\u043b\u044f;\u0411\u0443\u0442\u043e\u0432\u0438\u0439 \u043a\u0430\u043c\u0456\u043d\u044c;\u0414\u043e\u0448\u043a\u0430;\u041a\u043e\u0440\u0456\u043d\u043d\u0430 \u043f\u043e\u0440\u043e\u0434\u0430;\u041a\u043e\u043b\u043e\u0434\u0430;\u041b\u0438\u0441\u0442\u044c\u044f;\u041a\u0438\u0440\u043f\u0438\u0447\u0438;\u0428\u0435\u0440\u0441\u0442\u044c;\u041f\u0456\u0441\u043e\u043a;\u0413\u0440\u0430\u0432\u0456\u0439;\u0421\u0442\u0435\u043a\u043b\u043e;\u041a\u043d\u0438\u0436\u043d\u0430 \u0448\u0430\u0444\u0430;\u041e\u0431\u0441\u0438\u0434\u0456\u0430\u043d;\u041a\u0430\u043c\u0435\u043d\u043d\u0438\u0439 \u043a\u0438\u0440\u043f\u0438\u0447;\u041f\u0456\u0441\u043a\u043e\u0432\u0438\u043a;\u0411\u043b\u043e\u043a \u043b\u0430\u0437\u0443\u0440\u0438\u0442\u0443;\u0417\u0430\u043b\u0456\u0437\u043d\u0438\u0439 \u0431\u043b\u043e\u043a;\u0417\u043e\u043b\u043e\u0442\u0438\u0439 \u0431\u043b\u043e\u043a;\u0410\u043b\u043c\u0430\u0437\u043d\u0438\u0439 \u0431\u043b\u043e\u043a;\u0421\u043c\u0430\u0440\u0430\u0433\u0434\u043e\u0432\u0438\u0439 \u0431\u043b\u043e\u043a;\u0420\u0435\u0434\u0441\u0442\u043e\u0443\u043d \u0431\u043b\u043e\u043a;\u041a\u0432\u0430\u0440\u0446\u043e\u0432\u0438\u0439 \u0431\u043b\u043e\u043a".split(";"),
Hb=[0,8487297,4305266,4349313,8092539,5342114,7039851,3561583,4172910,6384533,15526888,10671324,8092798,16447200,4151672,1970708,8092539,9686227,9126695,15198183,5567485,14541182,7920469,662956,14936813],Ib=(a,b=1,c=null)=>({amount:b,data:c,id:a}),Jb=(a,b,c=a.c.amount)=>{if(b.c)a.c.id===b.c.id?(c=M(c,b.W-b.c.amount),a.c.amount-=c,b.c.amount+=c,0>=a.c.amount&&(a.c=null)):!(a.c.amount<=c&&a.c.amount<=b.W&&b.c.amount<=a.W)||a.filter&&!a.filter(b.c.id)||b.filter&&!b.filter(a.c.id)||([b.c,a.c]=[a.c,b.c]);
else if(!b.filter||b.filter(a.c.id))a.c.amount<=c&&a.c.amount<=b.W?[b.c,a.c]=[a.c,b.c]:(c=M(c,b.W),a.c.amount-=c,b.c=Ib(a.c.id,c),0>=a.c.amount&&(a.c=null))},Kb=(a,b)=>{for(const c of a)if(c.c&&c.c.id===b.id){const d=M(b.amount,c.W-c.c.amount);c.c.amount+=d;if(0>=(b.amount-=d))return null}for(const c of a)if(!c.c&&(!c.filter||c.filter(b.id)))if(a=M(b.amount,c.W),a<=b.amount){if(c.c=Ib(b.id,a),0>=(b.amount-=a))return null}else return c.c=b,null;return b},Lb=(a,b)=>({Ua:0,ib:0,Va:0,O:0,ha:0,pa:0,aa:0,
V:-1,ba:0,qa:null,ra:null,l:1,rb:20,B:Array(36).fill(null).map(()=>({c:null,filter:null,W:64})),Oa:0,name:b.label||"\u0413\u0440\u043e\u043a",G:a.Aa,H:a.Ba,J:a.Ca,vb:0,wb:0,L:0,ma:0,da:0,ea:0,fa:0}),Mb=(a,b,c)=>{a.O=(a.O+b+100*Aa)%(2*Aa);a.ha=Ja(-Ba,M(Ba,a.ha+c))},Nb=a=>{a+=32;33<a&&39>a?a++:38<a&&44>a?a+=2:43<a&&127>a?a+=3:126<a&&55258>a?a+=37:55295<a&&(a+=8485);return Oa(a)},Ob=a=>a-(63743<a?8517:159<a?69:46<a&&130>a?35:40<a&&46>a?34:34<a&&40>a?33:32),Qb=()=>{var a=Pb;const b=a.length,c=new lb,
d=u=>{g=g<<1|u&1;15===++p&&(w+=Nb(g),g=p=0)},e=()=>{for(let u=0;u<v;++u)d(0)},l=u=>{d(u);d(u>>1);d(u>>2);d(u>>3);d(u>>4);d(u>>5);d(u>>6);d(u>>7)},m=()=>{0===--z&&(z=1<<v++)},k=()=>{if(C)C=!1;else{let u=q.id;for(let E=0;E<v;E++)d(u>>E)}};let f=a[0],w="",g=0,p=2,v=2,z=2,h=2,q={id:h++,Ha:new lb},C=!0;l(f);c.set(f,q);for(let u=1;u<b;++u){const E=q.Ha.get(f=a[u]);E?q=E:(k(),c.has(f)||(m(),e(),l(f),c.set(f,{id:h++,Ha:new lb}),C=!0),q.Ha.set(f,{id:h++,Ha:new lb}),q=c.get(f),m())}k();c.has(f)||(m(),e(),l(f));
m();d(1);--v;e();return w+=Nb(g<<15-p)},Rb=a=>{var b=Pb;if(!a)return null;const c=a.length,d=()=>{p+=(h>>--q&1)<<v++;0===q&&(q=15,h=Ob(a.charCodeAt(z++)))};let e=[0,1],l=1,m=3,k=2,f=null;var w=null;let g=0,p=0;w=2;let v=0,z=0,h=Ob(a.charCodeAt(z++)),q=15;for(;v<w;)d();if(1===p)return null;for(p=v=0;8>v;)d();f=[p];e[2]=f;for(b[g++]=p;z<=c;){w=k;for(p=v=0;v<w;)d();if(0===p){for(p=v=0;8>v;)d();e[m]=[p];p=m++;0===--l&&(l=1<<k++)}else if(1===p)return b;w=p<e.length?e[p]:f.concat(f[0]);for(let C=0;C<w.length;C++)b[g++]=
w[C];e[m++]=f.concat(w[0]);f=w;0===--l&&(l=1<<k++)}return null};let U=null;if(db){let a,b;null==(a=za.storage)||null==(b=a.persist)||b.call(a);const c=db.open("minicraft",1);c.onupgradeneeded=d=>{d=d.target.result.createObjectStore("chunks",{keyPath:["world","coords"]});for(const e of nb(N))if(e.startsWith("minicraft.world.")){const [l,m]=e.substr(16).split(":");"meta"!==m&&(d.add({world:P(l),coords:m,data:N.getItem(e)}),cb(e))}};c.onsuccess=d=>{U=d.target.result}}
const Sb=(a,b)=>ba(function*(){if(!U)return N.getItem(`minicraft.world.${a}:${b}`);const c=U.transaction("chunks","readonly").objectStore("chunks").get([a,b]);return new Za(d=>{c.onsuccess=()=>{let e;d(null==(e=c.result)?void 0:e.data)}})}()),Tb=(a,b)=>{var c=Qb();return ba(function*(){if(!U)return bb(`minicraft.world.${a}:${b}`,c);const d=U.transaction("chunks","readwrite").objectStore("chunks").put({world:a,coords:b,data:c});return new Za((e,l)=>{d.onsuccess=()=>{e()};d.onerror=()=>{l(d.error)}})}())},
Ub=(a,b)=>ba(function*(){if(!U)return cb(`minicraft.world.${a}:${b}`);const c=U.transaction("chunks","readwrite").objectStore("chunks").delete([a,b]);return new Za(d=>{c.onsuccess=()=>{d()}})}()),Vb=a=>ba(function*(){const b=`minicraft.world.${a}:`;if(!U){const e={},l=b.length;for(const m of nb(N))m.startsWith(b)&&(e[m.substr(l)]=N.getItem(m));return e}const c=U.transaction("chunks","readonly").objectStore("chunks").openCursor(),d={meta:N.getItem(b+"meta")};return new Za(e=>{c.onsuccess=()=>{const l=
c.result;l?(l.value.world===a&&(d[l.value.coords]=l.value.data),l.continue()):e(d)}})}()),Wb=(a,b)=>ba(function*(){if(U){var c=U.transaction("chunks","readwrite"),d=c.objectStore("chunks");for(const [e,l]of ob(b))"meta"!==e?d.put({world:a,coords:e,data:l}):bb(`minicraft.world.${a}:meta`,l);return new Za((e,l)=>{c.oncomplete=()=>{e()};c.onerror=()=>{l(c.error)}})}for(const [e,l]of ob(b))bb(`minicraft.world.${a}:${e}`,l);bb("__margin",Array(257).join("x"));cb("__margin")}()),Xb=a=>{if(U){cb(`minicraft.world.${a}:meta`);
var b=U.transaction("chunks","readwrite").objectStore("chunks").openCursor();b.onsuccess=()=>{const c=b.result;c&&(c.value.world===a&&c.delete(),c.continue())}}else{const c=`minicraft.world.${a}:`;for(const d of nb(N))d.startsWith(c)&&cb(d)}},Yb=(a,b)=>{if(U){bb(`minicraft.world.${b}:meta`,N.getItem(`minicraft.world.${a}:meta`));cb(`minicraft.world.${a}:meta`);var c=U.transaction("chunks","readwrite").objectStore("chunks"),d=c.openCursor();d.onsuccess=()=>{const e=d.result;e&&(e.value.world===a&&
(e.value.world=b,c.put(e.value)),e.continue())}}else{const e=`minicraft.world.${a}:`,l=e.length,m=`minicraft.world.${b}:`;for(const k of nb(N))if(k.startsWith(e)){const f=N.getItem(k);cb(k);bb(m+k.substr(l),f)}}},Zb=new gb(1024),Pb=new fb(Zb.buffer),$b=new lb,ac=(a,b,c,d)=>0>c||63<c?0:a.Z[(b<<a.K+4|d)<<6|c],bc=(a,b,c,d)=>{const e=a.K;a.Z[(b<<e+4|d)<<6|c]=0;a.$[(b>>4<<e|d>>4)<<2|c>>4].ja=!0},cc=(a,b,c,d,e)=>{const l=a.K,m=(b<<l+4|d)<<6|c;if(0<a.Z[m])return!1;a.Z[m]=e;return a.$[(b>>4<<l|d>>4)<<2|c>>
4].ja=!0},fc=(a,b,c)=>{const d=Ja(M(b.H,63),0)>>4,e=L(b.G)>>4;b=L(b.J)>>4;if(c||a.Ma!==d||a.va+a.La!==e||a.wa+a.Na!==b)c=1<<a.K,a.Ma=d,a.va=e-(a.La=(65536+e)%c),a.wa=b-(a.Na=(65536+b)%c),dc(a);a.busy||ec(a,!1)},dc=a=>{const b=a.La,c=a.Ma,d=a.Na,e=a.K,l=`${e} ${b} ${d} ${c}`;let m=$b.get(l);if(null==m){const k=1<<e,f=wb(.5*k);$b.set(l,m=a.$.map(({x:w,y:g,z:p},v)=>{let z=wb(w-b),h=wb(p-d),q=wb(w-b-k),C=0,u=0;q<z&&(z=q,C=-k);(q=wb(w-b+k))<z&&(z=q,C=k);(q=wb(p-d-k))<h&&(h=q,u=-k);(q=wb(p-d+k))<h&&(h=
q,u=k);return{Za:z+h+wb(g-c),lb:v,va:C,wa:u}}).filter(({Za:w})=>w<=f).sort((w,g)=>w.Za-g.Za))}a.Ia=m;a.sa=0},hc=(a,b)=>{if(!a.pb){for(var c=b.B.map(({c:d})=>d&&[d.id,d.amount,d.data]);0<c.length&&null===c[c.length-1];)c.pop();bb(`minicraft.world.${a.id}:meta`,$a({p:{h:b.rb,i:c,m:b.l,p:[b.G,b.H,b.J,b.O,b.ha]},s:[a.Aa,a.Ba,a.Ca],t:a.time,v:1}));Za.all(a.$.filter(d=>d.ja).map(d=>gc(a,d)))}},jc=(a,b)=>{const c=N.getItem(`minicraft.world.${a.id}:meta`);if(c){const {p:d,s:e,t:l,v:m}=ab(c);null!=m&&(d.i.forEach((k,
f)=>{k&&(b.B[f].c=Ib(k[0],k[1],k[2]))}),b.rb=d.h,b.l=d.m,b.G=d.p[0],b.H=d.p[1],b.J=d.p[2],b.O=d.p[3],b.ha=d.p[4],a.Aa=e[0],a.Ba=e[1],a.Ca=e[2],null!=l&&ic(a,l))}},ic=(a,b)=>{a.time=b%24E3;a.eb=(b+6E3)/24E3%1},vc=a=>ba(function*(){const b=a.$[a.Ia[a.sa=0].lb];var c=b.y;yield Ub(a.id,`${b.Fa}/${b.Ta}`+(0<c?"/"+c:""));b.ja=!1;++b.Fa;return ec(a,!1)}()),gc=(a,b)=>{const c=a.Ga;var d=a.K;const e=b.y,l=(256<<d)-256;for(let m=0,k=-1,f=((b.x<<d+4|b.z)<<6|e)<<2;16>m;++m){for(d=0;16>d;++d)Zb[++k]=c[f],Zb[++k]=
c[++f],Zb[++k]=c[++f],Zb[++k]=c[++f],f+=13;f+=l}b.ja=!1;return Tb(a.id,`${b.Fa}/${b.Ta}`+(0<e?"/"+e:""))},ec=(a,b)=>ba(function*(){const c=a.$,d=a.Ia,e=a.va,l=a.wa,m=d.length;for(;a.sa<m;){var k=d[a.sa++],f=c[k.lb],w=f.l,g=f.x;const h=f.y;var p=f.z,v=e+k.va+g;const q=l+k.wa+p;if(!w||v!==f.Fa||q!==f.Ta){f.l=a.busy=!0;k=f.ja&&gc(a,f);var z=a.id;v=f.Fa=v;f=f.Ta=q;f=Rb(yield Sb(z,`${v}/${f}`+(0<h?"/"+h:"")));yield k;a.busy=!1;if(w||0===h||f){k=a.Ga;v=a.K;z=(256<<v)-256;g=((g<<v+4|p)<<6|h)<<2;if(f)for(let C=
0,u=-1;16>C;++C){for(w=0;16>w;++w)k[g]=Zb[++u],k[++g]=Zb[++u],k[++g]=Zb[++u],k[++g]=Zb[++u],g+=13;g+=z}else for(p=0;16>p;++p){for(f=0;16>f;++f)k[g]=0<h?0:50397446,k[++g]=0<h?0:131843,w?(k[++g]=0,k[++g]=0,g+=13):g+=15;g+=z}if(!b)break}}}}());let wc=null,xc=null;
const yc=new hb,zc=a=>{if(a){const b=xc=new Image;b.onload=()=>{if(xc===b){var c=xa.createElement("canvas");c.width=16;c.height=416;c=c.getContext("2d");c.scale(1,-1);for(let d=0;26>d;++d)c.drawImage(b,0,d<<4,16,16,0,-(d<<4)-16,16,16);wc=new gb(c.getImageData(0,0,16,416).data.buffer);for(const d of yc)d.P=!0;xc=null}};b.src=`${"/static/minicraft/"}textures/${a}.png`}else wc=null},Bc=(a,b)=>{const c={yb:b,Wa:b.getContext("2d",{alpha:!1,desynchronized:!0}),jb:null,kb:null,ob:"",P:!1,qb:0,$a:0,zb:qb(()=>
(c.qb=c.$a,c.$a=0),1E3),o:a};yc.add(c);Ac(c);return c},Ac=a=>{const b=a.yb,c=a.o;a.kb=new gb((a.jb=a.Wa.createImageData(b.width=c.ya,b.height=c.za)).data.buffer);const d=c.ya*c.config.Y/c.la,e=c.za*c.config.Y/c.la;b.style.width=d+"px";b.style.height=e+"px";b.style.left=Ia((c.Pa-d)/2)+"px";b.style.top=Ia((c.Qa-e)/2)+"px";a.Wa.fillStyle="rgba(255,255,255,.5)"};let Cc=0;
const Fc=(a,b,c,d)=>{const e={Z:null,Ga:null,busy:!1,$:null,Ia:null,sa:0,pb:!1,La:0,Ma:0,Na:0,id:c.Ea,va:0,wa:0,K:0,Aa:.5,Ba:8.5,Ca:.5,time:0,eb:0},l=Lb(e,d);jc(e,l);const m={a,config:c,mb:0,nb:0,Ka:!1,ta:!0,A:!0,Ab:b,ca:0,X:new hb,ab:"",j:0,N:[],g:l,bb:null,u:null,la:1,Pa:1,Qa:1,ya:0,za:0,Ra:0,ub:0,Sa:0,Cb:qb(()=>{var k;(k=m.A)||(ic(e,e.time+1),fc(e,l,!1),k=void 0);return k},50),world:e};Dc(m,null);Ec(m);return m},Gc=a=>{a.world.pb||(hc(a.world,a.g),a.a.U(a.world.id,{mod_l:Qa.now()}))},Ec=a=>{ba(function*(){if(!a.config.ka)try{yield a.Ab.requestPointerLock()}catch(b){}}())},
Hc=(a,b)=>a===b?0:.1-.2*a,Ic=a=>{a.g.Ua=Hc((a=a.X).has(-12)||a.has(65),a.has(-13)||a.has(68))},Jc=a=>{a.g.ib=Hc((a=a.X).has(-15)||a.has(16),a.has(-14)||a.has(32))},Kc=a=>{a.g.Va=Hc((a=a.X).has(-11)||a.has(83),a.has(-10)||a.has(87))},Lc=a=>{a.g.vb=Hc(a.X.has(-18),a.X.has(-19))},Mc=a=>{a.g.wb=Hc(a.X.has(-17),a.X.has(-16))},Oc=(a,b,c)=>{if(!a.world)return!1;const d=a.X;var e=a.g;if(c){if(d.has(b))return!1;d.add(b);var l=e.aa,m=e.V;c=e.ba;switch(b){case -18:case -19:Lc(a);break;case -17:case -16:Mc(a);
break;case -1:2!==e.l&&0<=m&&(0===e.Oa?0===e.l&&(b=ac(a.world,l,m,c),2===b?b=3:1===b&&(b=4),6===b||8!==b&&13!==b&&null!==Kb(e.B,Ib(b,1)))||(bc(a.world,l,m,c),e.V=-1):Nc(a,[l,m,c],!1));break;case -2:case 71:if(0<=m){const k=ac(a.world,l,m,c);c=e.B.slice(0,9);m=c.findIndex(f=>null!==f.c&&f.c.id===k);0<=m?e.L=m:1===e.l&&(c[e.L].c&&(c=c.findIndex(f=>null===f.c),0<=c&&(e.L=c)),e.B[e.L].c=Ib(k));e.ma=a.ca}break;case -3:if(2!==e.l&&0<=m)if(0===e.Oa){if(b=e.B[e.L],b.c){switch(e.pa){case 0:--l;break;case 1:++l;
break;case 2:--m;break;case 3:++m;break;case 4:--c;break;case 5:++c}0<=m&&64>m&&cc(a.world,l&(1<<4+a.world.K)-1,m,c&(1<<4+a.world.K)-1,b.c.id)&&1!==e.l&&0>=--b.c.amount&&(b.c=null)}}else Nc(a,[l,m,c],!0);break;case -4:e.L=(e.L+9-1)%9;e.ma=a.ca;break;case -5:e.L=(e.L+1)%9;e.ma=a.ca;break;case 27:0===a.j&&(a.A=!0,a.j=1);break;case -15:case -14:case 16:case 32:Jc(a);break;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:e.L=b-49;e.ma=a.ca;break;case -12:case -13:case 65:case 68:Ic(a);
break;case 69:if(0===a.j){a.j=3;for(const k of d)Oc(a,k,!1)}break;case 80:a.world&&(a.A=!0);break;case 81:e=e.B[e.L];if(d.has(17)||e.c&&0>=--e.c.amount)e.c=null;break;case -11:case -10:case 83:case 87:Kc(a);break;case 84:if(0===a.j){a.j=2;for(const k of d)Oc(a,k,!1)}break;case 112:a.ta=!a.ta;break;case 114:a.Ka=!a.Ka;case 116:case 122:case 123:break;default:return!1}}else{if(!d.delete(b))return!1;switch(b){case -15:case -14:case 16:case 32:Jc(a);break;case -12:case -13:case 65:case 68:Ic(a);break;
case -11:case -10:case 83:case 87:Kc(a);break;case -18:case -19:Lc(a);break;case -17:case -16:Mc(a)}}a.ab=[...d].join();return!0},Pc=(a,b)=>(b=b.startsWith("~")?a+P(b.substr(1)):P(b),isNaN(b)?a:b),Rc=(a,b)=>{var c=a.g,d=a.world;if(b)if("/"===b.charAt(0)){b=b.substr(1).split(" ");const e=b.shift();switch(e){case "clear":a.N=[];break;case "clearinv":for(const l of c.B)l.c=null;Z(a,"\u0406\u043d\u0432\u0435\u043d\u0442\u0430\u0440 \u0442\u0435\u043f\u0435\u0440\u044c \u043f\u043e\u0440\u043e\u0436\u043d\u0456\u0439",
!0);break;case "gamemode":case "gm":b=P(b[0]);!isNaN(b)&&0<=b&&3>b&&0===b%1?(c.l=b,Z(a,"\u0406\u0433\u0440\u043e\u0432\u0438\u0439 \u0440\u0435\u0436\u0438\u043c \u0432\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0439 \u043d\u0430: "+b,!0)):Z(a,"\u0406\u0433\u0440\u043e\u0432\u0438\u0439 \u0440\u0435\u0436\u0438\u043c \u043f\u043e\u0432\u0438\u043d\u0435\u043d \u0431\u0443\u0442\u0438 0..2!");break;case "give":if(0===b.length){Z(a,"/give <id> [\u041d\u043e\u043c\u0435\u0440]\n"+Fb.join(" "));
break}d=Fb.indexOf((b[0]||"").toLowerCase());d=0<=d?d:P(b[0]);b=P(b[1]||1);!isNaN(d)&&0<d&&25>d&&0===d%1?!isNaN(b)&&0<b&&0===b%1?Z(a,Kb(c.B,Ib(d,b))?"\u0406\u043d\u0432\u0435\u043d\u0442\u0430\u0440 \u043f\u043e\u0432\u043d\u0438\u0439!":`${"\u0414\u0430\u043d\u043d\u0456 \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u0438"} ${b} ${Gb[d]}`,!0):Z(a,"\u041d\u043e\u043c\u0435\u0440 \u043f\u043e\u0432\u0438\u043d\u0435\u043d \u0431\u0443\u0442\u0438 \u044f\u043a \u043c\u0456\u043d\u0456\u043c\u0443\u043c 1!"):
Z(a,"\u041d\u0435\u0434\u0456\u0439\u0441\u043d\u0438\u0439 \u0442\u0438\u043f \u0431\u043b\u043e\u043a\u0443!");break;case "help":Z(a,"\u0423\u043a\u0430\u0437\u0438 : clear, clearinv, gamemode, give, help, load, me, save, spawn, teleport, time, version");break;case "load":ec(d,!0).then(()=>{a.u.P=!0;Z(a,"\u0423\u0447\u0430\u0441\u0442\u043a\u0438 \u0431\u0443\u0434\u0443\u0442\u044c \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u0456.",!0)});break;case "me":Z(a,c.name+" "+b.join(" "),
!0);break;case "save":Gc(a);Z(a,"\u0413\u0440\u0430 \u0437\u0431\u0435\u0440\u0435\u0436\u0435\u043d\u0430.",!0);break;case "spawn":d.Aa=c.G;d.Ba=c.H;d.Ca=c.J;Z(a,"\u041f\u043e\u0447\u0430\u0442\u043a\u043e\u0432\u0430 \u043a\u0440\u0430\u043f\u043a\u0430 \u043e\u043d\u043e\u0432\u043b\u0435\u043d\u0430.",!0);break;case "teleport":case "tp":0===b.length?(c.G=d.Aa,c.H=d.Ba,c.J=d.Ca,a.u.P=!0,Z(a,"\u041f\u0435\u0440\u0435\u043c\u0456\u0441\u0442\u0438\u0432\u0441\u044f \u0434\u043e \u043f\u043e\u0447\u0430\u0442\u043a\u043e\u0432\u043e\u0457.",
!0)):3===b.length?(Z(a,"\u041f\u0435\u0440\u0435\u043c\u0456\u0441\u0442\u0438\u0442\u0438\u0441\u044f \u0434\u043e"+` ${c.G=Pc(c.G,b[0])} ${c.H=Pc(c.H,b[1])} ${c.J=Pc(c.J,b[2])}`,!0),a.u.P=!0):Z(a,"\u041d\u0435\u0432\u0434\u0430\u0447\u044f!");c.da=0;c.ea=0;c.fa=0;break;case "time":c=b[1];if(!c){Z(a,"\u0412\u0456\u0434\u0441\u0443\u0442\u043d\u0456\u0439 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440!");break}if("day"===c)c=1E3;else if("night"===c)c=13E3;else if(isNaN(c=L(P(c))))break;switch(b[0]){case "add":c+=
d.time;case "set":ic(d,c);Z(a,"\u041d\u043e\u0432\u0438\u0439 \u0447\u0430\u0441: "+d.time,!0);break;default:Z(a,"\u041d\u0435\u0434\u0456\u0439\u0441\u043d\u0430 \u043a\u043e\u043c\u0430\u043d\u0434\u0430 : time "+b[0])}break;case "version":Z(a,"minicraft 0.11.3");break;case "/exit":c.Oa=0;Z(a,"\u0417\u0432\u0438\u0447\u0430\u0439\u043d\u0438\u0439 \u0440\u0435\u0436\u0438\u043c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043d\u043e\u0457 \u043c\u0438\u0448\u043a\u0438.",!0);break;case "/expand":a.g.qa&&
a.g.ra?d=!0:(Z(a,"\u041d\u0435\u043e\u0431\u0445\u0456\u0434\u043d\u0438\u0439 \u0432\u0438\u0431\u0456\u0440!"),d=!1);d&&("vert"===b[0]?(c.qa[1]=0,c.ra[1]=63,Z(a,"\u0412\u0438\u0431\u0456\u0440 \u0440\u043e\u0437\u0448\u0438\u0440\u0438\u0432\u0441\u044f.",!0)):Z(a,'\u041f\u0456\u0434\u0442\u0440\u0438\u043c\u0443\u0454\u0442\u044c\u0441\u044f \u0442\u0456\u043b\u044c\u043a\u0438 "vert"!'));break;case "/pos1":case "/pos2":Nc(a,[L(c.G),L(c.H),L(c.J)],"/pos2"===e);break;case "/regen":vc(d).then(()=>
{a.u.P=!0;Z(a,"\u0423\u0447\u0430\u0441\u0442\u043a\u0438 \u0432\u0456\u0434\u043d\u043e\u0432\u043b\u0435\u043d\u0456.",!0)});break;case "/show":Z(a,`${"\u041f\u0435\u0440\u0448\u0438\u0439"}: ${c.qa?c.qa.join(" "):"\u043d\u0456\u0447\u043e\u0433\u043e "}, ${"\u0414\u0440\u0443\u0433\u0438\u0439"}: ${c.ra?c.ra.join(" "):"\u043d\u0456\u0447\u043e\u0433\u043e "}`);break;case "/wand":c.Oa=1;Z(a,"\u0412\u0438\u0434\u0456\u043b\u0435\u043d\u043d\u044f \u043a\u043d\u043e\u043f\u043a\u0430\u043c\u0438 \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043d\u043e\u0457 \u043c\u0438\u0448\u043a\u0438.",
!0);break;default:Z(a,"\u041d\u0435\u0434\u0456\u0439\u0441\u043d\u0430 \u043a\u043e\u043c\u0430\u043d\u0434\u0430 : "+e)}}else{const e=Z(a,`<${c.name}> `+b);Dc(a,b).then(l=>{l&&Qc(a,e)})}},Z=(a,b,c=!1)=>{const d=++Cc;(a.N=a.N.slice(-49)).push({id:d,tb:c,time:va(),value:b});return d},Qc=(a,b)=>{const c=a.N.findIndex(d=>d.id===b);0<=c&&a.N.splice(c,1)},Nc=(a,b,c)=>{c?a.g.ra=b:a.g.qa=b;Z(a,`${c?"\u0414\u0440\u0443\u0433\u0430 \u043a\u0440\u0430\u043f\u043a\u0430 \u0432\u0438\u0431\u043e\u0440\u0443":
"\u041f\u0435\u0440\u0448\u0430 \u043a\u0440\u0430\u043f\u043a\u0430 \u0432\u0438\u0431\u043e\u0440\u0443"}: ${b.join(" ")}`,!0)},Dc=(a,b)=>(rb(a.bb),(b?eb("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:$a({msg:b})}):eb("/api/chat")).then(c=>{if(c.ok)return c.text()}).then(c=>{if(c){c=c.split("\n").filter(Boolean);for(const d of c)d.startsWith("<")&&Z(a,d);return 0<c.length}return!1}).catch(()=>!1).then(c=>{a.bb=pb(()=>{Dc(a,null)},5E3);return c})),Sc=({id:a,M:b})=>(A("div[className=bitmap]",
{S:{backgroundImage:`url(${"/static/minicraft/"}textures/${b}.png)`,backgroundPositionY:`-${2*(a-1)}rem`}}),null);function Tc({amount:a,l:b,id:c,M:d}){A("div[className=stack]",{title:Gb[c]+(1===b?` (${Fb[c]}, ${c})`:"")});return[G(Sc,{id:c,M:d}),1!==a&&H("div[className=amount]",{innerText:a})]}
function Uc({g:a,M:b,na:c}){A("div[className=bar]",{ontouchstart:F(e=>{a.L=Number(e.target.closest("[data-slot]").dataset.slot);a.ma=e.timeStamp}),S:{opacity:Ja(.5,M(1,1-5E-4*(c-a.ma-5E3)))}});const d=a.l;return a.B.slice(0,9).map(({c:e},l)=>H("div",{D:{slot:l},F:{active:l===a.L}},[e&&G(Tc,{amount:e.amount,data:e.data,l:d,id:e.id,M:b})]))}
function Vc({Bb:a,M:b}){A("div[className=grid]",{onclick:({target:c})=>{(c=c.closest("[data-id]"))&&Jb({c:Ib(P(c.dataset.id)),filter:null,W:64},a)}});return Fb.map((c,d)=>0<d&&H("div",{D:{id:d}},[G(Tc,{amount:1,data:null,l:1,id:d,M:b})]))}
function Wc({o:a,M:b}){const c=ja(()=>({c:null,filter:null,W:64})),d=a.g.l;A("div[className=menu overlay inventory]",ja(()=>({onclick:({target:e})=>{if("menu overlay inventory"===e.className)c.c?c.c=null:(a.j=0,a.A=!1,Ec(a));else if(e=e.closest("[data-slot]"))e=a.g.B[P(e.dataset.slot)],c.c?Jb(c,e):e.c&&Jb(e,c)},oncontextmenu:({target:e})=>{if("menu overlay inventory"===e.className)c.c?0>=--c.c.amount&&(c.c=null):(a.j=0,a.A=!1,Ec(a));else if(e=e.closest("[data-slot]"))e=a.g.B[P(e.dataset.slot)],c.c?
Jb(c,e,1):e.c&&Jb(e,c,Ha(e.c.amount/2))}})));return[H("div[className=window]",null,[H("h2[innerText=\u0406\u043d\u0432\u0435\u043d\u0442\u0430\u0440]"),1===d&&G(Vc,{Bb:c,M:b}),H("div[className=grid]",null,a.g.B.map(({c:e},l)=>H("div",{D:{slot:l},F:{first:9>l}},[e&&G(Tc,{amount:e.amount,data:e.data,l:d,id:e.id,M:b})])))]),c.c&&H("div[className=hand]",{S:{transform:`translate(${a.mb}px, ${a.nb}px)`}},[G(Tc,{amount:c.c.amount,data:c.c.data,l:0,id:c.c.id,M:b})])]}
const Xc=({I:{tb:a,time:b,value:c},na:d})=>(A(a?"div[className=minor]":"div",{innerText:c,S:{opacity:M(1,1-.001*(d-b-4500))}}),null);function Yc({N:a,na:b}){A("div[className=messages]");const c=b-5E3;return[ra(Xc,a.slice(-10).filter(d=>d.time>c),{na:b})]}function Zc({I:a,ia:b,current:c}){A("button",{disabled:a.id===c,innerText:`${a.label} (${a.owner})`,onclick:()=>{b({T:a.id})}});return null}
function $c({a:{ia:a},config:b,o:c,oa:d}){c&&D(()=>Gc(c));const [e,l]=pa(!1),m=ia(()=>e?eb("/static/minicraft/textures.json").then(k=>k.ok?k.json():null).catch(()=>null):Za.resolve(null),[e],null);A("div[className=menu overlay]");return[H("h1",{innerText:e?"\u041f\u043e\u0432\u0435\u0440\u0445\u043d\u043e\u0441\u0442\u0438 ":"\u041d\u0430\u043b\u0430\u0448\u0442\u0443\u0432\u0430\u043d\u043d\u044f"}),H("center",null,[H("button",{innerText:c&&!e?"\u041f\u043e\u0432\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f \u0432 \u0433\u0440\u0443":
"\u041f\u043e\u0432\u0435\u0440\u043d\u0443\u0442\u044c\u0441\u044f",onclick:()=>{e?l(!1):c?(c.j=0,c.A=!1,Ec(c)):d(2)}})]),!e&&H("div[className=settings]",null,[H("button[innerText=\u041f\u043e\u0432\u0435\u0440\u0445\u043d\u043e\u0441\u0442\u0438 ...]",{onclick:()=>{l(!0)}}),H("label[innerText=\u0414\u043e\u0437\u0432\u0456\u043b:]",null,[H("input[type=range][min=1][max=100][step=1]",{value:101-b.Y,onchange:k=>a({Y:101-Number(k.target.value)})})]),H("label[innerText=\u0422\u043e\u0447\u043a\u0430 \u043e\u0433\u043b\u044f\u0434\u0443:]",
null,[H("input[type=range][min=1][max=180][step=1]",{value:b.Da,onchange:k=>a({Da:Number(k.target.value)})})]),H("label[innerText=\u0412\u0438\u0434\u0438\u043c\u0456\u0441\u0442\u044c:]",null,[H("input[type=range][min=1][max=128][step=1]",{value:b.ga,onchange:k=>a({ga:Number(k.target.value)})})]),H("label[innerText=\u0413\u0440\u0443\u043f\u0443\u0432\u0430\u043d\u043d\u044f \u043f\u0456\u043a\u0441\u0435\u043b\u0456\u0432:]",null,[H("input[type=range][min=1][max=8][step=1]",{value:b.xa,onchange:k=>
a({xa:Number(k.target.value)})})]),H("label[innerText=\u0427\u0443\u0442\u043b\u0438\u0432\u0456\u0441\u0442\u044c \u043a\u043e\u043c\u043f\u044c\u044e\u0442\u0435\u0440\u043d\u043e\u0457 \u043c\u0438\u0448\u043a\u0438:]",null,[H("input[type=range][min=1][max=15][step=1]",{value:b.ua,onchange:k=>a({ua:Number(k.target.value)})})]),H("button[innerText=\u0421\u0442\u043e\u0440\u0456\u043d\u043a\u0430 \u043f\u0440\u043e\u0435\u043a\u0442\u0443]",{onclick:()=>{open("//github.com/L3P3/minicraft")}})]),
c&&!e&&H("center",null,[H("button[innerText=\u041f\u043e\u043a\u0438\u043d\u0443\u0442\u0456 \u0441\u0432\u0456\u0442]",{onclick:()=>{d(2)}})]),e&&H("div[className=settings]",null,[H("button[innerText=\u041e\u0434\u043d\u043e\u0442\u043e\u043d\u043d\u0456]",{disabled:0===b.T,onclick:()=>{a({T:0})}}),m&&ra(Zc,m,{ia:a,current:b.T})])]}const ad=({I:{tb:a,value:b}})=>(A(a?"div[className=minor]":"div",{innerText:b}),null);
function bd({o:a,N:b}){const c=F({history:null,input:null});A("div[className=menu overlay terminal]",{onclick:d=>{d.target!==c.input&&c.input.focus()}});D(d=>{d&&pb(()=>c.history.scrollTop=1E9,0)},[b.length&&b[b.length-1].id]);return[F(H("div[className=toolbar]",null,[H("button[innerText=\u274c]",{onclick:()=>{a.j=0;a.A=!1;Ec(a)}})])),H("div[className=history]",{R:F(d=>{c.history=d})},[ra(ad,b)]),F(H("input[enterkeyhint=send][mozactionhint=send][name=message][required]",{onkeydown:d=>{const e=d.keyCode;
d=d.target;13===e?(Rc(a,d.value),d.value=""):27===e&&(a.j=0,a.A=!1,Ec(a))},R:d=>{c.input=d;pb(()=>d.focus(),0)}}))]}const cd=[["pick",-2],["up",-14],["down",-15],["E",69],["T",84],["F1",112],["F3",114],["...",27]],dd=[["up",-10],["down",-11],["left",-12],["right",-13],["center",-1]],ed=[["up",-16],["down",-17],["left",-18],["right",-19],["center",-3]];
function fd({o:a}){const b=a.X,c=([d,e])=>H("div",{D:{code:e},F:{button:!0,[d]:!0,active:b.has(e)}});A("div[className=touch]",F({ontouchstart:d=>{let {code:e}=d.target.dataset;if(null!=e&&Oc(a,e=P(e),!0)){const l=d.changedTouches[0].identifier,m=k=>{k.changedTouches[0].identifier===l&&(ub("touchend",m),Oc(a,e,!1))};tb("touchend",m)}return!1}}));return[H("div[className=top]",null,cd.map(([d,e])=>H(`div[innerText=${d}]`,{D:{code:e},F:{button:!0,active:b.has(e)}}))),H("div[className=move]",null,dd.map(c)),
H("div[className=move sec]",null,ed.map(c))]}
function gd({account:a,a:b,config:c,frame:d,cb:e,oa:l}){const m=va(),k=xa.pointerLockElement===d,f=ja(()=>e.o=Fc(b,d,c,a));D(()=>{const g=h=>{if(0!==f.j)return!0;xa.pointerLockElement===d?Oc(f,-1-h.button,"mousedown"===h.type):Ec(f);return!1},p=h=>{if(xa.pointerLockElement===d){const q=f.config.ua*Aa/(Ja(f.Pa,f.Qa)*f.la);vb&&(f.ub=h.timeStamp);Mb(f.g,f.Ra=h.movementX*q,f.Sa=-h.movementY*q)}else f.mb=h.clientX,f.nb=h.clientY},v=h=>{b.Ja(!1);if(0===f.j&&!f.A&&5<Math.abs(h.deltaY))return h=0<h.deltaY?
-5:-4,Oc(f,h,!0),Oc(f,h,!1),!1},z={passive:!0};d.addEventListener("mousedown",g);d.addEventListener("mouseup",g);d.addEventListener("mousemove",p,z);d.addEventListener("wheel",v,z);return()=>{d.removeEventListener("mousedown",g);d.removeEventListener("mouseup",g);d.removeEventListener("mousemove",p,z);d.removeEventListener("wheel",v,z);rb(f.bb);sb(f.Cb);hc(f.world,f.g);var h=f.u;yc.delete(h);sb(h.zb);e.o=null}});D(()=>{f.config=c;f.u&&(f.u.P=!0);const g=f.world;var p=Ha(Na(f.config.ga/16*2+2));if(g.K!==
p){var v=f.g;g.$&&hc(g,v);const z=1<<(g.K=p),h=g.$=[];for(let q=0;q<z;++q)for(let C=0;C<z;++C)for(let u=0;4>u;++u)h.push({ja:!1,l:!1,x:q,y:u,z:C,Fa:0,Ta:0});p=z<<p+12+2;null===g.Z||g.Z.length<p?g.Ga=new gb((g.Z=new fb(p)).buffer):g.Ga.fill(0);fc(g,v,!0)}},[c]);D((g,p,v)=>{f.la=v;f.Pa=Ja(1,g);f.Qa=Ja(1,p);p=f.config.Y;g=Ha(f.Pa*f.la/p);p=Ha(f.Qa*f.la/p);if(g!==f.ya||p!==f.za)f.ya=g,f.za=p,f.u&&(f.u.P=!0,Ac(f.u))},[d.offsetWidth,d.offsetHeight,wa.devicePixelRatio||1,c.Y]);D(g=>{g||f.A||0!==f.j||(f.j=
1,vb&&f.Ra|f.Sa&&f.ub>m-100&&(Mb(f.g,-f.Ra,-f.Sa),f.Ra=f.Sa=0,f.u.P=!0));f.A=!g},[c.ka&&0===f.j||k]);D(g=>k&&g&&xa.exitPointerLock(),[f.A||0!==f.j]);D(()=>{if(f.world){if(f.ca&&!f.A){var g=f.g,p=M(5,.01*(m-f.ca));g.da-=.1*g.da*p;g.ea-=.1*g.ea*p;g.fa-=.1*g.fa*p;g.da+=(Ka(g.O)*g.Ua+La(g.O)*g.Va)*p;g.ea+=g.ib*p;g.fa+=(-La(g.O)*g.Ua+Ka(g.O)*g.Va)*p;Mb(g,g.vb*p*1.5,g.wb*p*1.5);g.G+=g.da*p;g.H+=g.ea*p;g.J+=g.fa*p}if(f.u){g=f.u;++g.$a;p=g.Wa;var v=g.jb;const aa=g.kb,la=g.o,Ra=la.config,zb=la.ta,y=la.g,O=
la.ya,sa=la.za,R=la.world;var z=0;if(!la.A||g.P){g.P=!1;z=Ra.xa;const kd=Ra.ga;var h=y.O,q=y.ha;const ld=y.aa,md=y.ba,Sa=y.l;var C=y.G,u=y.H,E=y.J;const nd=zb?y.V:-1,od=R.Z;var S=R.K;const pd=null!==wc;var t=1/O,r=1/sa;const ma=O>>1,ta=sa>>1,kc=M(O,sa),lc=32<kc,mc=Ka(h);h=La(h);const nc=Ka(-q);q=La(-q);var x=Ra.Da/45;const qd=t*(O<sa?x*O*r:x);t=r*(sa<O?x*sa*t:x);C+=65536;u+=65536;E+=65536;r=C%1;x=u%1;const rd=E%1;S=4+S;const Ca=(1<<S)-1,T=z<O?z:1,sd=O-T;let oc=1===y.l?6:4,Ta=y.aa=y.ba=y.pa=0,pc=0;
y.V=-1;z=ac(R,C&Ca,u&63,E&Ca);if(2!==Sa&&0<z)y.aa=C&Ca,y.V=u&63,y.ba=E&Ca,y.pa=6,aa.fill(Hb[z]|4278190080);else{for(let Ua=0;Ua<sa;++Ua){var B=(ta-Ua)*t;const qc=B*nc-q;var Da=B*q+nc;B=Da*h;Da*=mc;let na=0,Ea=!1;var da=!1;a:for(let V=0;V<O;V+=T)for(let ea=da?1:0;ea<T;++ea){if(2>T)var I=V;else if(0===V)I=0===ea?0:1===ea?T:ea-1,Ea=1===ea;else if(V<sd)I=(Ea=1===ea)?V+T:V+ea-1;else{if((I=0===ea?V-1:V+ea)>=O)break a;Ea=!1}var W=(I-ma)*qd;da=B+mc*W;const rc=Da-h*W,td=pc;W=16757124;let ib=1,sc=kd,jb=0;2===
Sa&&0<z&&(jb=10*Ga());for(let Ab=0;3>Ab;++Ab){const X=(td+Ab)%3;let fa=rc;var J=rd;0===X&&(fa=da,J=r);1===X&&(fa=qc,J=x);var ua=-1/fa;0<fa&&(J=1-J,ua*=-1);const kb=da*ua,ya=qc*ua;ua*=rc;const tc=Ma(kb*kb+ya*ya+ua*ua);let Va=C+kb*J-(0===X&0>fa|0),Wa=u+ya*J-(1===X&0>fa|0),Xa=E+ua*J-(2===X&0>fa|0);J*=tc;for(let Bb,Cb,Db,Y;J<sc;Va+=kb,Wa+=ya,Xa+=ua,J+=tc)if(!(2===Sa&&J<jb))if(65536>Wa){if(0>ya)break}else if(65600<=Wa){if(0<ya)break}else if(0!==(Y=od[((Bb=Va&Ca)<<S|(Db=Xa&Ca))<<6|(Cb=Wa&63)])){2!==Sa&&
Ua===ta&&I===ma&&J<=oc&&(y.aa=Bb,y.V=Cb,y.ba=Db,y.pa=0>fa|X<<1,oc=J);if(pd){--Y;1===X?6===Y?Y=25:13===Y?Y=4:1===Y&&0<ya&&(Y=2):1===Y&&(Y=24);const uc=wc[Y<<8|(16*(1===X?Xa:Wa)&15)<<4|16*(1===X?Va:(0<fa?Va-Xa:Xa-Va)+65536)&15];if(0===uc>>>24)continue;W=uc&16777215}else W=Hb[Y];sc=J;ib=(0===X?.8:2===X?.6:0<fa?.4:1)+(Cb!==nd||Bb!==ld||Db!==md?0:.2);pc=X;break}else 2===Sa&&J<jb&&(jb=J)}W=4278190080|M((W>>16)*ib,255)<<16|M((W>>8&255)*ib,255)<<8|M((W&255)*ib,255);if(da=(Ea=Ea&&(Ua!==ta||I<ma||I>ma+T))&&
na===W){if(6<T){aa.fill(na,Ta+V+1,Ta+V+T+1);break}I=Ta+V+1;aa[I]=na;aa[++I]=na;if(3>T)break;aa[++I]=na;if(4>T)break;aa[++I]=na;if(5>T)break;aa[++I]=na;if(6>T)break;aa[++I]=na;break}if(Ea||0===I)na=W;aa[Ta+I]=W}Ta+=O}zb&&!lc&&(aa[O*ta+ma]^=16777215)}p.putImageData(v,0,0);zb&&lc&&(v=M(Ha(.05*kc),8),p.fillRect(ma-v,ta-1,v<<1,2),p.fillRect(ma-1,ta-v,2,v-1),p.fillRect(ma-1,ta+1,2,v-1))}g.ob=la.Ka?`minicraft ${"0.11.3"} ${L(g.qb).toString().padStart(2,"\u00a0")} fps, T: ${L(24*R.eb).toString().padStart(2,
"0")}:${L(24*R.eb%1*60).toString().padStart(2,"0")}; ${la.A&&500>m%1E3?"":R.time}
R: ${O}x${sa} (x${Ra.Y}), D: ${Ra.ga}, C: ${R.sa}/${R.Ia.length}, M: ${64*wb(1<<4+R.K)>>10}k
E: 0/0, M: ${y.l}, I: ${z}

Position: ${y.G.toFixed(2)} ${y.H.toFixed(2)} ${y.J.toFixed(2)}
Angle: ${(y.O*Fa).toFixed(2)} ${(y.ha*Fa).toFixed(2)}
Focus: ${0>y.V?"":y.aa+" "+y.V+" "+y.ba+" "+"WEBTSNI"[y.pa]+": "+Fb[ac(R,y.aa,y.V,y.ba)]}
Chunk abs: ${L(y.G)>>4} ${L(y.J)>>4} ${L(y.H)>>4} rel: ${R.La} ${R.Na} ${R.Ma}`:""}}f.ca=m},[m]);oa();const w=F({fb:1});c.T&&(w.fb=c.T);return[H("canvas",{R:F(g=>{f.u=Bc(f,g)})}),f.ta&&2!==f.j&&G(Yc,{N:f.N,na:m}),f.u&&f.Ka&&H("div[className=diagnostics]",{innerText:f.u.ob}),c.ka&&G(fd,{o:f,ab:f.ab}),f.ta&&3!==f.j&&2!==f.g.l&&G(Uc,{g:f.g,M:w.fb,na:m}),3===f.j&&G(Wc,{o:f,M:w.fb,na:m}),1===f.j&&G($c,{a:b,config:c,o:f,oa:l}),2===f.j&&G(bd,{o:f,N:f.N})]}
function hd({I:a,Db:b,Eb:c,Fb:d}){A("div",{F:{selected:a===c},onclick:()=>{d(a.id)}});c=`${a.local?"L":"_"}${a.local&&a.remote?a.local>a.remote?">":a.local<a.remote?"<":"=":"_"}${a.remote?a.public?"R":"r":"_"}`;b===a.id&&(c=`[${c}]`);return[H("span",{innerText:`${c} ${a.label}`,title:a.account_name?"\u0412\u043b\u0430\u0441\u043d\u0438\u043a: "+a.account_name:"\u0422\u0456\u043b\u044c\u043a\u0438 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u0456 \u0441\u0432\u0456\u0442."}),H("span",{innerText:yb(Ja(a.local,
a.remote),!0)})]}const id={method:"POST",headers:{"Content-Type":"application/json"}};
function jd({account:a,a:b,config:c,oa:d}){A("div[className=menu]");const [e,l,m]=pa(0),k=F(()=>{l(m()+1)}),f=F({value:null}),w=ia(()=>ba(function*(){try{const t=!f.value&&!e,r=yield eb(`${"/api/minicraft/"}world?what=${t?"initial":"meta_all"}`);if(!r.ok)throw Error("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f");const x=yield r.json();if(!t)return x;if("0.11.3"!==x.version_latest)return location.reload(!0),null;ca();b.xb(x.account);
return x.worlds}catch(t){return alert("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u044f \u0441\u043f\u0438\u0441\u043a\u0443 \u0441\u0432\u0456\u0442: "+t.message),[]}}()),[e],null),g=ja(()=>{w&&(f.value=w);const t=[];f.value&&t.push(...f.value.map(r=>({account_name:r.account_name,hash:r.hash,id:r.id,label:r.label,local:0,public:r.public,remote:r.modified,writable:r.writable})));for(const r of c.worlds){const x=t.find(B=>B.id===r.id);
if(x){const B=x.local=r.mod_l,Da=x.remote,da=r.mod_r;B>da&&Da>da&&(confirm('\u041a\u043e\u043d\u0444\u043b\u0456\u043a\u0442! \u0421\u0432\u0456\u0442 "'+r.label+'" \u0411\u0443\u043b\u043e \u0437\u043c\u0456\u043d\u0435\u043d\u043e \u044f\u043a \u0442\u0443\u0442, \u0442\u0430\u043a \u0456 \u0432 \u0456\u043d\u0448\u0438\u0445 \u043c\u0456\u0441\u0446\u044f\u0445.\nOK: \u043f\u0440\u0438\u0439\u043d\u044f\u0442\u0438 \u0437 \u0441\u0435\u0440\u0432\u0435\u0440\u0430 ('+yb(Da,!1)+") | \u0421\u043a\u0430\u0441\u0443\u0432\u0430\u0442\u0438: \u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0442\u0435 \u0446\u0435 \u0441\u044e\u0434\u0438 ("+
yb(B,!1)+")")?b.U(r.id,{mod_l:x.local=da}):b.U(r.id,{mod_r:x.remote=da}))}else 1<r.mod_r&&w&&w.length&&(alert('\u0421\u0432\u0456\u0442 "'+r.label+'" \u0431\u0443\u0432 \u043d\u0435 \u0437\u043d\u0430\u0439\u0434\u0435\u043d \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u0456, \u0442\u043e\u043c\u0443 \u0432\u0456\u043d \u0442\u0435\u043f\u0435\u0440 \u043b\u043e\u043a\u0430\u043b\u044c\u043d\u0438\u0439!'),b.U(r.id,{mod_r:0})),t.push({account_name:"",hash:0,id:r.id,label:r.label,local:r.mod_l,
public:!1,remote:1===r.mod_r?1:0,writable:!0})}return t.sort((r,x)=>Ja(x.local,x.remote)-Ja(r.local,r.remote))},[w,c.worlds]),[p,v,z]=pa(c.Ea),h=ja(()=>g.find(t=>t.id===p)||null,[p,g]),q=ja(()=>{let t,r;return null!=(r=null==g?void 0:null==(t=g.find(x=>0<x.local&&0<x.remote&&x.local!==x.remote))?void 0:t.id)?r:null},[g]);D(()=>{if(null!==q){var t=!1,r=g.find(x=>x.id===q);if(r.local<r.remote)eb(`${"/static/minicraft/"}worlds/${r.hash}.json`).then(x=>x.json()).then(x=>{if(!t)return Wb(q,x).then(()=>
{b.U(q,{mod_l:r.remote,mod_r:r.remote})})}).catch(x=>{t||("QuotaExceededError"===x.name?(alert("\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043d\u044c\u043e \u043c\u0456\u0441\u0446\u044f!"),b.hb(q),Xb(q)):alert("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u044f \u0441\u0432\u0456\u0442\u0443: "+x.message))});else{if(!r.writable){b.U(q,{mod_l:c.worlds.find(B=>B.id===q).mod_r});return}let x=q;(1===r.remote?eb("/api/minicraft/world",
Object.assign({},id,{body:$a({what:"meta",label:r.label})})).then(B=>{if(!B.ok)throw Error(403===B.status?"\u041d\u0435\u043c\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0456\u0457. \u0417\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u043e\u0432\u0430\u043d\u0438\u0439?":"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f");return B.json()}).then(B=>{x=B.id}):Za.resolve()).then(()=>{if(t)throw null;return Vb(q)}).then(B=>{if(t)throw null;
return eb("/api/minicraft/world",Object.assign({},id,{body:$a({what:"data",world:x,data:B})}))}).then(B=>{if(!B.ok)throw Error(403===B.status?"\u041d\u0435\u043c\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0456\u0457. \u0417\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u043e\u0432\u0430\u043d\u0438\u0439?":"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f");return B.json()}).then(B=>{ca();x===q?b.U(q,{mod_l:B.modified,mod_r:B.modified}):
(Yb(q,x),b.hb(q),b.gb({id:x,label:r.label,mod_l:B.modified,mod_r:B.modified}),t||z()!==q||v(x));t||k();ha()}).catch(B=>{t||(alert("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u043d\u044f \u0441\u0432\u0456\u0442\u0443:"+B.message),ca(),b.U(q,{mod_r:0}),ha())})}return()=>{t=!0}}},[q]);const [C,u]=pa(!1);h||u(!1);const [E,S]=pa(!1);return[H("h1[innerText=\u0421\u0432\u0456\u0442\u0456]"),H("button[innerText=\u041e\u043d\u043e\u0432\u0438\u0442\u0438][style=position:absolute;left:0;top:0;height:2rem][title=\u041e\u043d\u043e\u0432\u0438\u0442\u0438 \u0441\u043f\u0438\u0441\u043e\u043a]",
{disabled:!w,onclick:k}),H("button[style=position:absolute;right:0;top:0;height:2rem]",{disabled:0<a.rank,innerText:a.rank?a.label:"\u0417\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u0443\u0432\u0430\u0442\u0438\u0441\u044f",onclick:()=>{location.href="/account?redir=minicraft"}}),H("div[className=worlds]",null,[ra(hd,g,{Hb:e,Db:q,Eb:h,Fb:v})]),H("center",null,[H("button[innerText=\u0412\u0456\u0434\u0447\u0438\u043d\u0438\u0442\u0438]",{disabled:!h||!h.local||h.remote>h.local,onclick:()=>{ca();b.ia({Ea:h.id});
d(0);ha()},title:h?h.local?h.remote>h.local?"\u0421\u0432\u0456\u0442 \u0449\u0435 \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0443\u0454\u0442\u044c\u0441\u044f!":"\u0412\u0432\u0456\u0439\u0442\u0438 \u0443 \u0432\u0438\u0431\u0440\u0430\u043d\u0438\u0439 \u0441\u0432\u0456\u0442 ":"\u0421\u0432\u0456\u0442 \u0449\u0435 \u043d\u0435 \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u0438\u0439!":"\u041d\u0435 \u0432\u0438\u0431\u0440\u0430\u043d\u0438\u0439 \u0441\u0432\u0456\u0442!"}),
H("button[innerText=\u0421\u0432\u0456\u0442...]",{disabled:!h||C,onclick:()=>{u(!0)},title:h?"\u0410\u043a\u0446\u0456\u0457/\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u0438 \u043d\u0430\u043b\u0430\u0448\u0442\u0443\u0432\u0430\u043d\u043d\u044f \u0441\u0432\u0456\u0442\u0443.":"\u041d\u0435 \u0432\u0438\u0431\u0440\u0430\u043d\u0438\u0439 \u0441\u0432\u0456\u0442!"})]),H("hr"),H("center",null,[H("button[innerText=\u041d\u043e\u0432\u0438\u0439 \u0441\u0432\u0456\u0442]",{onclick:()=>{const t=prompt("\u0418\u043c\u044f \u043d\u043e\u0432\u043e\u043c\u0443 \u0441\u0432\u0456\u0442\u0443:\n(\u043c\u0430\u043a\u0441. 16 \u0421\u0438\u043c\u0432\u043e\u043b\u0456\u0432)",
"\u041d\u043e\u0432\u0438\u0439 \u0441\u0432\u0456\u0442");t&&(16<t.length?alert("\u041d\u0430\u0437\u0432\u0430 \u0437\u0430\u043d\u0430\u0434\u0442\u043e \u0434\u043e\u0432\u0433\u0430!"):b.gb({id:M(0,...c.worlds.map(r=>r.id))-1,label:t,mod_l:Qa.now(),mod_r:0}))}}),H("button[innerText=\u041d\u0430\u043b\u0430\u0448\u0442\u0443\u0432\u0430\u043d\u043d\u044f]",{onclick:()=>{d(1)}})]),H("center",null,[H("small[innerText=\u0412\u0435\u0440\u0441\u0456\u044f 0.11.3 \u043e\u0442 L3P3]")]),C&&h&&H("div",
{F:{"menu overlay advanced":!0,busy:E},onclick:t=>{"menu overlay advanced"===t.target.className&&u(!1)}},[H("div[className=window]",null,[H("h2",{innerText:`"${h.label}"`,title:h.id}),H("table",null,[!!h.account_name&&H("tr",null,[H("td[innerText=\u0412\u043b\u0430\u0441\u043d\u0438\u043a:]"),H("td",{innerText:h.account_name})]),H("tr",null,[H("td[innerText=\u0417\u043c\u0456\u043d\u0438:]"),H("td",{innerText:yb(Ja(h.local,h.remote),!1)})])]),H("center",null,[H("button[innerText=\u041f\u0435\u0440\u0435\u0439\u043c\u0435\u043d\u0443\u0432\u0430\u0442\u0438]",
{disabled:E||!h.writable,onclick:()=>{const t=prompt("\u041d\u043e\u0432\u0435 \u0438\u043c\u044f \u0441\u0432\u0456\u0442\u0443:\n(\u043c\u0430\u043a\u0441. 16 \u0441\u0438\u043c\u0432\u043e\u043b\u0456\u0432)",h.label);!t||t===h.label||16<t.length||(h.local&&b.U(h.id,{label:t}),h.remote&&(S(!0),eb("/api/minicraft/world",{method:"POST",headers:{"Content-Type":"application/json"},body:$a({what:"meta",world:h.id,label:t})}).then(r=>{if(!r.ok)throw Error(403===r.status?"\u041d\u0435\u043c\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0456\u0457. \u0417\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u043e\u0432\u0430\u043d\u0438\u0439?":
"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f");return r.json()}).catch(r=>{alert("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0440\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u043d\u043d\u044f \u0441\u0432\u0456\u0442\u0443: "+r.message)}).then(()=>{S(!1)})))},title:h.writable?"\u0417\u043c\u0456\u043d\u0438\u0442\u0438 \u0456\u043c'\u044f \u0441\u0432\u0456\u0442\u0443":"\u0412\u0456\u0434\u0441\u0443\u0442\u043d\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0456\u044f!"}),
H("button",{disabled:E||!h.local&&!h.writable,innerText:h.local?"\u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 (\u043b\u043e\u043a\u0430\u043b\u044c\u043d\u0456)":"\u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438 ",onclick:()=>{confirm('\u0421\u0432\u0456\u0442 "'+h.label+'" \u0434\u0456\u0439\u0441\u043d\u043e \u0432\u0438\u0434\u0430\u043b\u0438\u0442\u0438?')&&(h.local?(b.hb(h.id),Xb(h.id)):(S(!0),eb("/api/minicraft/world",{method:"DELETE",headers:{"Content-Type":"application/json"},body:$a({what:"world",
world:h.id})}).then(t=>{if(!t.ok)throw Error(403===t.status?"\u041d\u0435\u043c\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0456\u0457. \u0417\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u043e\u0432\u0430\u043d\u0438\u0439?":"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f");ca();v(null);u(!1);k();S(!1);ha();return t.json()}).catch(t=>{alert("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0440\u0438 \u0432\u0438\u0434\u0430\u043b\u0435\u043d\u043d\u0456 \u0441\u0432\u0456\u0442\u0443: "+
t.message);S(!1)})))},title:h.local||h.writable?"\u0412\u0438\u0434\u0430\u043b\u0438\u0442\u0438 \u0441\u0432\u0456\u0442 ":"\u0412\u0456\u0434\u0441\u0443\u0442\u043d\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0456\u044f!"})]),H("center",null,[H("button",{disabled:E||!h.remote||!h.writable,innerText:`${"\u041f\u0443\u0431\u043b\u0456\u0447\u043d\u043e "}: ${h.public?"\u0422\u0430\u043a ":"\u041d\u0456"}`,onclick:()=>{S(!0);eb("/api/minicraft/world",{method:"POST",headers:{"Content-Type":"application/json"},
body:$a({what:"meta",world:h.id,public:!h.public})}).then(t=>{if(!t.ok)throw Error(403===t.status?"\u041d\u0435\u043c\u0430 \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0456\u0457. \u0417\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u043e\u0432\u0430\u043d\u0438\u0439?":"\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u043f\u0456\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u044f");ca();k();S(!1);ha();return t.json()}).catch(t=>{alert("\u041f\u043e\u043c\u0438\u043b\u043a\u0430 \u0440\u0435\u0434\u0430\u0433\u0443\u0432\u0430\u043d\u043d\u044f \u0441\u0432\u0456\u0442\u0443: "+
t.message);S(!1)})},title:h.remote?h.writable?h.public?"\u0417\u0440\u043e\u0431\u0456\u0442\u044c \u0441\u0432\u0456\u0442 \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u0438\u0439 ":"\u0417\u0440\u043e\u0431\u0456\u0442\u044c \u0441\u0432\u0456\u0442 \u043f\u0443\u0431\u043b\u0456\u0447\u043d\u0438\u043c":"\u0412\u0456\u0434\u0441\u0443\u0442\u043d\u044f \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u0430\u0446\u0456\u044f!":"\u0421\u0432\u0456\u0442 \u043d\u0435 \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0435\u043d\u0438\u0439!"}),
H("button",{disabled:E||!w||0<h.local&&0<h.remote||!h.remote&&!a.rank,innerText:h.local?w&&h&&!h.remote?"\u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0438\u0442\u0438":"\u041f\u0435\u0440\u0435\u043c\u0456\u0441\u0442\u0438\u0442\u0438 ":"\u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0438\u0442\u0438",onclick:()=>{h.local?h.remote||b.U(h.id,{mod_r:1}):b.gb({id:h.id,label:h.label,mod_l:1,mod_r:h.remote})},title:w?h.local?h.remote?"\u0421\u0432\u0456\u0442 \u0443\u0436\u0435 \u0456\u0441\u043d\u0443\u0454 \u043d\u0430 \u0441\u0430\u0439\u0442\u0456!":
a.rank?"\u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0438\u0442\u0438 \u0441\u0432\u0456\u0442 \u043d\u0430 \u0441\u0435\u0440\u0432\u0435\u0440":"\u041d\u0435 \u0437\u0430\u0440\u0435\u0454\u0441\u0442\u0440\u043e\u0432\u0430\u043d\u0438\u0439!":"\u0417\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0438\u0442\u0438 \u0441\u0432\u0456\u0442 \u0437 \u0441\u0435\u0440\u0432\u0435\u0440\u0443":"\u0421\u043f\u0438\u0441\u043e\u043a \u0449\u0435 \u0437\u0430\u0432\u0430\u043d\u0442\u0430\u0436\u0443\u0454\u0442\u044c\u0441\u044f!"})])])])]}
function ud({account:a,a:b,config:c,cb:d}){const [e,l]=pa(2),m=A("div[className=game]");return[(2===e||1===e)&&G(jd,{account:a,a:b,config:c,oa:l}),1===e&&G($c,{a:b,config:c,o:null,oa:l}),0===e&&G(gd,{account:a,a:b,config:c,frame:m,cb:d,oa:l})]}
function vd(){const [a,b]=ka(Eb),c=F({o:null,sb:0});D(()=>{let k=!1;onbeforeunload=onunload=onpagehide=onblur=()=>{k||(k=!0,c.o&&Gc(c.o),b.Xa())};onpageshow=onfocus=()=>{k=!1};setInterval(()=>(b.Xa(),!Pa&&bb("minicraft.lock",Qa.now())),500);tb("touchend",f=>{c.sb=f.timeStamp},!0)});const d=F(k=>{if("INPUT"===k.target.tagName||!c.o)return!0;b.Ja(!1);Oc(c.o,k.keyCode,"keydown"===k.type);return!1}),e=F(()=>{b.Ja(!0)}),l=F(k=>{999<k.timeStamp-c.sb&&b.Ja(!1)}),m=a.config.ka;D(()=>{m?(tb("mousedown",l,
!0),tb("mouseup",l,!0),ub("touchstart",e,!0)):(ub("mousedown",l,!0),ub("mouseup",l,!0),tb("touchstart",e,!0))},[m]);D(zc,[a.config.T]);A("",{onkeydown:d,onkeyup:d,oncontextmenu:xb,ondragstart:xb});return[G(ud,{account:a.account,a:b,config:a.config,cb:c})]}function wd(){close();return[H("h1[innerText=\u043c\u0438\u043d\u0438\u043a\u0440\u0430\u0444\u0442 \u0432\u0436\u0435 \u0437\u0430\u043f\u0443\u0449\u0435\u043d\u0438\u0439!]")]}
if(window.SSR)qa(vd);else if(Pa){const a=new Pa("minicraft.lock"),b=pb(()=>{qa(vd)},100);a.addEventListener("message",c=>{"yes"===c.data?(rb(b),a.close(),qa(wd)):(a.postMessage("yes"),focus())});a.postMessage("anyone there?")}else{const a=P(N.getItem("minicraft.lock")),b=Qa.now()-1E3;a<b?qa(vd):pb(()=>{qa(P(N.getItem("minicraft.lock"))===a?vd:wd)},a-b)};
